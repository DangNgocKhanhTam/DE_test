[0m22:26:57.901675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107afa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080cb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110822990>]}
[0m22:26:57.901687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107186190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fa010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fa350>]}


============================== 22:26:57.910081 | 5130b869-7426-4088-b120-2315b6b2ad0f ==============================
[0m22:26:57.910081 [info ] [MainThread]: Running with dbt=1.9.4


============================== 22:26:57.910139 | dc3ab486-6d04-4600-ad58-41f1426bc00e ==============================
[0m22:26:57.910139 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:26:57.911055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:26:57.911059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:58.155927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5130b869-7426-4088-b120-2315b6b2ad0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085a490>]}
[0m22:26:58.155934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc3ab486-6d04-4600-ad58-41f1426bc00e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107293e50>]}
[0m22:26:58.174581 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:26:58.174603 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:26:58.176365 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:26:58.176328 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:26:58.208588 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41537738, "process_in_blocks": "0", "process_kernel_time": 0.283398, "process_mem_max_rss": "94625792", "process_out_blocks": "0", "process_user_time": 1.787723}
[0m22:26:58.208569 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4142388, "process_in_blocks": "0", "process_kernel_time": 0.300384, "process_mem_max_rss": "94478336", "process_out_blocks": "0", "process_user_time": 1.794478}
[0m22:26:58.209789 [debug] [MainThread]: Command `cli deps` succeeded at 22:26:58.209540 after 0.42 seconds
[0m22:26:58.209778 [debug] [MainThread]: Command `cli deps` succeeded at 22:26:58.209495 after 0.42 seconds
[0m22:26:58.210470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071873d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f99510>]}
[0m22:26:58.210512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f32d0>]}
[0m22:26:58.210949 [debug] [MainThread]: Flushing usage events
[0m22:26:58.210996 [debug] [MainThread]: Flushing usage events
[0m22:26:59.568802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:26:59.599551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:56.578077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deeae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df2ae10>]}
[0m23:00:56.578130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c87c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ceefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ceca90>]}


============================== 23:00:56.589582 | e697505e-9a4f-4273-8388-ad2df86651fa ==============================
[0m23:00:56.589582 [info ] [MainThread]: Running with dbt=1.9.4


============================== 23:00:56.589580 | dc885665-ce61-4923-bc80-386de0fcda62 ==============================
[0m23:00:56.589580 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:00:56.591012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'version_check': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:56.591036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:56.899983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc885665-ce61-4923-bc80-386de0fcda62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df16d90>]}
[0m23:00:56.899935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e697505e-9a4f-4273-8388-ad2df86651fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d26e10>]}
[0m23:00:56.923587 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:56.923674 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:56.925371 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'dbt_packages'
[0m23:00:56.926129 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:56.931861 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49186695, "process_in_blocks": "0", "process_kernel_time": 0.414561, "process_mem_max_rss": "94171136", "process_out_blocks": "0", "process_user_time": 2.302385}
[0m23:00:56.933224 [debug] [MainThread]: Command `cli deps` succeeded at 23:00:56.932834 after 0.49 seconds
[0m23:00:56.934259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d001d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8d750>]}
[0m23:00:56.934868 [debug] [MainThread]: Flushing usage events
[0m23:00:56.936684 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt/task/deps.py", line 227, in run
    system.rmtree(self.project.packages_install_path)
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/shutil.py", line 748, in rmtree
    onerror(os.open, path, sys.exc_info())
  File "/Users/tamdang/.pyenv/versions/3.11.11/lib/python3.11/shutil.py", line 745, in rmtree
    fd = os.open(path, os.O_RDONLY | os.O_NONBLOCK, dir_fd=dir_fd)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'dbt_packages'

[0m23:00:56.938960 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.49939483, "process_in_blocks": "0", "process_kernel_time": 0.429923, "process_mem_max_rss": "94777344", "process_out_blocks": "0", "process_user_time": 2.319659}
[0m23:00:56.939707 [debug] [MainThread]: Command `cli deps` failed at 23:00:56.939518 after 0.50 seconds
[0m23:00:56.940241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deb3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dffe510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df16990>]}
[0m23:00:56.940852 [debug] [MainThread]: Flushing usage events
[0m23:00:58.323350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:00:58.350957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:37.035989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531ead0>]}
[0m23:03:37.035888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52eb10>]}


============================== 23:03:37.044171 | e3f0e3cc-aeac-406d-b4ad-06d402244d02 ==============================
[0m23:03:37.044171 [info ] [MainThread]: Running with dbt=1.9.4


============================== 23:03:37.044159 | 0a922dda-6f90-495c-b4ad-45d1735a9b5c ==============================
[0m23:03:37.044159 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:03:37.046914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'debug': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:03:37.047021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:03:37.315214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a922dda-6f90-495c-b4ad-45d1735a9b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105300d90>]}
[0m23:03:37.315508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3f0e3cc-aeac-406d-b4ad-06d402244d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c564990>]}
[0m23:03:37.337588 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:37.337588 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:37.339640 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:37.339647 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:37.343659 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42004597, "process_in_blocks": "0", "process_kernel_time": 0.352934, "process_mem_max_rss": "94654464", "process_out_blocks": "0", "process_user_time": 2.056716}
[0m23:03:37.343702 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41402593, "process_in_blocks": "0", "process_kernel_time": 0.365278, "process_mem_max_rss": "94199808", "process_out_blocks": "0", "process_user_time": 2.084002}
[0m23:03:37.344483 [debug] [MainThread]: Command `cli deps` succeeded at 23:03:37.344301 after 0.41 seconds
[0m23:03:37.344480 [debug] [MainThread]: Command `cli deps` succeeded at 23:03:37.344273 after 0.42 seconds
[0m23:03:37.344937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10531eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053eee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fba510>]}
[0m23:03:37.344945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cd9d0>]}
[0m23:03:37.345328 [debug] [MainThread]: Flushing usage events
[0m23:03:37.345327 [debug] [MainThread]: Flushing usage events
[0m23:03:38.525727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:38.572021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:50.328776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd049a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd04e50>]}


============================== 23:55:50.342170 | fd6c6fc3-9adf-45dd-bfbe-6f228ece2b40 ==============================
[0m23:55:50.342170 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:55:50.343471 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager'}
[0m23:55:50.374401 [info ] [MainThread]: dbt version: 1.11.0-b4
[0m23:55:50.375096 [info ] [MainThread]: python version: 3.10.18
[0m23:55:50.375612 [info ] [MainThread]: python path: /opt/anaconda3/envs/airflow310/bin/python3.10
[0m23:55:50.376096 [info ] [MainThread]: os info: macOS-10.16-x86_64-i386-64bit
[0m23:56:24.735725 [info ] [MainThread]: Using profiles dir at /Users/tamdang/Documents/DE_Test/DE_test
[0m23:56:24.737891 [info ] [MainThread]: Using profiles.yml file at /Users/tamdang/Documents/DE_Test/DE_test/profiles.yml
[0m23:56:24.738705 [info ] [MainThread]: Using dbt_project.yml file at /Users/tamdang/Documents/DE_Test/DE_test/dbt_project.yml
[0m23:56:24.739389 [info ] [MainThread]: adapter type: bigquery
[0m23:56:24.739913 [info ] [MainThread]: adapter version: 1.10.3
[0m23:56:24.890393 [info ] [MainThread]: Configuration:
[0m23:56:24.891236 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:56:24.892202 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:56:24.892748 [info ] [MainThread]: Required dependencies:
[0m23:56:24.893361 [debug] [MainThread]: Executing "git --help"
[0m23:56:24.946238 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:56:24.947385 [debug] [MainThread]: STDERR: "b''"
[0m23:56:24.948062 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:56:24.948877 [info ] [MainThread]: Connection:
[0m23:56:24.949599 [info ] [MainThread]:   method: service-account
[0m23:56:24.950099 [info ] [MainThread]:   database: cusma-383203
[0m23:56:24.950556 [info ] [MainThread]:   execution_project: cusma-383203
[0m23:56:24.950916 [info ] [MainThread]:   schema: dwh_dev
[0m23:56:24.951356 [info ] [MainThread]:   location: asia-southeast1
[0m23:56:24.951776 [info ] [MainThread]:   priority: interactive
[0m23:56:24.952181 [info ] [MainThread]:   maximum_bytes_billed: 1000000000
[0m23:56:24.952634 [info ] [MainThread]:   impersonate_service_account: None
[0m23:56:24.953031 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m23:56:24.953731 [info ] [MainThread]:   job_retries: 1
[0m23:56:24.954279 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m23:56:24.954814 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m23:56:24.955259 [info ] [MainThread]:   timeout_seconds: None
[0m23:56:24.955680 [info ] [MainThread]:   client_id: None
[0m23:56:24.956132 [info ] [MainThread]:   token_uri: None
[0m23:56:24.956499 [info ] [MainThread]:   compute_region: None
[0m23:56:24.956935 [info ] [MainThread]:   dataproc_cluster_name: None
[0m23:56:24.957409 [info ] [MainThread]:   gcs_bucket: None
[0m23:56:24.958107 [info ] [MainThread]:   dataproc_batch: None
[0m23:56:24.959847 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:56:25.491639 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m23:56:25.493021 [debug] [MainThread]: On debug: select 1 as id
[0m23:56:25.493819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:56:31.443959 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:db1d90e8-ffd8-422b-81ca-c852afc3caf3&page=queryresults
[0m23:56:31.930854 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:56:31.932197 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:56:32.176172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 41.983967, "process_in_blocks": "0", "process_kernel_time": 1.599931, "process_mem_max_rss": "345489408", "process_out_blocks": "0", "process_user_time": 6.084142}
[0m23:56:32.176918 [debug] [MainThread]: Command `dbt debug` succeeded at 23:56:32.176782 after 41.98 seconds
[0m23:56:32.177370 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:56:32.177847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd0a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be4f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb20b0>]}
[0m23:56:32.178320 [debug] [MainThread]: Flushing usage events
[0m23:56:33.420478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:20.595339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368d270>]}


============================== 00:31:20.602468 | 52972b5f-4ab8-4834-89e5-9df78b4fdb24 ==============================
[0m00:31:20.602468 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:31:20.603403 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'static_parser': 'True'}
[0m00:31:26.710814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131f78760>]}
[0m00:31:26.789592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11284ded0>]}
[0m00:31:26.790562 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:31:27.136494 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:31:27.458725 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:31:27.459531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f4ec50>]}
[0m00:31:29.195282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358ee470>]}
[0m00:31:29.317803 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:31:29.321644 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:31:29.363124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358f8160>]}
[0m00:31:29.364065 [info ] [MainThread]: Found 12 models, 9 data tests, 3 sources, 510 macros
[0m00:31:29.364699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358f9600>]}
[0m00:31:29.366877 [info ] [MainThread]: 
[0m00:31:29.367638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:29.368256 [info ] [MainThread]: 
[0m00:31:29.369131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:31:29.376223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:31:29.377047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:30.301738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_staging)
[0m00:31:30.303275 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_staging"
"
[0m00:31:30.317462 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_staging"} */
create schema if not exists `cusma-383203`.`dwh_dev_staging`
  
[0m00:31:30.318160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:32.201196 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2ecbd116-e52d-4068-ad37-0737622bd708&page=queryresults
[0m00:31:35.205485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m00:31:35.206616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:36.236546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m00:31:36.237481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:37.057543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_analytics)
[0m00:31:37.058574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:38.105790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111813b20>]}
[0m00:31:38.106626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:38.160334 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m00:31:38.165465 [info ] [Thread-1 (]: 1 of 3 START sql view model dwh_dev_staging.stg_rates .......................... [RUN]
[0m00:31:38.166561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now model.de_test_dwh.stg_rates)
[0m00:31:38.167180 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m00:31:38.179580 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m00:31:38.182234 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m00:31:38.240840 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m00:31:38.242704 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m00:31:38.243449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:39.301499 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a229b4e9-4047-4768-8c87-80406667f36b&page=queryresults
[0m00:31:39.688243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de2c50>]}
[0m00:31:39.689875 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dwh_dev_staging.stg_rates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m00:31:39.690920 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m00:31:39.691598 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m00:31:39.692472 [info ] [Thread-1 (]: 2 of 3 START sql view model dwh_dev_staging.stg_transactions ................... [RUN]
[0m00:31:39.693217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m00:31:39.693920 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m00:31:39.698934 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m00:31:39.700081 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m00:31:39.706379 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m00:31:39.707562 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m00:31:39.708258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:40.740130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:98e03846-7088-47c1-b5c8-25813ab048d6&page=queryresults
[0m00:31:41.063059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de2c50>]}
[0m00:31:41.064425 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dwh_dev_staging.stg_transactions .............. [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m00:31:41.065581 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m00:31:41.066283 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m00:31:41.067191 [info ] [Thread-1 (]: 3 of 3 START sql view model dwh_dev_staging.stg_users .......................... [RUN]
[0m00:31:41.068046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m00:31:41.068830 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m00:31:41.074042 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m00:31:41.075500 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m00:31:41.082020 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m00:31:41.083242 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m00:31:41.084278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:42.174684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6a9a9b84-2012-4eac-ad3a-e08069bdc72d&page=queryresults
[0m00:31:42.595957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52972b5f-4ab8-4834-89e5-9df78b4fdb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e1c070>]}
[0m00:31:42.597382 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dwh_dev_staging.stg_users ..................... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m00:31:42.598611 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m00:31:42.602037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:42.653675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:42.654247 [debug] [MainThread]: Connection 'model.de_test_dwh.stg_users' was properly closed.
[0m00:31:42.654755 [info ] [MainThread]: 
[0m00:31:42.655402 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 13.29 seconds (13.29s).
[0m00:31:42.657360 [debug] [MainThread]: Command end result
[0m00:31:42.701008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:31:42.703192 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:31:42.714444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:31:42.715162 [info ] [MainThread]: 
[0m00:31:42.716026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:42.716632 [info ] [MainThread]: 
[0m00:31:42.717225 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m00:31:42.720100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.257187, "process_in_blocks": "0", "process_kernel_time": 1.940168, "process_mem_max_rss": "361009152", "process_out_blocks": "0", "process_user_time": 9.504736}
[0m00:31:42.720849 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:42.720696 after 22.26 seconds
[0m00:31:42.721960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126d2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135997430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11284dc60>]}
[0m00:31:42.723071 [debug] [MainThread]: Flushing usage events
[0m00:31:44.119207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:16.788620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f724a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f30dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f31270>]}


============================== 00:46:16.799274 | 9dc86220-80da-467d-b7fc-02c3cefeb83c ==============================
[0m00:46:16.799274 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:46:16.800597 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'write_json': 'True', 'invocation_command': 'dbt test --select staging', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'empty': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80'}
[0m00:46:23.616251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b6e30>]}
[0m00:46:23.707735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f30a0>]}
[0m00:46:23.709199 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:46:24.079670 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:46:24.573170 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:46:24.574708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127f2c80>]}
[0m00:46:26.080596 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_users' in
package 'de_test_dwh' (models/staging/stg_test.yaml). Arguments to generic tests
should be nested under the `arguments` property.
[0m00:46:26.083359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13524fbb0>]}
[0m00:46:26.312702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135394490>]}
[0m00:46:26.435021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:46:26.441902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:46:26.508556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1353652d0>]}
[0m00:46:26.509555 [info ] [MainThread]: Found 12 models, 27 data tests, 3 sources, 510 macros
[0m00:46:26.510204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111681cc0>]}
[0m00:46:26.513261 [info ] [MainThread]: 
[0m00:46:26.513986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:46:26.514852 [info ] [MainThread]: 
[0m00:46:26.516656 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:46:26.527446 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_analytics'
[0m00:46:26.528637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:27.707323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m00:46:27.708094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:46:28.389278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m00:46:28.391908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:46:29.383231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc86220-80da-467d-b7fc-02c3cefeb83c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354208e0>]}
[0m00:46:29.385008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:46:29.447419 [debug] [Thread-1 (]: Began running node test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28
[0m00:46:29.448212 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_stg_users_kyc_level__1__2__3__4 ............. [RUN]
[0m00:46:29.448969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28)
[0m00:46:29.449554 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28
[0m00:46:29.467792 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28"
[0m00:46:29.470396 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28
[0m00:46:29.500222 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28"
[0m00:46:29.501506 [debug] [Thread-1 (]: On test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        kyc_level as value_field,
        count(*) as n_records

    from `cusma-383203`.`dwh_dev_staging`.`stg_users`
    group by kyc_level

)

select *
from all_values
where value_field not in (
    '1','2','3','4'
)



  
  
      
    ) dbt_internal_test
[0m00:46:29.502094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:30.882515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1cd0288b-e2cd-40fa-aeb1-417b7214d5da&page=queryresults
[0m00:46:30.884485 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1cd0288b-e2cd-40fa-aeb1-417b7214d5da&page=queryresults
[0m00:46:30.914894 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_users_kyc_level__1__2__3__4 (models/staging/stg_test.yaml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/de_test_dwh/models/staging/stg_test.yaml/accepted_values_stg_users_kyc_level__1__2__3__4.sql
[0m00:46:30.917414 [error] [Thread-1 (]: 1 of 18 ERROR accepted_values_stg_users_kyc_level__1__2__3__4 .................. [[31mERROR[0m in 1.47s]
[0m00:46:30.919411 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28
[0m00:46:30.920560 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:46:30.921765 [debug] [Thread-4 (]: Marking all children of 'test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_users_kyc_level__1__2__3__4 (models/staging/stg_test.yaml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/de_test_dwh/models/staging/stg_test.yaml/accepted_values_stg_users_kyc_level__1__2__3__4.sql.
[0m00:46:30.922591 [info ] [Thread-1 (]: 2 of 18 START test not_null_stg_rates_close_price .............................. [RUN]
[0m00:46:30.924888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.accepted_values_stg_users_kyc_level__1__2__3__4.2835b51c28, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m00:46:30.925596 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:46:30.935393 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m00:46:30.936797 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:46:30.940456 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m00:46:30.942089 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m00:46:30.943156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:33.091882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4c8f7a1a-b36f-46a7-93b1-6d3d3942d780&page=queryresults
[0m00:46:33.759957 [info ] [Thread-1 (]: 2 of 18 PASS not_null_stg_rates_close_price .................................... [[32mPASS[0m in 2.83s]
[0m00:46:33.761628 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:46:33.762422 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:46:33.763189 [info ] [Thread-1 (]: 3 of 18 START test not_null_stg_rates_symbol ................................... [RUN]
[0m00:46:33.764120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m00:46:33.764896 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:46:33.773438 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m00:46:33.775063 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:46:33.784572 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m00:46:33.786706 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m00:46:33.787704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:35.905399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d2f5d691-54cc-428e-ac4c-847157ee848d&page=queryresults
[0m00:46:36.386373 [info ] [Thread-1 (]: 3 of 18 PASS not_null_stg_rates_symbol ......................................... [[32mPASS[0m in 2.62s]
[0m00:46:36.387948 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:46:36.388968 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7
[0m00:46:36.390149 [info ] [Thread-1 (]: 4 of 18 START test not_null_stg_transactions_created_at ........................ [RUN]
[0m00:46:36.391314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7)
[0m00:46:36.392073 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7
[0m00:46:36.411359 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7"
[0m00:46:36.412947 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7
[0m00:46:36.417718 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7"
[0m00:46:36.419190 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where created_at is null



  
  
      
    ) dbt_internal_test
[0m00:46:36.419852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:37.730070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4413a391-92da-4901-bd45-b2fe3e904172&page=queryresults
[0m00:46:38.229727 [info ] [Thread-1 (]: 4 of 18 PASS not_null_stg_transactions_created_at .............................. [[32mPASS[0m in 1.84s]
[0m00:46:38.231157 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7
[0m00:46:38.231913 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb
[0m00:46:38.232650 [info ] [Thread-1 (]: 5 of 18 START test not_null_stg_transactions_destination_amount ................ [RUN]
[0m00:46:38.233499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_created_at.7fbf8b23d7, now test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb)
[0m00:46:38.234147 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb
[0m00:46:38.241173 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb"
[0m00:46:38.243924 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb
[0m00:46:38.249932 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb"
[0m00:46:38.251545 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select destination_amount
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where destination_amount is null



  
  
      
    ) dbt_internal_test
[0m00:46:38.253023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:39.585673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:07750009-b315-45c2-80b3-0e91cce7f258&page=queryresults
[0m00:46:40.100608 [error] [Thread-1 (]: 5 of 18 FAIL 20 not_null_stg_transactions_destination_amount ................... [[31mFAIL 20[0m in 1.87s]
[0m00:46:40.102409 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb
[0m00:46:40.103332 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e
[0m00:46:40.104340 [info ] [Thread-1 (]: 6 of 18 START test not_null_stg_transactions_destination_currency .............. [RUN]
[0m00:46:40.105425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_destination_amount.9a3b2cc7eb, now test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e)
[0m00:46:40.106292 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e
[0m00:46:40.115121 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e"
[0m00:46:40.116920 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e
[0m00:46:40.124426 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e"
[0m00:46:40.125596 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select destination_currency
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where destination_currency is null



  
  
      
    ) dbt_internal_test
[0m00:46:40.126227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:41.396153 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:515bca27-980e-4ae4-a8b9-af8b966964b0&page=queryresults
[0m00:46:41.867729 [info ] [Thread-1 (]: 6 of 18 PASS not_null_stg_transactions_destination_currency .................... [[32mPASS[0m in 1.76s]
[0m00:46:41.868744 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e
[0m00:46:41.869387 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175
[0m00:46:41.870137 [info ] [Thread-1 (]: 7 of 18 START test not_null_stg_transactions_source_amount ..................... [RUN]
[0m00:46:41.870907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_destination_currency.9e8efc978e, now test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175)
[0m00:46:41.871467 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175
[0m00:46:41.877590 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175"
[0m00:46:41.878705 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175
[0m00:46:41.882917 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175"
[0m00:46:41.885571 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_amount
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where source_amount is null



  
  
      
    ) dbt_internal_test
[0m00:46:41.886976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:42.823366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d4812bfd-33f2-42d2-93d5-ac8dcea3eca3&page=queryresults
[0m00:46:43.358920 [info ] [Thread-1 (]: 7 of 18 PASS not_null_stg_transactions_source_amount ........................... [[32mPASS[0m in 1.49s]
[0m00:46:43.360866 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175
[0m00:46:43.361958 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7
[0m00:46:43.363074 [info ] [Thread-1 (]: 8 of 18 START test not_null_stg_transactions_source_currency ................... [RUN]
[0m00:46:43.364329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_source_amount.69330e7175, now test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7)
[0m00:46:43.365197 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7
[0m00:46:43.373487 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7"
[0m00:46:43.374804 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7
[0m00:46:43.379880 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7"
[0m00:46:43.381123 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_currency
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where source_currency is null



  
  
      
    ) dbt_internal_test
[0m00:46:43.381937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:44.193469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b286b966-83bf-4877-a9de-b83cf0c3aa39&page=queryresults
[0m00:46:44.920250 [info ] [Thread-1 (]: 8 of 18 PASS not_null_stg_transactions_source_currency ......................... [[32mPASS[0m in 1.56s]
[0m00:46:44.922144 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7
[0m00:46:44.923333 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875
[0m00:46:44.924659 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_transactions_status ............................ [RUN]
[0m00:46:44.926169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_source_currency.1c4a1f62f7, now test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875)
[0m00:46:44.927096 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875
[0m00:46:44.937015 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875"
[0m00:46:44.939217 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875
[0m00:46:44.947966 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875"
[0m00:46:44.949432 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where status is null



  
  
      
    ) dbt_internal_test
[0m00:46:44.950187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:46.754817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4a88603a-00cb-47a8-8bc7-a0177d1bb999&page=queryresults
[0m00:46:47.218657 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_transactions_status .................................. [[32mPASS[0m in 2.29s]
[0m00:46:47.220524 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875
[0m00:46:47.221524 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:46:47.222574 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_transactions_txn_id ........................... [RUN]
[0m00:46:47.223655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_status.c7c2fec875, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m00:46:47.224509 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:46:47.235251 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m00:46:47.236761 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:46:47.241508 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m00:46:47.243559 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m00:46:47.244455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:48.290955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:852eec9b-b00e-481c-92c7-1b33abccd6f5&page=queryresults
[0m00:46:48.854727 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_transactions_txn_id ................................. [[32mPASS[0m in 1.63s]
[0m00:46:48.856370 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:46:48.857245 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_user_id.b541614306
[0m00:46:48.858218 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_transactions_user_id .......................... [RUN]
[0m00:46:48.859382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_transactions_user_id.b541614306)
[0m00:46:48.860314 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_user_id.b541614306
[0m00:46:48.914076 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_user_id.b541614306"
[0m00:46:48.931248 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_user_id.b541614306
[0m00:46:48.939411 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_user_id.b541614306"
[0m00:46:48.941067 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_user_id.b541614306: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_user_id.b541614306"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m00:46:48.941919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:50.233668 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d7554835-983d-4eb4-b754-16a74bfcaf6c&page=queryresults
[0m00:46:50.776075 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_transactions_user_id ................................ [[32mPASS[0m in 1.92s]
[0m00:46:50.778139 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_user_id.b541614306
[0m00:46:50.780732 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25
[0m00:46:50.784526 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_users_created_at .............................. [RUN]
[0m00:46:50.787273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_user_id.b541614306, now test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25)
[0m00:46:50.788525 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25
[0m00:46:50.797096 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25"
[0m00:46:50.798498 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25
[0m00:46:50.803817 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25"
[0m00:46:50.804915 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select created_at
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where created_at is null



  
  
      
    ) dbt_internal_test
[0m00:46:50.805802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:51.926092 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:da14d492-c729-4722-9d27-a343a26cd717&page=queryresults
[0m00:46:52.408591 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_users_created_at .................................... [[32mPASS[0m in 1.62s]
[0m00:46:52.410078 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25
[0m00:46:52.411218 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989
[0m00:46:52.412426 [info ] [Thread-1 (]: 13 of 18 START test not_null_stg_users_kyc_level ............................... [RUN]
[0m00:46:52.413679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_created_at.7be3c50b25, now test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989)
[0m00:46:52.414943 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989
[0m00:46:52.424818 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989"
[0m00:46:52.426079 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989
[0m00:46:52.429945 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989"
[0m00:46:52.431171 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m00:46:52.431909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:53.614615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d6a5597f-b4f7-46c2-b35a-55a90d17e648&page=queryresults
[0m00:46:54.249203 [info ] [Thread-1 (]: 13 of 18 PASS not_null_stg_users_kyc_level ..................................... [[32mPASS[0m in 1.84s]
[0m00:46:54.250649 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989
[0m00:46:54.251448 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4
[0m00:46:54.252282 [info ] [Thread-1 (]: 14 of 18 START test not_null_stg_users_updated_at .............................. [RUN]
[0m00:46:54.253154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_kyc_level.377cf5d989, now test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4)
[0m00:46:54.253874 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4
[0m00:46:54.263310 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4"
[0m00:46:54.264537 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4
[0m00:46:54.268813 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4"
[0m00:46:54.270201 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select updated_at
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where updated_at is null



  
  
      
    ) dbt_internal_test
[0m00:46:54.271171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:55.367493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9e54e893-43d2-42f9-9b1e-b847f52351a5&page=queryresults
[0m00:46:55.845754 [info ] [Thread-1 (]: 14 of 18 PASS not_null_stg_users_updated_at .................................... [[32mPASS[0m in 1.59s]
[0m00:46:55.847268 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4
[0m00:46:55.848218 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:46:55.849213 [info ] [Thread-1 (]: 15 of 18 START test not_null_stg_users_user_id ................................. [RUN]
[0m00:46:55.850868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_updated_at.f167b11bc4, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m00:46:55.852011 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:46:55.862947 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m00:46:55.864355 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:46:55.869655 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m00:46:55.871728 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m00:46:55.873235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:56.737422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1638e41d-fa13-47e6-ab5f-c25f6766b9f6&page=queryresults
[0m00:46:57.205743 [info ] [Thread-1 (]: 15 of 18 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 1.35s]
[0m00:46:57.212845 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:46:57.214815 [debug] [Thread-1 (]: Began running node test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e
[0m00:46:57.216697 [info ] [Thread-1 (]: 16 of 18 START test relationships_stg_transactions_user_id__user_id__ref_stg_users_  [RUN]
[0m00:46:57.218565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e)
[0m00:46:57.219820 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e
[0m00:46:57.247951 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e"
[0m00:46:57.255385 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e
[0m00:46:57.273161 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e"
[0m00:46:57.279394 [debug] [Thread-1 (]: On test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    where user_id is not null
),

parent as (
    select user_id as to_field
    from `cusma-383203`.`dwh_dev_staging`.`stg_users`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m00:46:57.288069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:58.142270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8dc5cebb-1119-46f2-b729-3feddf7aa228&page=queryresults
[0m00:46:58.640238 [error] [Thread-1 (]: 16 of 18 FAIL 3 relationships_stg_transactions_user_id__user_id__ref_stg_users_  [[31mFAIL 3[0m in 1.42s]
[0m00:46:58.641694 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e
[0m00:46:58.642374 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:46:58.643122 [info ] [Thread-1 (]: 17 of 18 START test unique_stg_transactions_txn_id ............................. [RUN]
[0m00:46:58.643836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.relationships_stg_transactions_user_id__user_id__ref_stg_users_.7fcea8eb2e, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m00:46:58.644325 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:46:58.658339 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m00:46:58.659972 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:46:58.669517 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m00:46:58.671719 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:46:58.672858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:00.080938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9d194872-69a3-4c7d-a816-f3f4bbe7bdd9&page=queryresults
[0m00:47:00.584845 [info ] [Thread-1 (]: 17 of 18 PASS unique_stg_transactions_txn_id ................................... [[32mPASS[0m in 1.94s]
[0m00:47:00.586492 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:47:00.587735 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:47:00.589060 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_users_user_id ................................... [RUN]
[0m00:47:00.590413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m00:47:00.591864 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:47:00.608174 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m00:47:00.609314 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:47:00.614333 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m00:47:00.615491 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:47:00.616463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:01.755462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bd045d8c-0afb-4914-99ef-3b3f76235291&page=queryresults
[0m00:47:02.962915 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 2.37s]
[0m00:47:02.964407 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:47:02.968596 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:03.033677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:03.034482 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m00:47:03.035161 [info ] [MainThread]: 
[0m00:47:03.035792 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 36.52 seconds (36.52s).
[0m00:47:03.042171 [debug] [MainThread]: Command end result
[0m00:47:03.093235 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:47:03.098545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:47:03.112102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:47:03.112652 [info ] [MainThread]: 
[0m00:47:03.113413 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:47:03.114225 [info ] [MainThread]: 
[0m00:47:03.115314 [error] [MainThread]: [31mFailure in test accepted_values_stg_users_kyc_level__1__2__3__4 (models/staging/stg_test.yaml)[0m
[0m00:47:03.116707 [error] [MainThread]:   Database Error in test accepted_values_stg_users_kyc_level__1__2__3__4 (models/staging/stg_test.yaml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [27:23]
  compiled code at target/run/de_test_dwh/models/staging/stg_test.yaml/accepted_values_stg_users_kyc_level__1__2__3__4.sql
[0m00:47:03.117651 [info ] [MainThread]: 
[0m00:47:03.118294 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/staging/stg_test.yaml/accepted_values_stg_users_kyc_level__1__2__3__4.sql
[0m00:47:03.119000 [info ] [MainThread]: 
[0m00:47:03.119657 [error] [MainThread]: [31mFailure in test not_null_stg_transactions_destination_amount (models/staging/stg_test.yaml)[0m
[0m00:47:03.120315 [error] [MainThread]:   Got 20 results, configured to fail if != 0
[0m00:47:03.121279 [info ] [MainThread]: 
[0m00:47:03.122531 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/staging/stg_test.yaml/not_null_stg_transactions_destination_amount.sql
[0m00:47:03.123618 [info ] [MainThread]: 
[0m00:47:03.124728 [error] [MainThread]: [31mFailure in test relationships_stg_transactions_user_id__user_id__ref_stg_users_ (models/staging/stg_test.yaml)[0m
[0m00:47:03.125430 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m00:47:03.125891 [info ] [MainThread]: 
[0m00:47:03.126372 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/staging/stg_test.yaml/relationships_stg_transactions_user_id__user_id__ref_stg_users_.sql
[0m00:47:03.126821 [info ] [MainThread]: 
[0m00:47:03.127260 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=18
[0m00:47:03.128123 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:47:03.139272 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 46.461452, "process_in_blocks": "0", "process_kernel_time": 2.235863, "process_mem_max_rss": "368611328", "process_out_blocks": "0", "process_user_time": 13.107649}
[0m00:47:03.140193 [debug] [MainThread]: Command `dbt test` failed at 00:47:03.140040 after 46.46 seconds
[0m00:47:03.140785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f724a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135367dc0>]}
[0m00:47:03.141324 [debug] [MainThread]: Flushing usage events
[0m00:47:04.466887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:48.917455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3d090>]}


============================== 00:54:48.925105 | a37c2aa1-2fca-47e3-b09c-048682b6bced ==============================
[0m00:54:48.925105 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:54:48.926197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'None', 'invocation_command': 'dbt test --select staging', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs'}
[0m00:54:55.007527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109012e90>]}
[0m00:54:55.111272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba11ed0>]}
[0m00:54:55.112273 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:54:55.481514 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:54:55.992335 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:54:55.995569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e2cb0>]}
[0m00:54:58.131443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd88130>]}
[0m00:54:58.274424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:54:58.279052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:54:58.331061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd41600>]}
[0m00:54:58.331944 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m00:54:58.332535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdfa60>]}
[0m00:54:58.334981 [info ] [MainThread]: 
[0m00:54:58.335662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:58.336092 [info ] [MainThread]: 
[0m00:54:58.336872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:58.344853 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_analytics'
[0m00:54:58.345712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:59.690274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m00:54:59.694721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:00.744674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m00:55:00.752262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:01.375710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37c2aa1-2fca-47e3-b09c-048682b6bced', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db429e0>]}
[0m00:55:01.377156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:01.433224 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:55:01.433874 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_rates_close_price ............................... [RUN]
[0m00:55:01.434583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m00:55:01.435249 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:55:01.468941 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m00:55:01.470497 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:55:01.502146 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m00:55:01.503541 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m00:55:01.504207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:02.964019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a9b54c3a-2412-4f83-bf2c-fa0161e34e29&page=queryresults
[0m00:55:03.577585 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_rates_close_price ..................................... [[32mPASS[0m in 2.14s]
[0m00:55:03.579248 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m00:55:03.580104 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:55:03.580852 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_rates_symbol .................................... [RUN]
[0m00:55:03.581978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m00:55:03.582772 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:55:03.590473 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m00:55:03.591677 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:55:03.596334 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m00:55:03.598830 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m00:55:03.599634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:04.886687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:82dc19fe-ec74-48be-a524-bcf12b8b717d&page=queryresults
[0m00:55:05.415710 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_rates_symbol .......................................... [[32mPASS[0m in 1.83s]
[0m00:55:05.416889 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m00:55:05.417799 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:55:05.418731 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_transactions_txn_id ............................. [RUN]
[0m00:55:05.419489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m00:55:05.419981 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:55:05.426665 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m00:55:05.428676 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:55:05.434424 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m00:55:05.436017 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m00:55:05.437194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:07.495564 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e2ba5725-337d-4f13-b91c-089d29cc72b5&page=queryresults
[0m00:55:08.005690 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_transactions_txn_id ................................... [[32mPASS[0m in 2.59s]
[0m00:55:08.006636 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m00:55:08.007278 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:55:08.008027 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_users_user_id ................................... [RUN]
[0m00:55:08.008838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m00:55:08.009382 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:55:08.015387 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m00:55:08.019918 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:55:08.026405 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m00:55:08.027749 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m00:55:08.028784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:09.057048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dd0093b6-8f72-4997-83db-b54e7563f911&page=queryresults
[0m00:55:09.538079 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 1.53s]
[0m00:55:09.540056 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m00:55:09.541058 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:55:09.542124 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_transactions_txn_id ............................... [RUN]
[0m00:55:09.543204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m00:55:09.544064 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:55:09.562030 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m00:55:09.563748 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:55:09.570083 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m00:55:09.571534 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:55:09.572223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:10.621416 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:968c77ca-a882-47f8-9d5f-749362344126&page=queryresults
[0m00:55:11.076072 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_transactions_txn_id ..................................... [[32mPASS[0m in 1.53s]
[0m00:55:11.077937 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m00:55:11.078936 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:55:11.079983 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_users_user_id ..................................... [RUN]
[0m00:55:11.081137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m00:55:11.082386 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:55:11.093420 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m00:55:11.095686 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:55:11.101906 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m00:55:11.103501 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:55:11.104517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:12.313508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:481bd302-9372-4dd3-9c95-27c1be0471e9&page=queryresults
[0m00:55:12.783180 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 1.70s]
[0m00:55:12.784191 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m00:55:12.786472 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:12.833785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:12.834634 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m00:55:12.835453 [info ] [MainThread]: 
[0m00:55:12.836300 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m00:55:12.838193 [debug] [MainThread]: Command end result
[0m00:55:12.877106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:55:12.880766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:55:12.892864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:55:12.893664 [info ] [MainThread]: 
[0m00:55:12.894710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:12.895319 [info ] [MainThread]: 
[0m00:55:12.895851 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m00:55:12.900126 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 24.101717, "process_in_blocks": "0", "process_kernel_time": 1.841333, "process_mem_max_rss": "367054848", "process_out_blocks": "0", "process_user_time": 10.282882}
[0m00:55:12.901243 [debug] [MainThread]: Command `dbt test` succeeded at 00:55:12.901047 after 24.10 seconds
[0m00:55:12.901984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dd8a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abc5c60>]}
[0m00:55:12.902848 [debug] [MainThread]: Flushing usage events
[0m00:55:14.153334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:20.986982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f04e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110048dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110049270>]}


============================== 01:19:20.994733 | f9b8d1a1-4aea-40e6-a6a4-944122932bdc ==============================
[0m01:19:20.994733 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m01:19:20.995805 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'fail_fast': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select int_transactions_with_rates.sql', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False'}
[0m01:19:27.638739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d64ae60>]}
[0m01:19:27.712519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffff940>]}
[0m01:19:27.713374 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m01:19:28.039582 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m01:19:28.339279 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:19:28.340163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8eec80>]}
[0m01:19:29.980547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322f0130>]}
[0m01:19:30.097830 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:19:30.105685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:19:30.162874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322e3430>]}
[0m01:19:30.163967 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m01:19:30.164808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322e04f0>]}
[0m01:19:30.168054 [info ] [MainThread]: 
[0m01:19:30.168792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:30.169395 [info ] [MainThread]: 
[0m01:19:30.170306 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:19:30.171937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m01:19:30.172704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:31.128323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_intermediate)
[0m01:19:31.130777 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_intermediate"
"
[0m01:19:31.150530 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_intermediate"} */
create schema if not exists `cusma-383203`.`dwh_dev_intermediate`
  
[0m01:19:31.151454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:32.549758 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ea742bf2-349d-4e02-afde-71693d7b652c&page=queryresults
[0m01:19:34.709985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m01:19:34.710750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:35.830299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m01:19:35.831630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:36.571543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m01:19:36.572833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:37.219630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1322e3ac0>]}
[0m01:19:37.221075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:37.275462 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m01:19:37.276173 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m01:19:37.276859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.int_transactions_with_rates)
[0m01:19:37.277282 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m01:19:37.288562 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:19:37.291477 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m01:19:37.427397 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:19:37.429605 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * 
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * 
    from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),


transactions_with_source_destination_rates as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at,
        t.source_amount,
        t.destination_amount,
        (
            select usdt_price
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_rate_timestamp,
        (
            select usdt_price
            from latest_rates
            where currency = tsr.destination_currency
                and price_timestamp <= tsr.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = tsr.destination_currency
                and price_timestamp <= tsr.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_rate_timestamp

    from transactions t
)
    select
        *,
        source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
        destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd,
    from transactions_with_source_destination_rates
    );
  
[0m01:19:37.430987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:38.383821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bd5b536c-4422-4013-9de2-3e9f714017d3&page=queryresults
[0m01:19:38.387573 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bd5b536c-4422-4013-9de2-3e9f714017d3&page=queryresults
[0m01:19:38.419842 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Not found: Table cusma-383203:dwh_dev_intermediate.int_rates_usdt was not found in location asia-southeast1
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:19:38.423908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b8d1a1-4aea-40e6-a6a4-944122932bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e775de0>]}
[0m01:19:38.427063 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 1.14s]
[0m01:19:38.428938 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m01:19:38.430122 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Not found: Table cusma-383203:dwh_dev_intermediate.int_rates_usdt was not found in location asia-southeast1
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql.
[0m01:19:38.433164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:38.480269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:38.480817 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m01:19:38.481345 [info ] [MainThread]: 
[0m01:19:38.481886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m01:19:38.482851 [debug] [MainThread]: Command end result
[0m01:19:38.524717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:19:38.527000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:19:38.534387 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m01:19:38.535064 [info ] [MainThread]: 
[0m01:19:38.535689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:19:38.536358 [info ] [MainThread]: 
[0m01:19:38.536968 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)[0m
[0m01:19:38.537533 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Not found: Table cusma-383203:dwh_dev_intermediate.int_rates_usdt was not found in location asia-southeast1
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:19:38.537998 [info ] [MainThread]: 
[0m01:19:38.538542 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:19:38.538993 [info ] [MainThread]: 
[0m01:19:38.539499 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:19:38.543169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.65474, "process_in_blocks": "0", "process_kernel_time": 1.933324, "process_mem_max_rss": "366354432", "process_out_blocks": "0", "process_user_time": 9.416193}
[0m01:19:38.543977 [debug] [MainThread]: Command `dbt run` failed at 01:19:38.543819 after 17.66 seconds
[0m01:19:38.544553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f04e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d64ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1321a3970>]}
[0m01:19:38.545080 [debug] [MainThread]: Flushing usage events
[0m01:19:39.819620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:18.736834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4d480>]}


============================== 01:20:18.744156 | 7a5c63fb-dcf3-409c-aff4-996f31359ccd ==============================
[0m01:20:18.744156 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m01:20:18.745005 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_rates_usdt.sql', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'empty': 'False'}
[0m01:20:24.631728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268fb460>]}
[0m01:20:24.706582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405d240>]}
[0m01:20:24.707513 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m01:20:25.015258 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m01:20:25.398498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:25.399137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:25.469816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e88c70>]}
[0m01:20:25.597475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:20:25.600470 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:20:25.652273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e683d0>]}
[0m01:20:25.653506 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m01:20:25.654208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126866590>]}
[0m01:20:25.657620 [info ] [MainThread]: 
[0m01:20:25.658503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:25.659394 [info ] [MainThread]: 
[0m01:20:25.660643 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:20:25.662225 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m01:20:25.663098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:26.536208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m01:20:26.537283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:27.168771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m01:20:27.170083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:27.774170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_analytics)
[0m01:20:27.776873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:28.874396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268542e0>]}
[0m01:20:28.875837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:28.931892 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m01:20:28.932813 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m01:20:28.933604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now model.de_test_dwh.int_rates_usdt)
[0m01:20:28.934108 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m01:20:28.949396 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m01:20:28.950645 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m01:20:29.009469 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m01:20:29.010689 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m01:20:29.011363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:30.308106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f76fe558-e4c0-44f8-b856-e18b77aa4cd0&page=queryresults
[0m01:20:34.951088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5c63fb-dcf3-409c-aff4-996f31359ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c2eb00>]}
[0m01:20:34.952113 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (30.9k rows, 3.3 MiB processed)[0m in 6.02s]
[0m01:20:34.952989 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m01:20:34.954832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:35.002069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:35.002661 [debug] [MainThread]: Connection 'model.de_test_dwh.int_rates_usdt' was properly closed.
[0m01:20:35.003374 [info ] [MainThread]: 
[0m01:20:35.003966 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.34 seconds (9.34s).
[0m01:20:35.005050 [debug] [MainThread]: Command end result
[0m01:20:35.043028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:20:35.045227 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:20:35.053308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m01:20:35.054352 [info ] [MainThread]: 
[0m01:20:35.055258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:35.055833 [info ] [MainThread]: 
[0m01:20:35.056332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:20:35.058324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.421808, "process_in_blocks": "0", "process_kernel_time": 1.768607, "process_mem_max_rss": "354787328", "process_out_blocks": "0", "process_user_time": 8.322391}
[0m01:20:35.059085 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:35.058955 after 16.42 seconds
[0m01:20:35.059603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ea0820>]}
[0m01:20:35.060090 [debug] [MainThread]: Flushing usage events
[0m01:20:36.243580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:25:26.421839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106778dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106779270>]}


============================== 01:25:26.431011 | 88e524ce-e616-4147-8f00-4a635a71a8a2 ==============================
[0m01:25:26.431011 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m01:25:26.432183 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select int_transactions_with_rates.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False'}
[0m01:25:33.513870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280bb280>]}
[0m01:25:33.589735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280269e0>]}
[0m01:25:33.590627 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m01:25:33.920045 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m01:25:34.241328 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:25:34.242192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601acb0>]}
[0m01:25:35.901864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a5c0d0>]}
[0m01:25:36.023340 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:25:36.028646 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:25:36.079219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a13130>]}
[0m01:25:36.080028 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m01:25:36.080601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a104f0>]}
[0m01:25:36.082820 [info ] [MainThread]: 
[0m01:25:36.083489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:36.084021 [info ] [MainThread]: 
[0m01:25:36.084748 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:25:36.086059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m01:25:36.087121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:37.097079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_analytics)
[0m01:25:37.098495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:38.112385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m01:25:38.113819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:38.781050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m01:25:38.782885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:39.408711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a13ac0>]}
[0m01:25:39.409933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:39.465818 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m01:25:39.466669 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m01:25:39.467414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.int_transactions_with_rates)
[0m01:25:39.467928 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m01:25:39.480172 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:25:39.481249 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m01:25:39.542121 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:25:39.543376 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * 
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * 
    from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),


transactions_with_source_destination_rates as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at,
        t.source_amount,
        t.destination_amount,
        (
            select usdt_price
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_rate_timestamp,
        (
            select usdt_price
            from latest_rates
            where currency = tsr.destination_currency
                and price_timestamp <= tsr.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = tsr.destination_currency
                and price_timestamp <= tsr.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_rate_timestamp

    from transactions t
)
    select
        *,
        DATE(created_at) date_created,
        source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
        destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd,
    from transactions_with_source_destination_rates
    );
  
[0m01:25:39.544087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:40.696448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fe513465-3279-4f46-b525-adb71c79eeaa&page=queryresults
[0m01:25:40.829171 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fe513465-3279-4f46-b525-adb71c79eeaa&page=queryresults
[0m01:25:40.860275 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Unrecognized name: tsr at [68:30]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:25:40.864289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88e524ce-e616-4147-8f00-4a635a71a8a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a1a500>]}
[0m01:25:40.866084 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 1.39s]
[0m01:25:40.869139 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m01:25:40.870012 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Unrecognized name: tsr at [68:30]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql.
[0m01:25:40.873990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:40.920157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:40.920750 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m01:25:40.921199 [info ] [MainThread]: 
[0m01:25:40.921765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m01:25:40.922751 [debug] [MainThread]: Command end result
[0m01:25:40.962749 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:25:40.965359 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:25:40.972837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m01:25:40.973723 [info ] [MainThread]: 
[0m01:25:40.974395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:25:40.975045 [info ] [MainThread]: 
[0m01:25:40.975693 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)[0m
[0m01:25:40.976284 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Unrecognized name: tsr at [68:30]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:25:40.976762 [info ] [MainThread]: 
[0m01:25:40.977333 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:25:40.977821 [info ] [MainThread]: 
[0m01:25:40.978313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:25:40.981592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.675459, "process_in_blocks": "0", "process_kernel_time": 1.964457, "process_mem_max_rss": "361144320", "process_out_blocks": "0", "process_user_time": 9.360851}
[0m01:25:40.982418 [debug] [MainThread]: Command `dbt run` failed at 01:25:40.982292 after 14.68 seconds
[0m01:25:40.982947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a5f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fd300>]}
[0m01:25:40.983416 [debug] [MainThread]: Flushing usage events
[0m01:25:42.185220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:28:12.077191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113748dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113749270>]}


============================== 01:28:12.085492 | d3be5304-8f23-4a49-8bc3-a0529a874af6 ==============================
[0m01:28:12.085492 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m01:28:12.086673 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'False', 'invocation_command': 'dbt run --select int_transactions_with_rates.sql', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:28:18.747207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4ae60>]}
[0m01:28:18.817519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f3b20>]}
[0m01:28:18.818363 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m01:28:19.147543 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m01:28:19.448497 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:28:19.449220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112feec80>]}
[0m01:28:20.985948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b68100>]}
[0m01:28:21.104963 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:28:21.111369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:28:21.159811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b42590>]}
[0m01:28:21.160731 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m01:28:21.161353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b427d0>]}
[0m01:28:21.163663 [info ] [MainThread]: 
[0m01:28:21.164358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:21.165089 [info ] [MainThread]: 
[0m01:28:21.166037 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:21.167184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m01:28:21.168147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:21.996482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m01:28:21.997299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:22.592709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m01:28:22.595317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:23.240702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m01:28:23.241874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:24.457416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135999450>]}
[0m01:28:24.459054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:24.515587 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m01:28:24.518676 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m01:28:24.519658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now model.de_test_dwh.int_transactions_with_rates)
[0m01:28:24.520131 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m01:28:24.533340 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:28:24.534870 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m01:28:24.595011 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:28:24.596489 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * 
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * 
    from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),


transactions_with_source_destination_rates as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at,
        t.source_amount,
        t.destination_amount,
        (
            select usdt_price
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = t.source_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as source_rate_timestamp,
        (
            select usdt_price
            from latest_rates
            where currency = t.destination_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_usdt_price,
        (
            select price_timestamp
            from latest_rates
            where currency = t.destination_currency
                and price_timestamp <= t.created_at
            order by price_timestamp desc
            limit 1
        ) as destination_rate_timestamp

    from transactions t
)
    select
        *,
        DATE(created_at) date_created,
        source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
        destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd,
    from transactions_with_source_destination_rates
    );
  
[0m01:28:24.597367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:25.900782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:736667ae-8dce-4c4a-9c0d-6e95b0179638&page=queryresults
[0m01:28:26.055027 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:736667ae-8dce-4c4a-9c0d-6e95b0179638&page=queryresults
[0m01:28:26.087243 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Correlated subqueries that reference other tables are not supported unless they can be de-correlated, such as by transforming them into an efficient JOIN.
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:28:26.090735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3be5304-8f23-4a49-8bc3-a0529a874af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dffbb0>]}
[0m01:28:26.092691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 1.57s]
[0m01:28:26.095854 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m01:28:26.097044 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Correlated subqueries that reference other tables are not supported unless they can be de-correlated, such as by transforming them into an efficient JOIN.
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql.
[0m01:28:26.099848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:26.147559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:26.148158 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m01:28:26.148621 [info ] [MainThread]: 
[0m01:28:26.149190 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m01:28:26.150148 [debug] [MainThread]: Command end result
[0m01:28:26.186727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:28:26.189031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:28:26.199310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m01:28:26.200014 [info ] [MainThread]: 
[0m01:28:26.200719 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:28:26.201270 [info ] [MainThread]: 
[0m01:28:26.201883 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)[0m
[0m01:28:26.202481 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  Correlated subqueries that reference other tables are not supported unless they can be de-correlated, such as by transforming them into an efficient JOIN.
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:28:26.203022 [info ] [MainThread]: 
[0m01:28:26.203597 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m01:28:26.204070 [info ] [MainThread]: 
[0m01:28:26.204619 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:28:26.208223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.23565, "process_in_blocks": "0", "process_kernel_time": 1.833233, "process_mem_max_rss": "362266624", "process_out_blocks": "0", "process_user_time": 8.978292}
[0m01:28:26.209995 [debug] [MainThread]: Command `dbt run` failed at 01:28:26.209419 after 14.24 seconds
[0m01:28:26.211487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135b43100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cc0a0>]}
[0m01:28:26.212347 [debug] [MainThread]: Flushing usage events
[0m01:28:27.540651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:30:06.275922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b41270>]}


============================== 01:30:06.284171 | 8554d3cf-4a10-4a0f-95e8-2aabab1d221c ==============================
[0m01:30:06.284171 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m01:30:06.285275 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_transactions_with_rates.sql', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'write_json': 'True', 'printer_width': '80', 'empty': 'False'}
[0m01:30:13.012778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104112e90>]}
[0m01:30:13.088584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696d900>]}
[0m01:30:13.089468 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m01:30:13.409213 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m01:30:13.716737 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:30:13.718015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e2cb0>]}
[0m01:30:15.389134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e500d0>]}
[0m01:30:15.504607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:30:15.509910 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:30:15.556897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e0c610>]}
[0m01:30:15.557670 [info ] [MainThread]: Found 12 models, 15 data tests, 3 sources, 510 macros
[0m01:30:15.558475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128e0e050>]}
[0m01:30:15.560796 [info ] [MainThread]: 
[0m01:30:15.561956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:30:15.562698 [info ] [MainThread]: 
[0m01:30:15.563698 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:30:15.564953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m01:30:15.565599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:17.135758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m01:30:17.136803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:17.781279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m01:30:17.783145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:18.764356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m01:30:18.765947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:19.396082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285b6950>]}
[0m01:30:19.397139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:19.448747 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m01:30:19.449530 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m01:30:19.450250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.int_transactions_with_rates)
[0m01:30:19.451001 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m01:30:19.464603 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:30:19.465931 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m01:30:19.524734 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m01:30:19.525915 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m01:30:19.526617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:20.801525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:df54d6c8-80bc-4812-b751-c39f4682c8fd&page=queryresults
[0m01:30:29.772220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8554d3cf-4a10-4a0f-95e8-2aabab1d221c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1254c0820>]}
[0m01:30:29.773703 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (5.3m rows, 699.5 KiB processed)[0m in 10.32s]
[0m01:30:29.774819 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m01:30:29.778125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:29.826486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:29.827152 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m01:30:29.827633 [info ] [MainThread]: 
[0m01:30:29.828147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.26 seconds (14.26s).
[0m01:30:29.829423 [debug] [MainThread]: Command end result
[0m01:30:29.867163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m01:30:29.869642 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m01:30:29.877508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m01:30:29.878176 [info ] [MainThread]: 
[0m01:30:29.878874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:30:29.879628 [info ] [MainThread]: 
[0m01:30:29.880322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:30:29.883931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.702856, "process_in_blocks": "0", "process_kernel_time": 1.918494, "process_mem_max_rss": "365215744", "process_out_blocks": "0", "process_user_time": 9.345247}
[0m01:30:29.884875 [debug] [MainThread]: Command `dbt run` succeeded at 01:30:29.884656 after 23.70 seconds
[0m01:30:29.885575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284ab550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128b535b0>]}
[0m01:30:29.886271 [debug] [MainThread]: Flushing usage events
[0m01:30:31.142645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:22.372431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be4e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce3d3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce3d8a0>]}


============================== 21:44:22.379555 | 395b7dee-e3fa-43ef-bd8f-bfb0c11db987 ==============================
[0m21:44:22.379555 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:44:22.380606 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'quiet': 'False', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False'}
[0m21:44:22.681702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '395b7dee-e3fa-43ef-bd8f-bfb0c11db987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf93910>]}
[0m21:44:22.711778 [debug] [MainThread]: Set downloads directory='/var/folders/77/z8q258y51kz9434dzbpf84fr0000gn/T/dbt-downloads-0kmm7oug'
[0m21:44:22.712465 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:44:23.015137 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:44:23.020531 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:44:23.321053 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:44:23.352120 [info ] [MainThread]: Updating lock file in file path: /Users/tamdang/Documents/DE_Test/DE_test/package-lock.yml
[0m21:44:23.355586 [debug] [MainThread]: Set downloads directory='/var/folders/77/z8q258y51kz9434dzbpf84fr0000gn/T/dbt-downloads-ezcij179'
[0m21:44:23.361873 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:44:24.134910 [info ] [MainThread]: Installed from version 1.1.1
[0m21:44:24.136046 [info ] [MainThread]: Updated version available: 1.3.2
[0m21:44:24.137003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '395b7dee-e3fa-43ef-bd8f-bfb0c11db987', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd2650>]}
[0m21:44:24.138236 [info ] [MainThread]: 
[0m21:44:24.139342 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:44:24.146976 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8921021, "process_in_blocks": "0", "process_kernel_time": 0.655812, "process_mem_max_rss": "104116224", "process_out_blocks": "0", "process_user_time": 2.263986}
[0m21:44:24.147898 [debug] [MainThread]: Command `dbt deps` succeeded at 21:44:24.147705 after 1.89 seconds
[0m21:44:24.148511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be4e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf89090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd3c10>]}
[0m21:44:24.149081 [debug] [MainThread]: Flushing usage events
[0m21:44:25.292635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:41.536858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c5270>]}


============================== 21:45:41.545435 | ee84b367-2c1d-493e-b571-e35c03125d67 ==============================
[0m21:45:41.545435 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:45:41.546670 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'target_path': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select int', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:45:48.682597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee84b367-2c1d-493e-b571-e35c03125d67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a180a0>]}
[0m21:45:48.753956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee84b367-2c1d-493e-b571-e35c03125d67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289f0d00>]}
[0m21:45:48.754802 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:45:49.083531 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:45:49.225075 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:45:49.225962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee84b367-2c1d-493e-b571-e35c03125d67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5ac80>]}
[0m21:45:50.745129 [error] [MainThread]: Encountered an error:
Compilation Error in model int_users_scd2 (models/int/int_users_scd2.sql)
  expected token ',', got 'key'
    line 4
      unique_key='user_kyc_key'  -- Surrogate key
[0m21:45:50.749653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.313775, "process_in_blocks": "0", "process_kernel_time": 1.624222, "process_mem_max_rss": "345546752", "process_out_blocks": "0", "process_user_time": 7.247702}
[0m21:45:50.750771 [debug] [MainThread]: Command `dbt run` failed at 21:45:50.750557 after 9.32 seconds
[0m21:45:50.751303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061be4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12919ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12919cfd0>]}
[0m21:45:50.751817 [debug] [MainThread]: Flushing usage events
[0m21:45:52.055486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:29.048756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cec9270>]}


============================== 21:46:29.055181 | 9bc51836-8a7b-4615-995b-b82f472a4e9d ==============================
[0m21:46:29.055181 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:46:29.056019 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt run --select int', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m21:46:32.601353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bc51836-8a7b-4615-995b-b82f472a4e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e7e24a0>]}
[0m21:46:32.682400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bc51836-8a7b-4615-995b-b82f472a4e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e819510>]}
[0m21:46:32.683379 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:46:32.959898 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:46:33.093540 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:46:33.094455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bc51836-8a7b-4615-995b-b82f472a4e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c762c50>]}
[0m21:46:34.494680 [error] [MainThread]: Encountered an error:
Compilation Error in model int_users_scd2 (models/int/int_users_scd2.sql)
  expected token ',', got 'key'
    line 4
      unique_key='user_kyc_key'  -- Surrogate key
[0m21:46:34.496790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5449786, "process_in_blocks": "0", "process_kernel_time": 1.009452, "process_mem_max_rss": "345907200", "process_out_blocks": "0", "process_user_time": 6.545263}
[0m21:46:34.497719 [debug] [MainThread]: Command `dbt run` failed at 21:46:34.497581 after 5.55 seconds
[0m21:46:34.498207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef93fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef90fd0>]}
[0m21:46:34.498658 [debug] [MainThread]: Flushing usage events
[0m21:46:35.778875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:03.565346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088aa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a5270>]}


============================== 21:48:03.570328 | b5d655ab-b5fc-4e54-bce4-e8beabd9d960 ==============================
[0m21:48:03.570328 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:48:03.571196 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select int', 'no_print': 'None', 'empty': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m21:48:07.736897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d655ab-b5fc-4e54-bce4-e8beabd9d960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1281a0820>]}
[0m21:48:07.807133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d655ab-b5fc-4e54-bce4-e8beabd9d960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109184580>]}
[0m21:48:07.808578 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:48:08.119530 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:48:08.261540 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:48:08.262533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5d655ab-b5fc-4e54-bce4-e8beabd9d960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914acb0>]}
[0m21:48:09.760336 [error] [MainThread]: Encountered an error:
Compilation Error in model int_users_scd2 (models/int/int_users_scd2.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The de_test_dwh.int_users_scd2 model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model int_users_scd2 (models/int/int_users_scd2.sql)
[0m21:48:09.763516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.279424, "process_in_blocks": "0", "process_kernel_time": 1.110373, "process_mem_max_rss": "346411008", "process_out_blocks": "0", "process_user_time": 6.702256}
[0m21:48:09.764350 [debug] [MainThread]: Command `dbt run` failed at 21:48:09.764210 after 6.28 seconds
[0m21:48:09.764884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088aa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b6c64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b8a45e0>]}
[0m21:48:09.765338 [debug] [MainThread]: Flushing usage events
[0m21:48:10.916758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:14.940722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f346530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110348df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103492a0>]}


============================== 21:51:14.950442 | b2d253bf-aa19-405e-91b8-e320c5f2d9e6 ==============================
[0m21:51:14.950442 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:51:14.951714 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'invocation_command': 'dbt run --select int', 'partial_parse': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'empty': 'False'}
[0m21:51:21.189393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131deb670>]}
[0m21:51:21.266935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e14e0>]}
[0m21:51:21.267881 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:51:21.581303 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:51:21.722544 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:51:21.723523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbe6d10>]}
[0m21:51:23.740956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1327ec130>]}
[0m21:51:23.868550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:51:23.873193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:51:23.917727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328157b0>]}
[0m21:51:23.918526 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m21:51:23.919107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328156c0>]}
[0m21:51:23.921061 [info ] [MainThread]: 
[0m21:51:23.921710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:23.922254 [info ] [MainThread]: 
[0m21:51:23.923006 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:51:23.929114 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m21:51:23.929985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:25.167042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m21:51:25.167893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:25.903065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m21:51:25.905367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:27.216222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m21:51:27.219250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:27.880148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132814100>]}
[0m21:51:27.881362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:27.935488 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m21:51:27.936273 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m21:51:27.936994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.int_rates_usdt)
[0m21:51:27.937572 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m21:51:27.950697 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m21:51:27.951825 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m21:51:27.986307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:28.664585 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m21:51:28.665879 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m21:51:30.495183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:74c5e5f6-0871-408e-aa3b-b2267e0a077b&page=queryresults
[0m21:51:35.429254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee00970>]}
[0m21:51:35.430386 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (30.4k rows, 3.3 MiB processed)[0m in 7.49s]
[0m21:51:35.431267 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m21:51:35.431861 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m21:51:35.432721 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh_dev_intermediate.int_users_scd2 ............... [RUN]
[0m21:51:35.433457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.int_users_scd2)
[0m21:51:35.434040 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m21:51:35.440354 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m21:51:35.441673 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m21:51:35.447718 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m21:51:35.449312 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * from final
order by user_id, effective_from
    );
  
[0m21:51:35.450284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:37.756992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:feb62589-bd40-44d5-b52b-d9690c77cec7&page=queryresults
[0m21:51:39.525522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132a00790>]}
[0m21:51:39.527563 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh_dev_intermediate.int_users_scd2 .......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 4.09s]
[0m21:51:39.528871 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m21:51:39.529708 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m21:51:39.530643 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m21:51:39.531572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m21:51:39.532337 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m21:51:39.539836 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:51:39.541994 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m21:51:39.648522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:40.309040 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:51:40.310737 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
    );
  
[0m21:51:41.342647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2210ede4-3e0c-4beb-9e9b-40c41c8907c7&page=queryresults
[0m21:51:41.517193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2210ede4-3e0c-4beb-9e9b-40c41c8907c7&page=queryresults
[0m21:51:41.547555 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:51:41.548667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d253bf-aa19-405e-91b8-e320c5f2d9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132e23c10>]}
[0m21:51:41.549795 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 2.02s]
[0m21:51:41.550776 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m21:51:41.551585 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql.
[0m21:51:41.555140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:41.601780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:41.602783 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m21:51:41.603445 [info ] [MainThread]: 
[0m21:51:41.604011 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 17.68 seconds (17.68s).
[0m21:51:41.605236 [debug] [MainThread]: Command end result
[0m21:51:41.655648 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:51:41.658758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:51:41.668773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m21:51:41.669616 [info ] [MainThread]: 
[0m21:51:41.670386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:51:41.671200 [info ] [MainThread]: 
[0m21:51:41.672396 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)[0m
[0m21:51:41.673304 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:51:41.673851 [info ] [MainThread]: 
[0m21:51:41.674698 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:51:41.675588 [info ] [MainThread]: 
[0m21:51:41.676363 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:51:41.679758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 26.845581, "process_in_blocks": "0", "process_kernel_time": 1.881381, "process_mem_max_rss": "366948352", "process_out_blocks": "0", "process_user_time": 9.98911}
[0m21:51:41.680519 [debug] [MainThread]: Command `dbt run` failed at 21:51:41.680374 after 26.85 seconds
[0m21:51:41.681144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f346530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1326a4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c3e80>]}
[0m21:51:41.681866 [debug] [MainThread]: Flushing usage events
[0m21:51:42.871230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:00.635836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e42d270>]}


============================== 21:53:00.643913 | 099cf35c-c520-4fa5-b8eb-2e326913c280 ==============================
[0m21:53:00.643913 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:53:00.644776 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select int', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m21:53:06.493327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ce7c820>]}
[0m21:53:06.568988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd2c580>]}
[0m21:53:06.569810 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:53:06.900596 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:53:07.343457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:07.344247 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/int/int_users_scd2.sql
[0m21:53:07.697201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306703d0>]}
[0m21:53:07.823135 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:53:07.826570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:53:07.861202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306783d0>]}
[0m21:53:07.862025 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m21:53:07.862601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13067a9b0>]}
[0m21:53:07.864667 [info ] [MainThread]: 
[0m21:53:07.865348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:53:07.865827 [info ] [MainThread]: 
[0m21:53:07.866574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:53:07.872890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m21:53:07.873637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:08.800853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_analytics)
[0m21:53:08.801886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:09.924546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m21:53:09.926285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:10.607840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m21:53:10.610368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:11.271215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bac7bb0>]}
[0m21:53:11.272589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:11.330964 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m21:53:11.332034 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m21:53:11.332774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.int_rates_usdt)
[0m21:53:11.333234 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m21:53:11.344308 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m21:53:11.345340 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m21:53:11.378298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:12.054973 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m21:53:12.056101 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m21:53:13.912443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:64cba7aa-1f49-4a13-806c-6fa8b6d5f2a1&page=queryresults
[0m21:53:19.048247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e429330>]}
[0m21:53:19.049733 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (30.4k rows, 3.3 MiB processed)[0m in 7.71s]
[0m21:53:19.050794 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m21:53:19.051476 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m21:53:19.052315 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh_dev_intermediate.int_users_scd2 ............... [RUN]
[0m21:53:19.053245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.int_users_scd2)
[0m21:53:19.053860 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m21:53:19.060749 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m21:53:19.061850 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m21:53:19.067763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:19.682749 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m21:53:19.684016 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m21:53:20.662902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:69be4846-0f70-44b3-99ee-50371dadbae0&page=queryresults
[0m21:53:22.274772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130794c10>]}
[0m21:53:22.276388 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh_dev_intermediate.int_users_scd2 .......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.22s]
[0m21:53:22.277781 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m21:53:22.278771 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m21:53:22.280124 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m21:53:22.281279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m21:53:22.282121 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m21:53:22.290745 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:53:22.294018 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m21:53:22.298273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:22.905610 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:53:22.908248 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
    );
  
[0m21:53:23.640450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:da519a75-792e-4784-9b40-c76c6aaa1afd&page=queryresults
[0m21:53:23.778765 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:da519a75-792e-4784-9b40-c76c6aaa1afd&page=queryresults
[0m21:53:23.809328 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:53:23.810656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099cf35c-c520-4fa5-b8eb-2e326913c280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130aa5990>]}
[0m21:53:23.811745 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 1.53s]
[0m21:53:23.812723 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m21:53:23.813472 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql.
[0m21:53:23.815999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:23.862198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:23.862802 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m21:53:23.863376 [info ] [MainThread]: 
[0m21:53:23.863924 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m21:53:23.865463 [debug] [MainThread]: Command end result
[0m21:53:23.910330 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:53:23.912578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:53:23.920803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m21:53:23.921493 [info ] [MainThread]: 
[0m21:53:23.922017 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:53:23.922982 [info ] [MainThread]: 
[0m21:53:23.923777 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)[0m
[0m21:53:23.924359 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/int/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:53:23.924828 [info ] [MainThread]: 
[0m21:53:23.925398 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/int/int_transactions_with_rates.sql
[0m21:53:23.925826 [info ] [MainThread]: 
[0m21:53:23.926343 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m21:53:23.929753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.42282, "process_in_blocks": "0", "process_kernel_time": 1.779221, "process_mem_max_rss": "360845312", "process_out_blocks": "0", "process_user_time": 8.611615}
[0m21:53:23.930828 [debug] [MainThread]: Command `dbt run` failed at 21:53:23.930463 after 23.42 seconds
[0m21:53:23.931551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4724d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130672050>]}
[0m21:53:23.932154 [debug] [MainThread]: Flushing usage events
[0m21:53:25.220717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:55:28.268679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fe4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f9270>]}


============================== 21:55:28.273437 | 791626b0-4e60-4f62-84bd-b33237776198 ==============================
[0m21:55:28.273437 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:55:28.274212 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_transactions_with_rates', 'warn_error': 'None', 'printer_width': '80', 'empty': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs'}
[0m21:55:31.234023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3b3580>]}
[0m21:55:31.364029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1293c8490>]}
[0m21:55:31.365990 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:55:31.715533 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:55:32.118737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:55:32.119386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:55:32.194092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c994e50>]}
[0m21:55:32.327955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:55:32.330584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:55:32.350036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c398130>]}
[0m21:55:32.350937 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m21:55:32.351516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c550eb0>]}
[0m21:55:32.353503 [info ] [MainThread]: 
[0m21:55:32.354178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:55:32.354708 [info ] [MainThread]: 
[0m21:55:32.355559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:55:32.363002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_analytics'
[0m21:55:32.363950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:33.426668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m21:55:33.428057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:34.083413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m21:55:34.085356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:34.708905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '791626b0-4e60-4f62-84bd-b33237776198', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c732140>]}
[0m21:55:34.709888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:34.762553 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m21:55:34.763411 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.int_transactions_with_rates'
[0m21:55:34.763909 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m21:55:34.779157 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:55:34.780205 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m21:55:34.780751 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:55:34.826706 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m21:55:34.828723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:34.829286 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_intermediate' was properly closed.
[0m21:55:34.829733 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m21:55:34.830492 [debug] [MainThread]: Command end result
[0m21:55:34.884464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:55:34.887538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:55:34.899990 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m21:55:34.900665 [info ] [MainThread]: Compiled node 'int_transactions_with_rates' is:


with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
[0m21:55:34.903141 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.723867, "process_in_blocks": "0", "process_kernel_time": 1.005653, "process_mem_max_rss": "349560832", "process_out_blocks": "0", "process_user_time": 6.136789}
[0m21:55:34.903880 [debug] [MainThread]: Command `dbt compile` succeeded at 21:55:34.903733 after 6.72 seconds
[0m21:55:34.904663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fe4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4b88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4dd3f0>]}
[0m21:55:34.905765 [debug] [MainThread]: Flushing usage events
[0m21:55:36.213042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:23.513390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f62470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5d270>]}


============================== 21:58:23.518267 | 2ce0a530-84a1-43f3-a7fd-532e7c351fee ==============================
[0m21:58:23.518267 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:58:23.519116 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt compile --select int_transactions_with_rates', 'introspect': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'empty': 'False'}
[0m21:58:26.266238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d893f0>]}
[0m21:58:26.338050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d898a0>]}
[0m21:58:26.338985 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:58:26.740957 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:58:27.068379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:27.068908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:27.134310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f9ce20>]}
[0m21:58:27.265002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:58:27.267497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:58:27.283701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d360b0>]}
[0m21:58:27.284403 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m21:58:27.284974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d361a0>]}
[0m21:58:27.286866 [info ] [MainThread]: 
[0m21:58:27.287455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:58:27.287979 [info ] [MainThread]: 
[0m21:58:27.288710 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:58:27.295916 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_analytics'
[0m21:58:27.297645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:28.520394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m21:58:28.522245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:29.197181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m21:58:29.199485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:29.792122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce0a530-84a1-43f3-a7fd-532e7c351fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103613bb0>]}
[0m21:58:29.793388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:29.846038 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m21:58:29.846800 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.int_transactions_with_rates'
[0m21:58:29.847281 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m21:58:29.862285 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:58:29.863298 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m21:58:29.863831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:58:29.908472 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m21:58:29.910090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:29.910561 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_staging' was properly closed.
[0m21:58:29.910949 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m21:58:29.911695 [debug] [MainThread]: Command end result
[0m21:58:29.953567 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:58:29.956594 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:58:29.967749 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m21:58:29.968427 [info ] [MainThread]: Compiled node 'int_transactions_with_rates' is:


with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
[0m21:58:29.971514 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 6.543046, "process_in_blocks": "0", "process_kernel_time": 0.931933, "process_mem_max_rss": "349077504", "process_out_blocks": "0", "process_user_time": 5.862927}
[0m21:58:29.972427 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:29.972278 after 6.54 seconds
[0m21:58:29.972972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f62470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d893f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127ae71f0>]}
[0m21:58:29.973443 [debug] [MainThread]: Flushing usage events
[0m21:58:31.125688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:47.385443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106038dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106039270>]}


============================== 21:59:47.394325 | 0a5116de-e24a-4610-bd68-6d08118b2822 ==============================
[0m21:59:47.394325 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m21:59:47.395527 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt compile --select int_transactions_with_rates', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m21:59:53.928045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279f75e0>]}
[0m21:59:54.053920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a29780>]}
[0m21:59:54.055223 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m21:59:54.458147 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m21:59:54.909404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:59:54.909998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:59:55.002161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12809cdc0>]}
[0m21:59:55.162133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:59:55.166375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:59:55.212070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f56650>]}
[0m21:59:55.212861 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m21:59:55.213454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127c5ce20>]}
[0m21:59:55.215404 [info ] [MainThread]: 
[0m21:59:55.216395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:55.217201 [info ] [MainThread]: 
[0m21:59:55.218159 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:55.225509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_analytics'
[0m21:59:55.228165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:56.323960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m21:59:56.325331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:56.990635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m21:59:56.995380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:57.647237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a5116de-e24a-4610-bd68-6d08118b2822', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e36050>]}
[0m21:59:57.648198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:57.702144 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m21:59:57.702856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.int_transactions_with_rates)
[0m21:59:57.703367 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m21:59:57.719749 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m21:59:57.720742 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m21:59:57.721304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:57.766712 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m21:59:57.769828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:57.770519 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m21:59:57.771358 [debug] [MainThread]: Command end result
[0m21:59:57.820925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m21:59:57.824091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m21:59:57.835583 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m21:59:57.836268 [info ] [MainThread]: Compiled node 'int_transactions_with_rates' is:


with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
[0m21:59:57.841008 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 10.552346, "process_in_blocks": "0", "process_kernel_time": 1.878539, "process_mem_max_rss": "350072832", "process_out_blocks": "0", "process_user_time": 7.584714}
[0m21:59:57.842332 [debug] [MainThread]: Command `dbt compile` succeeded at 21:59:57.841979 after 10.55 seconds
[0m21:59:57.843403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127be49a0>]}
[0m21:59:57.844248 [debug] [MainThread]: Flushing usage events
[0m21:59:59.180522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:39.625087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129de500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d9240>]}


============================== 22:00:39.633164 | ed5661a7-207f-4c49-8bc4-2e2afdc96746 ==============================
[0m22:00:39.633164 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m22:00:39.634346 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select int', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'log_format': 'default'}
[0m22:00:45.512827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b257b0>]}
[0m22:00:45.593448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139db370>]}
[0m22:00:45.594488 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m22:00:45.935183 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m22:00:46.382500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:46.383524 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/int/int_transactions_with_rates.sql
[0m22:00:46.747692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ae4130>]}
[0m22:00:46.874789 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m22:00:46.879770 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m22:00:46.923473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135afa230>]}
[0m22:00:46.924265 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m22:00:46.925207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1359bf490>]}
[0m22:00:46.927371 [info ] [MainThread]: 
[0m22:00:46.927983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:46.928443 [info ] [MainThread]: 
[0m22:00:46.929218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:00:46.935587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m22:00:46.936935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:47.710862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_analytics)
[0m22:00:47.711706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:48.743534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m22:00:48.744485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:49.359723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m22:00:49.361222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:49.971196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb9480>]}
[0m22:00:49.973052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:50.029271 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m22:00:50.031013 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m22:00:50.032094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.int_rates_usdt)
[0m22:00:50.032636 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m22:00:50.047069 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m22:00:50.049074 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m22:00:50.078987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:50.676342 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m22:00:50.678265 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m22:00:51.507005 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e024a737-a64a-44d3-903b-a7d13ef06800&page=queryresults
[0m22:00:56.048732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b780a0>]}
[0m22:00:56.050082 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (30.4k rows, 3.3 MiB processed)[0m in 6.01s]
[0m22:00:56.051088 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m22:00:56.052072 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m22:00:56.053203 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh_dev_intermediate.int_users_scd2 ............... [RUN]
[0m22:00:56.053988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.int_users_scd2)
[0m22:00:56.054499 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m22:00:56.079208 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m22:00:56.080221 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m22:00:56.083212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:56.706523 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m22:00:56.709255 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m22:00:57.649604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e6e3f8b3-9ab9-41e1-b08e-ace76f6aff86&page=queryresults
[0m22:00:59.289334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ceac50>]}
[0m22:00:59.291319 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh_dev_intermediate.int_users_scd2 .......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.24s]
[0m22:00:59.292862 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m22:00:59.293763 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m22:00:59.294837 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m22:00:59.295797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m22:00:59.296527 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m22:00:59.303546 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m22:00:59.305461 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m22:00:59.314227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:59.896458 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m22:00:59.899484 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m22:01:00.720468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4ce2830a-7c3d-41e9-87cc-ca0915f2f47d&page=queryresults
[0m22:01:10.257298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed5661a7-207f-4c49-8bc4-2e2afdc96746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b780a0>]}
[0m22:01:10.258934 [info ] [Thread-1 (]: 3 of 3 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (5.0m rows, 688.1 KiB processed)[0m in 10.96s]
[0m22:01:10.260457 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m22:01:10.262813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:10.313983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:10.314596 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m22:01:10.315102 [info ] [MainThread]: 
[0m22:01:10.315675 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 23.39 seconds (23.39s).
[0m22:01:10.317028 [debug] [MainThread]: Command end result
[0m22:01:10.363549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m22:01:10.366794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m22:01:10.375764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m22:01:10.376604 [info ] [MainThread]: 
[0m22:01:10.377527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:01:10.378480 [info ] [MainThread]: 
[0m22:01:10.379274 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m22:01:10.383149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.857452, "process_in_blocks": "0", "process_kernel_time": 1.736038, "process_mem_max_rss": "360456192", "process_out_blocks": "0", "process_user_time": 8.515425}
[0m22:01:10.384099 [debug] [MainThread]: Command `dbt run` succeeded at 22:01:10.383842 after 30.86 seconds
[0m22:01:10.384725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129de500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139db370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13587df60>]}
[0m22:01:10.385234 [debug] [MainThread]: Flushing usage events
[0m22:01:11.624858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:47.109565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11124e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112248dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112249270>]}


============================== 23:03:47.117446 | ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e ==============================
[0m23:03:47.117446 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:03:47.118384 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'empty': 'False', 'invocation_command': 'dbt run --select dim_date', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True'}
[0m23:03:54.186704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139ae60>]}
[0m23:03:54.281366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133aa96c0>]}
[0m23:03:54.282262 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:03:54.640015 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:03:55.122275 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m23:03:55.123130 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/marts/tb_agg_transactions_by_kyc.sql
[0m23:03:55.123618 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/marts/tb_agg_transactions_daily.sql
[0m23:03:55.124081 [debug] [MainThread]: Partial parsing: deleted file: de_test_dwh://models/marts/agg_transactions_daily.sql
[0m23:03:55.124804 [debug] [MainThread]: Partial parsing: deleted file: de_test_dwh://models/marts/agg_transactions_by_kyc.sql
[0m23:03:55.125690 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/dim_date.sql
[0m23:03:55.126846 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/fct_transactions.sql
[0m23:03:55.508645 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_daily' in the 'models' section of file 'models/marts/schema.yml'
[0m23:03:55.511545 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_by_kyc' in the 'models' section of file 'models/marts/schema.yml'
[0m23:03:55.780621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344aa290>]}
[0m23:03:55.950279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:03:55.954760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:03:56.009560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134142b60>]}
[0m23:03:56.010523 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:03:56.011182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13417f010>]}
[0m23:03:56.013846 [info ] [MainThread]: 
[0m23:03:56.014671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:56.015386 [info ] [MainThread]: 
[0m23:03:56.016413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:03:56.017899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:03:56.018618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:56.906556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_analytics)
[0m23:03:56.908029 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_analytics"
"
[0m23:03:56.921036 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_analytics: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_analytics"} */
create schema if not exists `cusma-383203`.`dwh_dev_analytics`
  
[0m23:03:56.921707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:57.821584 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3678595b-2aaf-49e6-bff7-fef83fc869e0&page=queryresults
[0m23:04:01.894691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m23:04:01.895538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:02.537492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m23:04:02.540183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:03.139100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m23:04:03.141196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:03.867599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ffbb0>]}
[0m23:04:03.869123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:03.925559 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m23:04:03.926369 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_analytics.dim_date ........................ [RUN]
[0m23:04:03.927047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now model.de_test_dwh.dim_date)
[0m23:04:03.927607 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m23:04:03.941447 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m23:04:03.942925 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m23:04:03.999327 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m23:04:04.000665 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_analytics`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m23:04:04.001337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:05.399487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6bd27b03-278e-49bf-8b86-0402495903ad&page=queryresults
[0m23:04:07.188405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee459163-ccaa-47f7-9e0a-1cc2d7c8b48e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13446eec0>]}
[0m23:04:07.189728 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_analytics.dim_date ................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.26s]
[0m23:04:07.190708 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m23:04:07.192150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:07.240445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:07.241045 [debug] [MainThread]: Connection 'model.de_test_dwh.dim_date' was properly closed.
[0m23:04:07.241710 [info ] [MainThread]: 
[0m23:04:07.242255 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.23 seconds (11.23s).
[0m23:04:07.243329 [debug] [MainThread]: Command end result
[0m23:04:07.289895 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:04:07.292287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:04:07.300807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:04:07.301399 [info ] [MainThread]: 
[0m23:04:07.302009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:07.302560 [info ] [MainThread]: 
[0m23:04:07.303073 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:04:07.309106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.344973, "process_in_blocks": "0", "process_kernel_time": 2.147971, "process_mem_max_rss": "363835392", "process_out_blocks": "0", "process_user_time": 8.930075}
[0m23:04:07.309957 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:07.309796 after 20.35 seconds
[0m23:04:07.310519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11124e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133aa96c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344abd90>]}
[0m23:04:07.311040 [debug] [MainThread]: Flushing usage events
[0m23:04:08.675996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:17.959980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c65e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d658dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d659270>]}


============================== 23:04:17.964816 | f28bd1c4-60c9-4260-b916-18fdc827dddb ==============================
[0m23:04:17.964816 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:04:17.965665 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt run --select dim_users', 'empty': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs'}
[0m23:04:20.681423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee96530>]}
[0m23:04:20.753425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee96350>]}
[0m23:04:20.754282 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:04:21.048481 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:04:21.228844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:21.229451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:21.445361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee95120>]}
[0m23:04:21.561972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:04:21.564637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:04:21.580444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef632e0>]}
[0m23:04:21.581104 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:04:21.581668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef223b0>]}
[0m23:04:21.583620 [info ] [MainThread]: 
[0m23:04:21.584275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:21.584819 [info ] [MainThread]: 
[0m23:04:21.585543 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:04:21.586550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:04:21.587046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:22.351593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_analytics)
[0m23:04:22.352689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:22.956839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m23:04:22.957860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:23.640324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m23:04:23.642731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:24.256412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0fbb0>]}
[0m23:04:24.258177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:24.311802 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m23:04:24.313097 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_analytics.dim_users ....................... [RUN]
[0m23:04:24.313989 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.dim_users'
[0m23:04:24.314492 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m23:04:24.331762 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m23:04:24.332912 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m23:04:24.394267 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m23:04:24.395394 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_analytics`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Users with SCD Type 2 for historical KYC tracking
-- This allows point-in-time lookups of user KYC levels
-- Each record represents a period when a user had a specific kyc_level

select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m23:04:24.395988 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:25.366609 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dceaef9c-b778-4c57-a8ab-d22591494053&page=queryresults
[0m23:04:27.175780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f28bd1c4-60c9-4260-b916-18fdc827dddb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf78820>]}
[0m23:04:27.178117 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_analytics.dim_users .................. [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.86s]
[0m23:04:27.179241 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m23:04:27.180953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:27.232755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:27.233358 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_intermediate' was properly closed.
[0m23:04:27.233803 [debug] [MainThread]: Connection 'model.de_test_dwh.dim_users' was properly closed.
[0m23:04:27.234258 [info ] [MainThread]: 
[0m23:04:27.234738 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m23:04:27.235647 [debug] [MainThread]: Command end result
[0m23:04:27.284834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:04:27.289090 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:04:27.298603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:04:27.299350 [info ] [MainThread]: 
[0m23:04:27.299957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:27.300453 [info ] [MainThread]: 
[0m23:04:27.300980 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:04:27.305644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.426151, "process_in_blocks": "0", "process_kernel_time": 0.936989, "process_mem_max_rss": "355766272", "process_out_blocks": "0", "process_user_time": 6.192175}
[0m23:04:27.306698 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:27.306512 after 9.43 seconds
[0m23:04:27.308323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c65e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f101b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f1039a0>]}
[0m23:04:27.310503 [debug] [MainThread]: Flushing usage events
[0m23:04:28.316022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:45.211170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11250a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350d2a0>]}


============================== 23:04:45.217669 | d15c924f-5b5c-4fa0-9b66-4b4dc437bf11 ==============================
[0m23:04:45.217669 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:04:45.218496 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt run --select dim_currencies', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'empty': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m23:04:50.647496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264ea10>]}
[0m23:04:50.720217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134de96c0>]}
[0m23:04:50.721094 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:04:51.051728 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:04:51.380012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:51.380892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:51.599347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354b9ea0>]}
[0m23:04:51.721809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:04:51.726002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:04:51.761524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1350266e0>]}
[0m23:04:51.762378 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:04:51.762930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134e736d0>]}
[0m23:04:51.764857 [info ] [MainThread]: 
[0m23:04:51.765487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:51.766012 [info ] [MainThread]: 
[0m23:04:51.766995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:04:51.768104 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:04:51.768651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:52.522676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m23:04:52.523758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:53.104850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_analytics)
[0m23:04:53.107083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:53.685686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_staging)
[0m23:04:53.687908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:54.254436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135025840>]}
[0m23:04:54.255780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:54.310008 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m23:04:54.310774 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_analytics.dim_currencies .................. [RUN]
[0m23:04:54.311509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.dim_currencies)
[0m23:04:54.311947 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m23:04:54.327101 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m23:04:54.328491 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m23:04:54.379027 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m23:04:54.380244 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_analytics`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m23:04:54.380887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:04:55.577852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b305f463-be3c-49cb-bd4c-e3efb51c27cc&page=queryresults
[0m23:04:57.505615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd15c924f-5b5c-4fa0-9b66-4b4dc437bf11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131ec88b0>]}
[0m23:04:57.507070 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_analytics.dim_currencies ............. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.19s]
[0m23:04:57.508076 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m23:04:57.509719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:57.555448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:57.556045 [debug] [MainThread]: Connection 'model.de_test_dwh.dim_currencies' was properly closed.
[0m23:04:57.556691 [info ] [MainThread]: 
[0m23:04:57.557248 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.79 seconds (5.79s).
[0m23:04:57.558186 [debug] [MainThread]: Command end result
[0m23:04:57.603635 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:04:57.606004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:04:57.614624 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:04:57.615424 [info ] [MainThread]: 
[0m23:04:57.616193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:57.616758 [info ] [MainThread]: 
[0m23:04:57.617338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:04:57.621424 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.505846, "process_in_blocks": "0", "process_kernel_time": 1.652239, "process_mem_max_rss": "354480128", "process_out_blocks": "0", "process_user_time": 7.810406}
[0m23:04:57.622257 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:57.622076 after 12.51 seconds
[0m23:04:57.623349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11250a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135379cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354ba8f0>]}
[0m23:04:57.624071 [debug] [MainThread]: Flushing usage events
[0m23:04:58.751031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:40.904028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a98dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a99270>]}


============================== 23:32:40.911178 | 56469271-5ee6-47ed-8043-88932c7502ce ==============================
[0m23:32:40.911178 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:32:40.912133 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_transactions', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'quiet': 'False'}
[0m23:32:48.115050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12734a3b0>]}
[0m23:32:48.214403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c5900>]}
[0m23:32:48.215309 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:32:48.785738 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:32:49.112881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:49.113903 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/dim_users.sql
[0m23:32:49.943963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac8a710>]}
[0m23:32:50.101379 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:32:50.105498 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:32:50.163111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac79ff0>]}
[0m23:32:50.164211 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:32:50.164933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac7a4d0>]}
[0m23:32:50.167791 [info ] [MainThread]: 
[0m23:32:50.169192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:50.170389 [info ] [MainThread]: 
[0m23:32:50.172861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:32:50.174951 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:32:50.176123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:51.152655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m23:32:51.153625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:51.781770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_analytics)
[0m23:32:51.783282 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:52.410851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_analytics, now list_cusma-383203_dwh_dev_intermediate)
[0m23:32:52.413177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:53.069388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac7bca0>]}
[0m23:32:53.070241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:53.129156 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:32:53.130063 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_analytics.fct_transactions ................ [RUN]
[0m23:32:53.131242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.fct_transactions)
[0m23:32:53.135258 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:32:53.159242 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:32:53.160983 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:32:53.228075 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:32:53.229901 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_analytics`.`fct_transactions`
      
    
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        t.transaction_amount_usd,
        u.kyc_level as kyc_level_at_transaction,
        u.user_kyc_key as kyc_surrogate_key, 
        u.effective_from as kyc_effective_from,
        u.effective_to as kyc_effective_to,
        u.is_current as kyc_is_current_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
order by transaction_date, txn_id
    );
  
[0m23:32:53.230987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:54.990939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:00bab651-8d3c-4754-9f43-9a7c873798d5&page=queryresults
[0m23:32:55.141319 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:00bab651-8d3c-4754-9f43-9a7c873798d5&page=queryresults
[0m23:32:55.163914 [debug] [Thread-1 (]: Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Name transaction_amount_usd not found inside t at [41:11]
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql
[0m23:32:55.166644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56469271-5ee6-47ed-8043-88932c7502ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac887f0>]}
[0m23:32:55.168044 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_analytics.fct_transactions ....... [[31mERROR[0m in 2.03s]
[0m23:32:55.169791 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:32:55.171294 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.fct_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Name transaction_amount_usd not found inside t at [41:11]
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql.
[0m23:32:55.175075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:55.222874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:55.223464 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m23:32:55.223929 [info ] [MainThread]: 
[0m23:32:55.224502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m23:32:55.225474 [debug] [MainThread]: Command end result
[0m23:32:55.292334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:32:55.296202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:32:55.308365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:32:55.309316 [info ] [MainThread]: 
[0m23:32:55.310386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:32:55.311164 [info ] [MainThread]: 
[0m23:32:55.312005 [error] [MainThread]: [31mFailure in model fct_transactions (models/marts/fct_transactions.sql)[0m
[0m23:32:55.312757 [error] [MainThread]:   Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Name transaction_amount_usd not found inside t at [41:11]
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql
[0m23:32:55.313325 [info ] [MainThread]: 
[0m23:32:55.313859 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/fct_transactions.sql
[0m23:32:55.314298 [info ] [MainThread]: 
[0m23:32:55.314949 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:55.319234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.531228, "process_in_blocks": "0", "process_kernel_time": 2.022993, "process_mem_max_rss": "357859328", "process_out_blocks": "0", "process_user_time": 8.788399}
[0m23:32:55.321148 [debug] [MainThread]: Command `dbt run` failed at 23:32:55.320897 after 14.53 seconds
[0m23:32:55.322854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac06e00>]}
[0m23:32:55.324069 [debug] [MainThread]: Flushing usage events
[0m23:32:56.865466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:37.288576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106508fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106509480>]}


============================== 23:34:37.295450 | 430c8067-80c7-47ef-af8c-4ab0f223204f ==============================
[0m23:34:37.295450 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:34:37.296267 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select fct_transactions', 'empty': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:34:43.385628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127eb35b0>]}
[0m23:34:43.469492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106331900>]}
[0m23:34:43.470438 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:34:43.793540 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:34:43.939299 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:34:43.940247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da6cb0>]}
[0m23:34:45.722192 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_daily' in the 'models' section of file 'models/marts/schema.yml'
[0m23:34:45.724253 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_by_kyc' in the 'models' section of file 'models/marts/schema.yml'
[0m23:34:46.034730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288f16c0>]}
[0m23:34:46.157093 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:34:46.161270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:34:46.204207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288f11b0>]}
[0m23:34:46.204967 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:34:46.205631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288f12d0>]}
[0m23:34:46.207575 [info ] [MainThread]: 
[0m23:34:46.208237 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:46.208755 [info ] [MainThread]: 
[0m23:34:46.209463 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:34:46.210452 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:34:46.211172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:47.165377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_mart)
[0m23:34:47.166949 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_mart"
"
[0m23:34:47.183088 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_mart: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_mart"} */
create schema if not exists `cusma-383203`.`dwh_dev_mart`
  
[0m23:34:47.183879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:47.917591 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:55cddb01-3fc0-4873-9e1f-3ca0a978310a&page=queryresults
[0m23:34:51.154362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m23:34:51.155148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:51.786917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m23:34:51.788444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.353367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m23:34:52.354921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:52.928630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e0e050>]}
[0m23:34:52.930143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:52.986579 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:34:52.987475 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m23:34:52.988202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.fct_transactions)
[0m23:34:52.988681 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:34:53.002994 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:34:53.004531 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:34:53.051568 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:34:53.052739 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction,
        u.user_kyc_key as kyc_surrogate_key, 
        u.effective_from as kyc_effective_from,
        u.effective_to as kyc_effective_to,
        u.is_current as kyc_is_current_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
order by transaction_date, txn_id
    );
  
[0m23:34:53.053370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:54.015558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ff3062a7-3e15-44bf-ba09-0a5dd13a9e02&page=queryresults
[0m23:34:59.875797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '430c8067-80c7-47ef-af8c-4ab0f223204f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289c1060>]}
[0m23:34:59.877408 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 6.89s]
[0m23:34:59.878706 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:34:59.880582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:59.927782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:59.928386 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m23:34:59.928847 [info ] [MainThread]: 
[0m23:34:59.929356 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 13.72 seconds (13.72s).
[0m23:34:59.930492 [debug] [MainThread]: Command end result
[0m23:34:59.975104 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:34:59.977321 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:34:59.985315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:34:59.985952 [info ] [MainThread]: 
[0m23:34:59.986869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:59.987794 [info ] [MainThread]: 
[0m23:34:59.988428 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:34:59.992065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.800694, "process_in_blocks": "0", "process_kernel_time": 1.745237, "process_mem_max_rss": "367669248", "process_out_blocks": "0", "process_user_time": 9.519347}
[0m23:34:59.992858 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:59.992627 after 22.80 seconds
[0m23:34:59.993623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128996ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127eb0cd0>]}
[0m23:34:59.994237 [debug] [MainThread]: Flushing usage events
[0m23:35:01.295296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:35.524821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db524a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb4cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb4d270>]}


============================== 23:35:35.532331 | 829506a1-7b89-4f78-ae78-f1aa8dd3e4ca ==============================
[0m23:35:35.532331 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:35:35.533451 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m23:35:41.687346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130537340>]}
[0m23:35:41.773809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13050f820>]}
[0m23:35:41.774730 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:35:42.112910 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:35:42.398170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:35:42.398783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:35:42.617474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130b943a0>]}
[0m23:35:42.736044 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:35:42.739936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:35:42.783301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a8cb50>]}
[0m23:35:42.784095 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:35:42.784681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a8c550>]}
[0m23:35:42.787278 [info ] [MainThread]: 
[0m23:35:42.788023 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:42.788544 [info ] [MainThread]: 
[0m23:35:42.789294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:35:42.796508 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:35:42.797970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:43.656718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m23:35:43.674687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:44.322341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m23:35:44.323382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:44.985190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m23:35:44.987697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:45.576139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb12a40>]}
[0m23:35:45.577389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:45.634873 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m23:35:45.635949 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m23:35:45.636727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.dim_currencies)
[0m23:35:45.637249 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m23:35:45.653548 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m23:35:45.655243 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m23:35:45.706498 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m23:35:45.707926 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m23:35:45.708616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:47.058383 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5900a290-425a-48e8-bae2-3fd7a4dcd1a4&page=queryresults
[0m23:35:48.982017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130921d50>]}
[0m23:35:48.983311 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.34s]
[0m23:35:48.984262 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m23:35:48.984906 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m23:35:48.985732 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m23:35:48.986527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m23:35:48.987138 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m23:35:48.992031 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m23:35:48.993222 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m23:35:48.999613 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m23:35:49.001229 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m23:35:49.001964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:50.236339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d855a945-2189-4e13-8fc4-ab18f07a6eb0&page=queryresults
[0m23:35:52.251933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d279de0>]}
[0m23:35:52.253563 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.27s]
[0m23:35:52.254960 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m23:35:52.255906 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m23:35:52.257082 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m23:35:52.258141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m23:35:52.258909 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m23:35:52.265061 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m23:35:52.266331 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m23:35:52.274200 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m23:35:52.275531 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m23:35:52.276209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:53.161075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ea598931-98b5-4ce8-8cc7-194384a681bf&page=queryresults
[0m23:35:55.060643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c498a0>]}
[0m23:35:55.063855 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.80s]
[0m23:35:55.065507 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m23:35:55.066463 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:35:55.067613 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m23:35:55.068658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m23:35:55.069512 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:35:55.076556 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:35:55.079685 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:35:55.084268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:55.752632 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:35:55.755196 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction,
        u.user_kyc_key as kyc_surrogate_key, 
        u.effective_from as kyc_effective_from,
        u.effective_to as kyc_effective_to,
        u.is_current as kyc_is_current_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
order by transaction_date, txn_id
    );
  
[0m23:35:56.174054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0243abe2-6253-4edf-b362-b26e566f8da7&page=queryresults
[0m23:36:00.898181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d279de0>]}
[0m23:36:00.899569 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.83s]
[0m23:36:00.900707 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:36:00.903839 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:36:00.905297 [info ] [Thread-1 (]: 5 of 6 START sql table model dwh_dev_mart.tb_agg_transactions_by_kyc ........... [RUN]
[0m23:36:00.906623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_agg_transactions_by_kyc)
[0m23:36:00.907493 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:36:00.915639 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m23:36:00.916956 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:36:00.922795 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m23:36:00.924788 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

-- Aggregated fact: Completed transactions by KYC level (at transaction time)
-- Answers business question: "View completed transactions by users at each KYC level"
-- Uses historical KYC level (kyc_level_at_transaction) not current level

select
    kyc_level_at_transaction,
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month,
    count(distinct txn_id) as completed_transaction_count,
    count(distinct user_id) as unique_users,
    sum(transaction_amount_usd) as total_volume_usd,
    avg(transaction_amount_usd) as avg_transaction_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
    and kyc_level_at_transaction is not null
group by
    kyc_level_at_transaction,
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month
    );
  
[0m23:36:00.925773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:01.807659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0dbd1309-7561-40e7-aa58-a2a41d53d416&page=queryresults
[0m23:36:01.910782 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0dbd1309-7561-40e7-aa58-a2a41d53d416&page=queryresults
[0m23:36:01.939797 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:36:01.940969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130d3add0>]}
[0m23:36:01.942443 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model dwh_dev_mart.tb_agg_transactions_by_kyc .. [[31mERROR[0m in 1.03s]
[0m23:36:01.943777 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:36:01.944483 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:36:01.945515 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql.
[0m23:36:01.946588 [info ] [Thread-1 (]: 6 of 6 START sql table model dwh_dev_mart.tb_agg_transactions_daily ............ [RUN]
[0m23:36:01.948412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_agg_transactions_by_kyc, now model.de_test_dwh.tb_agg_transactions_daily)
[0m23:36:01.949534 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_daily
[0m23:36:01.957906 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_daily"
[0m23:36:01.959640 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_daily
[0m23:36:01.966559 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_daily"
[0m23:36:01.967819 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_daily: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_daily"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_daily`
      
    
    

    
    OPTIONS()
    as (
      

-- Aggregated fact: Daily transaction volume in USD
-- Answers business question: "Total transaction volume (in USD) by day"

select
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month,
    count(distinct txn_id) as transaction_count,
    count(distinct user_id) as unique_users,
    sum(transaction_amount_usd) as total_volume_usd,
    avg(transaction_amount_usd) as avg_transaction_amount_usd,
    min(transaction_amount_usd) as min_transaction_amount_usd,
    max(transaction_amount_usd) as max_transaction_amount_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
    count(case when status = 'completed' then 1 end) as completed_transaction_count
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month
    );
  
[0m23:36:01.968596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:02.730708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:139aef90-3e38-46f6-8596-b398d8c93f43&page=queryresults
[0m23:36:02.857944 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:139aef90-3e38-46f6-8596-b398d8c93f43&page=queryresults
[0m23:36:02.871638 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:36:02.873745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '829506a1-7b89-4f78-ae78-f1aa8dd3e4ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131219e70>]}
[0m23:36:02.875381 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dwh_dev_mart.tb_agg_transactions_daily ... [[31mERROR[0m in 0.93s]
[0m23:36:02.877176 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:36:02.878385 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_daily' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql.
[0m23:36:02.881170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:02.929889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:02.930497 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_agg_transactions_daily' was properly closed.
[0m23:36:02.931017 [info ] [MainThread]: 
[0m23:36:02.931542 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 20.14 seconds (20.14s).
[0m23:36:02.933431 [debug] [MainThread]: Command end result
[0m23:36:02.976061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:36:02.979330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:36:02.987536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:36:02.988157 [info ] [MainThread]: 
[0m23:36:02.988808 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:36:02.989386 [info ] [MainThread]: 
[0m23:36:02.989996 [error] [MainThread]: [31mFailure in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)[0m
[0m23:36:02.990585 [error] [MainThread]:   Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:36:02.991335 [info ] [MainThread]: 
[0m23:36:02.992061 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:36:02.992619 [info ] [MainThread]: 
[0m23:36:02.993219 [error] [MainThread]: [31mFailure in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)[0m
[0m23:36:02.993802 [error] [MainThread]:   Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:36:02.994680 [info ] [MainThread]: 
[0m23:36:02.995463 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:36:02.996068 [info ] [MainThread]: 
[0m23:36:02.996665 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m23:36:03.000774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 27.592302, "process_in_blocks": "0", "process_kernel_time": 1.863979, "process_mem_max_rss": "357662720", "process_out_blocks": "0", "process_user_time": 8.95346}
[0m23:36:03.003365 [debug] [MainThread]: Command `dbt run` failed at 23:36:03.002902 after 27.59 seconds
[0m23:36:03.004558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db524a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bb3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bb3190>]}
[0m23:36:03.005262 [debug] [MainThread]: Flushing usage events
[0m23:36:04.317131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:08.967356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5240>]}


============================== 23:38:08.974270 | 2ee9f525-62c0-4a69-9dc1-39875f4e8a74 ==============================
[0m23:38:08.974270 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:38:08.975200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'empty': 'False', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --select fct_transactions', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'fail_fast': 'False', 'target_path': 'None'}
[0m23:38:14.884148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff1330>]}
[0m23:38:14.955187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7370>]}
[0m23:38:14.956031 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:38:15.294573 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:38:15.578296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:38:15.578894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:38:15.798744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129c74550>]}
[0m23:38:15.920447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:38:15.924517 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:38:15.966333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129b6bdc0>]}
[0m23:38:15.967033 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:38:15.967575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129b69ff0>]}
[0m23:38:15.969638 [info ] [MainThread]: 
[0m23:38:15.970379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:15.971041 [info ] [MainThread]: 
[0m23:38:15.971803 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:38:15.973334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:38:15.974375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:16.794345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m23:38:16.795377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:17.409431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m23:38:17.412037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:17.971125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m23:38:17.973732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:18.603297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12960e140>]}
[0m23:38:18.604547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:18.661495 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:38:18.662481 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m23:38:18.663547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.fct_transactions)
[0m23:38:18.664895 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:38:18.685439 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:38:18.686467 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:38:18.712018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:19.336035 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:38:19.337639 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction,
        u.user_kyc_key as kyc_surrogate_key, 
        u.effective_from as kyc_effective_from,
        u.effective_to as kyc_effective_to,
        u.is_current as kyc_is_current_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
order by transaction_date, txn_id
    );
  
[0m23:38:19.647253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:81a31cfd-8547-4715-a024-44d195b0a833&page=queryresults
[0m23:38:25.504187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee9f525-62c0-4a69-9dc1-39875f4e8a74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129673340>]}
[0m23:38:25.506335 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 6.84s]
[0m23:38:25.507519 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:38:25.510523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:25.555962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:25.556517 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m23:38:25.556972 [info ] [MainThread]: 
[0m23:38:25.557425 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m23:38:25.558256 [debug] [MainThread]: Command end result
[0m23:38:25.601557 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:38:25.603747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:38:25.611144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:38:25.611907 [info ] [MainThread]: 
[0m23:38:25.612662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:25.613281 [info ] [MainThread]: 
[0m23:38:25.613899 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:38:25.618019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.743462, "process_in_blocks": "0", "process_kernel_time": 1.775743, "process_mem_max_rss": "355426304", "process_out_blocks": "0", "process_user_time": 7.861458}
[0m23:38:25.619075 [debug] [MainThread]: Command `dbt run` succeeded at 23:38:25.618874 after 16.74 seconds
[0m23:38:25.619814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129d0f970>]}
[0m23:38:25.620378 [debug] [MainThread]: Flushing usage events
[0m23:38:26.931558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:46:32.001671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c544dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c545270>]}


============================== 23:46:32.011443 | 27addb77-b56e-415c-a8fb-a503ae5d71a1 ==============================
[0m23:46:32.011443 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:46:32.012584 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --select marts', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m23:46:38.410537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b46e90>]}
[0m23:46:38.482584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde5030>]}
[0m23:46:38.483424 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:46:38.794070 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:46:39.193611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:46:39.194493 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/fct_transactions.sql
[0m23:46:39.195019 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/int/int_transactions_with_rates.sql
[0m23:46:39.695677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e96d9c0>]}
[0m23:46:39.816566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:46:39.821721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:46:39.873075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e72dfc0>]}
[0m23:46:39.874296 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:46:39.875046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac05900>]}
[0m23:46:39.878246 [info ] [MainThread]: 
[0m23:46:39.879021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:46:39.879669 [info ] [MainThread]: 
[0m23:46:39.880758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:46:39.892571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:46:39.894331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:46:41.678682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m23:46:41.679933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:42.314142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m23:46:42.317254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:42.982630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m23:46:42.985250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:46:43.615296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12df26110>]}
[0m23:46:43.616614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:43.672663 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m23:46:43.673431 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m23:46:43.674147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m23:46:43.674640 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m23:46:43.687703 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m23:46:43.689404 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m23:46:43.709277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:44.334009 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m23:46:44.335163 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m23:46:45.658623 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5ff9e698-b1e6-464e-ac7a-ce6a0c2d8560&page=queryresults
[0m23:46:47.506026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac54820>]}
[0m23:46:47.507002 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.83s]
[0m23:46:47.507920 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m23:46:47.508531 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m23:46:47.509337 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m23:46:47.510135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m23:46:47.510743 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m23:46:47.514687 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m23:46:47.516019 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m23:46:47.519137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:48.152325 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m23:46:48.154944 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m23:46:48.959350 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d0f69d5c-56d3-48fc-ad1d-f573ee88fe76&page=queryresults
[0m23:46:50.700325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c99750>]}
[0m23:46:50.701917 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.19s]
[0m23:46:50.703226 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m23:46:50.704332 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m23:46:50.705651 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m23:46:50.706823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m23:46:50.707598 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m23:46:50.713615 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m23:46:50.715631 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m23:46:50.723676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:51.380541 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m23:46:51.381746 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m23:46:51.716871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2e946da6-5f0e-4553-bbe5-6614f3029b38&page=queryresults
[0m23:46:53.357628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e58c3d0>]}
[0m23:46:53.359201 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.65s]
[0m23:46:53.360515 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m23:46:53.361445 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:46:53.362626 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m23:46:53.363734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m23:46:53.364489 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:46:53.371755 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:46:53.373451 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:46:53.389071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:46:53.977429 [debug] [Thread-1 (]: Hard refreshing `cusma-383203`.`dwh_dev_mart`.`fct_transactions` because it is not replaceable
[0m23:46:54.134611 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:46:54.137344 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
order by transaction_date, txn_id
    );
  
[0m23:46:54.570229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6b080582-7a4f-49a5-b6ba-8fbd0419e1bf&page=queryresults
[0m23:46:54.694110 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6b080582-7a4f-49a5-b6ba-8fbd0419e1bf&page=queryresults
[0m23:46:54.726502 [debug] [Thread-1 (]: Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Result of ORDER BY queries cannot be partitioned by field 'transaction_date'
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql
[0m23:46:54.727834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27addb77-b56e-415c-a8fb-a503ae5d71a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee8f760>]}
[0m23:46:54.729077 [error] [Thread-1 (]: 4 of 6 ERROR creating sql table model dwh_dev_mart.fct_transactions ............ [[31mERROR[0m in 1.36s]
[0m23:46:54.730236 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:46:54.731200 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.fct_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Result of ORDER BY queries cannot be partitioned by field 'transaction_date'
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql.
[0m23:46:54.733283 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:46:54.734349 [info ] [Thread-1 (]: 5 of 6 SKIP relation dwh_dev_mart.tb_agg_transactions_by_kyc ................... [[33mSKIP[0m]
[0m23:46:54.735667 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:46:54.736604 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:46:54.737398 [info ] [Thread-1 (]: 6 of 6 SKIP relation dwh_dev_mart.tb_agg_transactions_daily .................... [[33mSKIP[0m]
[0m23:46:54.738214 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:46:54.740275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:46:54.786944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:46:54.787768 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m23:46:54.788337 [info ] [MainThread]: 
[0m23:46:54.788893 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 14.91 seconds (14.91s).
[0m23:46:54.790475 [debug] [MainThread]: Command end result
[0m23:46:54.834822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:46:54.837776 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:46:54.845702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:46:54.846328 [info ] [MainThread]: 
[0m23:46:54.847104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:46:54.847808 [info ] [MainThread]: 
[0m23:46:54.848379 [error] [MainThread]: [31mFailure in model fct_transactions (models/marts/fct_transactions.sql)[0m
[0m23:46:54.849083 [error] [MainThread]:   Database Error in model fct_transactions (models/marts/fct_transactions.sql)
  Result of ORDER BY queries cannot be partitioned by field 'transaction_date'
  compiled code at target/run/de_test_dwh/models/marts/fct_transactions.sql
[0m23:46:54.849617 [info ] [MainThread]: 
[0m23:46:54.850141 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/fct_transactions.sql
[0m23:46:54.850641 [info ] [MainThread]: 
[0m23:46:54.851126 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=6
[0m23:46:54.854724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 22.95178, "process_in_blocks": "0", "process_kernel_time": 1.841743, "process_mem_max_rss": "364527616", "process_out_blocks": "0", "process_user_time": 9.134965}
[0m23:46:54.855440 [debug] [MainThread]: Command `dbt run` failed at 23:46:54.855310 after 22.95 seconds
[0m23:46:54.855952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e72dfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e320ca0>]}
[0m23:46:54.856447 [debug] [MainThread]: Flushing usage events
[0m23:46:56.206002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:47:16.970545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105448dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449270>]}


============================== 23:47:16.975093 | 267d77da-8998-4e48-afb8-8332b1b7e19f ==============================
[0m23:47:16.975093 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m23:47:16.975926 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'cache_selected_only': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None'}
[0m23:47:19.724031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ed4820>]}
[0m23:47:19.796175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c580>]}
[0m23:47:19.797175 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m23:47:20.093918 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m23:47:20.426172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:20.427149 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/fct_transactions.sql
[0m23:47:21.024667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278a57e0>]}
[0m23:47:21.162503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:47:21.165255 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:47:21.183451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebbbe0>]}
[0m23:47:21.184290 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m23:47:21.184901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103629480>]}
[0m23:47:21.187110 [info ] [MainThread]: 
[0m23:47:21.187736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:47:21.188206 [info ] [MainThread]: 
[0m23:47:21.188873 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:47:21.197178 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m23:47:21.198503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:21.847857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m23:47:21.849021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:22.395104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m23:47:22.396539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:22.988310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m23:47:22.990903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:47:23.642391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102acfbb0>]}
[0m23:47:23.643773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:23.696792 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m23:47:23.697556 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m23:47:23.698401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m23:47:23.698919 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m23:47:23.712246 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m23:47:23.713546 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m23:47:23.733110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:24.415520 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m23:47:24.416697 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m23:47:25.287904 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:be509020-238d-4b74-84c9-99e6dbe20dc0&page=queryresults
[0m23:47:27.025183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f102b0>]}
[0m23:47:27.026314 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.32s]
[0m23:47:27.027212 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m23:47:27.027779 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m23:47:27.028445 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m23:47:27.029213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m23:47:27.030093 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m23:47:27.035158 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m23:47:27.036166 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m23:47:27.040100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:27.618094 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m23:47:27.619230 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m23:47:28.269798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:574c30a8-2789-4a7f-92e7-1f1d52436930&page=queryresults
[0m23:47:29.849925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f102b0>]}
[0m23:47:29.851072 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 2.82s]
[0m23:47:29.852220 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m23:47:29.852989 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m23:47:29.853779 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m23:47:29.854709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m23:47:29.855203 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m23:47:29.861278 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m23:47:29.862567 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m23:47:29.868281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:30.404737 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m23:47:30.406495 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m23:47:30.700214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:190411da-533d-4ed9-8085-05888864dc94&page=queryresults
[0m23:47:32.354649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebabf0>]}
[0m23:47:32.356440 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.50s]
[0m23:47:32.357847 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m23:47:32.358778 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m23:47:32.359900 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m23:47:32.360827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m23:47:32.361549 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m23:47:32.368221 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m23:47:32.369528 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m23:47:32.387240 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m23:47:32.390216 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        extract(year from t.created_at) as transaction_year,
        extract(quarter from t.created_at) as transaction_quarter,
        extract(month from t.created_at) as transaction_month,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m23:47:32.391255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:33.294951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:86aef8ab-0184-4cd3-b00e-429be318a2c3&page=queryresults
[0m23:47:38.005475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ebabf0>]}
[0m23:47:38.007264 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.64s]
[0m23:47:38.008951 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m23:47:38.010712 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:47:38.012079 [info ] [Thread-1 (]: 5 of 6 START sql table model dwh_dev_mart.tb_agg_transactions_by_kyc ........... [RUN]
[0m23:47:38.013055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_agg_transactions_by_kyc)
[0m23:47:38.036808 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:47:38.042376 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m23:47:38.044405 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:47:38.055452 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m23:47:38.057760 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

-- Aggregated fact: Completed transactions by KYC level (at transaction time)
-- Answers business question: "View completed transactions by users at each KYC level"
-- Uses historical KYC level (kyc_level_at_transaction) not current level

select
    kyc_level_at_transaction,
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month,
    count(distinct txn_id) as completed_transaction_count,
    count(distinct user_id) as unique_users,
    sum(transaction_amount_usd) as total_volume_usd,
    avg(transaction_amount_usd) as avg_transaction_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
    and kyc_level_at_transaction is not null
group by
    kyc_level_at_transaction,
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month
    );
  
[0m23:47:38.058849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:38.911905 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cea3b87d-5656-4604-af98-3fd2087fafe9&page=queryresults
[0m23:47:39.038658 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cea3b87d-5656-4604-af98-3fd2087fafe9&page=queryresults
[0m23:47:39.063514 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:47:39.064971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127daf430>]}
[0m23:47:39.066337 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model dwh_dev_mart.tb_agg_transactions_by_kyc .. [[31mERROR[0m in 1.05s]
[0m23:47:39.068321 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m23:47:39.069265 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:47:39.070575 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql.
[0m23:47:39.071606 [info ] [Thread-1 (]: 6 of 6 START sql table model dwh_dev_mart.tb_agg_transactions_daily ............ [RUN]
[0m23:47:39.073610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_agg_transactions_by_kyc, now model.de_test_dwh.tb_agg_transactions_daily)
[0m23:47:39.074332 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_daily
[0m23:47:39.081945 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_daily"
[0m23:47:39.083362 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_daily
[0m23:47:39.088385 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_daily"
[0m23:47:39.089753 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_daily: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_daily"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_daily`
      
    
    

    
    OPTIONS()
    as (
      

-- Aggregated fact: Daily transaction volume in USD
-- Answers business question: "Total transaction volume (in USD) by day"

select
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month,
    count(distinct txn_id) as transaction_count,
    count(distinct user_id) as unique_users,
    sum(transaction_amount_usd) as total_volume_usd,
    avg(transaction_amount_usd) as avg_transaction_amount_usd,
    min(transaction_amount_usd) as min_transaction_amount_usd,
    max(transaction_amount_usd) as max_transaction_amount_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
    count(case when status = 'completed' then 1 end) as completed_transaction_count
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by
    transaction_date,
    transaction_year,
    transaction_quarter,
    transaction_month
    );
  
[0m23:47:39.090796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:39.935787 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9016ad81-ab61-4e40-a70a-20e3dbbad6ab&page=queryresults
[0m23:47:40.055466 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9016ad81-ab61-4e40-a70a-20e3dbbad6ab&page=queryresults
[0m23:47:40.069234 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:47:40.070637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267d77da-8998-4e48-afb8-8332b1b7e19f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a34a00>]}
[0m23:47:40.072092 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model dwh_dev_mart.tb_agg_transactions_daily ... [[31mERROR[0m in 1.00s]
[0m23:47:40.073742 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_daily
[0m23:47:40.075026 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_daily' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql.
[0m23:47:40.077242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:40.131766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:40.132407 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_agg_transactions_daily' was properly closed.
[0m23:47:40.133011 [info ] [MainThread]: 
[0m23:47:40.133565 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.94 seconds (18.94s).
[0m23:47:40.135398 [debug] [MainThread]: Command end result
[0m23:47:40.184891 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m23:47:40.187122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m23:47:40.195629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m23:47:40.196190 [info ] [MainThread]: 
[0m23:47:40.196862 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:47:40.197501 [info ] [MainThread]: 
[0m23:47:40.198375 [error] [MainThread]: [31mFailure in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)[0m
[0m23:47:40.198974 [error] [MainThread]:   Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [28:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:47:40.199436 [info ] [MainThread]: 
[0m23:47:40.199886 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m23:47:40.200289 [info ] [MainThread]: 
[0m23:47:40.200870 [error] [MainThread]: [31mFailure in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)[0m
[0m23:47:40.201405 [error] [MainThread]:   Database Error in model tb_agg_transactions_daily (models/marts/tb_agg_transactions_daily.sql)
  Unrecognized name: transaction_amount_usd; Did you mean transaction_month? at [26:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:47:40.201787 [info ] [MainThread]: 
[0m23:47:40.202255 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_daily.sql
[0m23:47:40.202778 [info ] [MainThread]: 
[0m23:47:40.203579 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m23:47:40.208161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.321047, "process_in_blocks": "0", "process_kernel_time": 1.034442, "process_mem_max_rss": "365305856", "process_out_blocks": "0", "process_user_time": 7.795012}
[0m23:47:40.209736 [debug] [MainThread]: Command `dbt run` failed at 23:47:40.209469 after 23.32 seconds
[0m23:47:40.210470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010a4c10>]}
[0m23:47:40.211311 [debug] [MainThread]: Flushing usage events
[0m23:47:41.541939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:08.748986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108905480>]}


============================== 00:15:08.756600 | 9ca7c4cd-7638-4b28-bf68-0842abb7bf2d ==============================
[0m00:15:08.756600 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:15:08.757582 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'introspect': 'True'}
[0m00:15:15.249900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dd120>]}
[0m00:15:15.326264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1274701f0>]}
[0m00:15:15.327239 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:15:15.649373 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:15:16.114072 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m00:15:16.114914 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/marts/tb_transactions_tracking.sql
[0m00:15:16.115371 [debug] [MainThread]: Partial parsing: deleted file: de_test_dwh://models/marts/tb_agg_transactions_daily.sql
[0m00:15:16.115887 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_agg_transactions_by_kyc.sql
[0m00:15:16.116433 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/fct_transactions.sql
[0m00:15:16.681170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12add1ea0>]}
[0m00:15:16.813563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:15:16.820095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:15:16.872212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a7afc10>]}
[0m00:15:16.873096 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:15:16.873688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a5f5630>]}
[0m00:15:16.876188 [info ] [MainThread]: 
[0m00:15:16.876852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:15:16.877392 [info ] [MainThread]: 
[0m00:15:16.878373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:15:16.886304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:15:16.887765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:17.795350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m00:15:17.796581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:18.440776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m00:15:18.442617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:19.054770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m00:15:19.057412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:19.660152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f67c70>]}
[0m00:15:19.661505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:19.716697 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m00:15:19.717415 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m00:15:19.718333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m00:15:19.718766 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m00:15:19.730347 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m00:15:19.733460 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m00:15:19.755064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:20.409743 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m00:15:20.410872 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m00:15:21.272002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b7ca23b5-f99f-4e3c-b038-60c7438a0f9b&page=queryresults
[0m00:15:23.477863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046448e0>]}
[0m00:15:23.478834 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.76s]
[0m00:15:23.479836 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m00:15:23.480491 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m00:15:23.481359 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m00:15:23.482236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m00:15:23.482836 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m00:15:23.488067 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m00:15:23.492218 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m00:15:23.497405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:24.089099 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m00:15:24.091731 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m00:15:24.845616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:86db6e9b-7147-4fe6-934e-1fac9f5edcb2&page=queryresults
[0m00:15:26.592205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a79f790>]}
[0m00:15:26.593329 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.11s]
[0m00:15:26.594218 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m00:15:26.594820 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m00:15:26.595617 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m00:15:26.596372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m00:15:26.596867 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m00:15:26.603052 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m00:15:26.604114 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m00:15:26.608664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:27.229187 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m00:15:27.233315 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m00:15:27.621224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:00bced6d-7eea-46b7-b428-23a554782faf&page=queryresults
[0m00:15:29.351007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046448e0>]}
[0m00:15:29.352698 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.75s]
[0m00:15:29.354204 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m00:15:29.355297 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m00:15:29.356538 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m00:15:29.357530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m00:15:29.358305 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m00:15:29.365833 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m00:15:29.368949 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m00:15:29.383200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:29.978451 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m00:15:29.982318 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m00:15:30.316886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:93188d79-1513-4352-9298-7d4d4da38141&page=queryresults
[0m00:15:34.687730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a3892d0>]}
[0m00:15:34.689365 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.33s]
[0m00:15:34.690773 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m00:15:34.694385 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:15:34.695762 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc ..... [RUN]
[0m00:15:34.696960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_agg_transactions_by_kyc)
[0m00:15:34.698240 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:15:34.707466 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:15:34.710255 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:15:34.763944 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:15:34.765110 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(transaction_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
 and kyc_level_at_transaction is not null
group by all
    );
  
[0m00:15:34.765947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:35.397493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:af863175-5648-4748-b535-1aa6d0481a32&page=queryresults
[0m00:15:35.399384 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:af863175-5648-4748-b535-1aa6d0481a32&page=queryresults
[0m00:15:35.433331 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:15:35.435080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b3d77c0>]}
[0m00:15:35.437044 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc  [[31mERROR[0m in 0.74s]
[0m00:15:35.438105 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:15:35.438805 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m00:15:35.439646 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql.
[0m00:15:35.440460 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_dev_mart.tb_transactions_tracking ....... [RUN]
[0m00:15:35.442498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_agg_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m00:15:35.443223 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m00:15:35.449699 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:15:35.452709 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m00:15:35.458080 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:15:35.459214 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(transaction_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(transaction_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(transaction_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(transaction_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then transaction_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
    );
  
[0m00:15:35.459935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:36.318565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:72adfc1a-edb8-4b7f-972a-ca8b3bbd63c7&page=queryresults
[0m00:15:36.460705 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:72adfc1a-edb8-4b7f-972a-ca8b3bbd63c7&page=queryresults
[0m00:15:36.470165 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_amount_usd at [22:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:15:36.471999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca7c4cd-7638-4b28-bf68-0842abb7bf2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b4a5a50>]}
[0m00:15:36.473984 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dwh_dev_mart.tb_transactions_tracking  [[31mERROR[0m in 1.03s]
[0m00:15:36.476075 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m00:15:36.478267 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_amount_usd at [22:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql.
[0m00:15:36.480312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:36.532170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:36.532799 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m00:15:36.533322 [info ] [MainThread]: 
[0m00:15:36.534131 [info ] [MainThread]: Finished running 2 incremental models, 4 table models in 0 hours 0 minutes and 19.66 seconds (19.66s).
[0m00:15:36.536273 [debug] [MainThread]: Command end result
[0m00:15:36.579836 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:15:36.583542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:15:36.593127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:15:36.593700 [info ] [MainThread]: 
[0m00:15:36.594321 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m00:15:36.594868 [info ] [MainThread]: 
[0m00:15:36.595483 [error] [MainThread]: [31mFailure in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)[0m
[0m00:15:36.596049 [error] [MainThread]:   Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:15:36.596561 [info ] [MainThread]: 
[0m00:15:36.597090 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:15:36.597664 [info ] [MainThread]: 
[0m00:15:36.598329 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)[0m
[0m00:15:36.598911 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_amount_usd at [22:9]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:15:36.599778 [info ] [MainThread]: 
[0m00:15:36.600538 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:15:36.601184 [info ] [MainThread]: 
[0m00:15:36.601838 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=6
[0m00:15:36.606699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 27.977186, "process_in_blocks": "0", "process_kernel_time": 1.907771, "process_mem_max_rss": "366055424", "process_out_blocks": "0", "process_user_time": 9.492149}
[0m00:15:36.607845 [debug] [MainThread]: Command `dbt run` failed at 00:15:36.607342 after 27.98 seconds
[0m00:15:36.608501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b40c760>]}
[0m00:15:36.609022 [debug] [MainThread]: Flushing usage events
[0m00:15:38.126375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:26.751518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c08dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c09270>]}


============================== 00:16:26.757663 | e551e264-3aa1-429e-b086-776318ee2a84 ==============================
[0m00:16:26.757663 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:16:26.758446 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --select marts', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m00:16:31.946833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354f3340>]}
[0m00:16:32.033633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354cf820>]}
[0m00:16:32.034555 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:16:32.367929 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:16:32.823939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:16:32.825004 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_transactions_tracking.sql
[0m00:16:32.825601 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_agg_transactions_by_kyc.sql
[0m00:16:33.148635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135db8130>]}
[0m00:16:33.274515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:16:33.278348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:16:33.314527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111de5990>]}
[0m00:16:33.315175 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:16:33.315753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c77b80>]}
[0m00:16:33.317677 [info ] [MainThread]: 
[0m00:16:33.318442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:16:33.319052 [info ] [MainThread]: 
[0m00:16:33.319842 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:16:33.326892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:16:33.328311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:34.189100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m00:16:34.190331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:34.785038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m00:16:34.787095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:35.437207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m00:16:35.440289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:16:36.065039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a3bb0>]}
[0m00:16:36.066417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:16:36.123110 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m00:16:36.123863 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m00:16:36.124573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m00:16:36.125098 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m00:16:36.137899 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m00:16:36.139722 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m00:16:36.161463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:36.806536 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m00:16:36.807659 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m00:16:37.558842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fa5ec8ca-7663-4bfd-8a4e-dc9904d9c68f&page=queryresults
[0m00:16:39.403669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1325b4310>]}
[0m00:16:39.405110 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.28s]
[0m00:16:39.406068 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m00:16:39.406672 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m00:16:39.407431 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m00:16:39.408118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m00:16:39.408613 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m00:16:39.413008 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m00:16:39.414350 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m00:16:39.418121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:39.998101 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m00:16:40.001024 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m00:16:40.728799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a5e1e0e9-9a46-4606-84c8-a71ba1da32db&page=queryresults
[0m00:16:42.368181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c1a4a0>]}
[0m00:16:42.369740 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 2.96s]
[0m00:16:42.371036 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m00:16:42.371962 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m00:16:42.373162 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m00:16:42.374251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m00:16:42.375004 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m00:16:42.383585 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m00:16:42.385336 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m00:16:42.391021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:43.013324 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m00:16:43.015795 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m00:16:43.495590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5759f989-e84a-41a7-8b64-c55f7d7051e5&page=queryresults
[0m00:16:45.137019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c1a4a0>]}
[0m00:16:45.138610 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.76s]
[0m00:16:45.140119 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m00:16:45.141335 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m00:16:45.142629 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m00:16:45.143670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m00:16:45.144422 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m00:16:45.151372 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m00:16:45.153610 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m00:16:45.169836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:45.783389 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m00:16:45.785927 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m00:16:46.154232 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:206a0a30-1e97-44af-a608-4cc9bbedd92e&page=queryresults
[0m00:16:50.346386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c1a4a0>]}
[0m00:16:50.348013 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.20s]
[0m00:16:50.349615 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m00:16:50.351402 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:16:50.352467 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc ..... [RUN]
[0m00:16:50.353402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_agg_transactions_by_kyc)
[0m00:16:50.354145 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:16:50.363620 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:16:50.364842 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:16:50.413999 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:16:50.415261 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
 and kyc_level_at_transaction is not null
group by all
    );
  
[0m00:16:50.415970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:51.003769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4ade5c58-fdc0-49af-80dd-10b2de6426ee&page=queryresults
[0m00:16:51.005643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4ade5c58-fdc0-49af-80dd-10b2de6426ee&page=queryresults
[0m00:16:51.037147 [debug] [Thread-1 (]: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:16:51.038234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dba440>]}
[0m00:16:51.039305 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc  [[31mERROR[0m in 0.68s]
[0m00:16:51.040270 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:16:51.041105 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m00:16:51.041986 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_dev_mart.tb_transactions_tracking ....... [RUN]
[0m00:16:51.042904 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_agg_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql.
[0m00:16:51.043561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_agg_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m00:16:51.045059 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m00:16:51.052573 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:16:51.053857 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m00:16:51.058943 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:16:51.060134 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
    );
  
[0m00:16:51.060795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:16:51.891189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0d5ae8a9-8ce6-44ce-be3e-5e0f4ca12a1e&page=queryresults
[0m00:16:54.161103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e551e264-3aa1-429e-b086-776318ee2a84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135dbb910>]}
[0m00:16:54.162735 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_dev_mart.tb_transactions_tracking .. [[32mCREATE TABLE (59.0 rows, 204.3 MiB processed)[0m in 3.12s]
[0m00:16:54.164195 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m00:16:54.166493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:16:54.216333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:54.216942 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m00:16:54.217479 [info ] [MainThread]: 
[0m00:16:54.218056 [info ] [MainThread]: Finished running 2 incremental models, 4 table models in 0 hours 0 minutes and 20.90 seconds (20.90s).
[0m00:16:54.219825 [debug] [MainThread]: Command end result
[0m00:16:54.263456 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:16:54.265999 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:16:54.274041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:16:54.274575 [info ] [MainThread]: 
[0m00:16:54.275259 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:16:54.276027 [info ] [MainThread]: 
[0m00:16:54.276722 [error] [MainThread]: [31mFailure in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)[0m
[0m00:16:54.277322 [error] [MainThread]:   Database Error in model tb_agg_transactions_by_kyc (models/marts/tb_agg_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got "," at [17:30]
  compiled code at target/run/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:16:54.277840 [info ] [MainThread]: 
[0m00:16:54.278473 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_agg_transactions_by_kyc.sql
[0m00:16:54.279122 [info ] [MainThread]: 
[0m00:16:54.279651 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m00:16:54.284529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 27.632736, "process_in_blocks": "0", "process_kernel_time": 1.73143, "process_mem_max_rss": "363614208", "process_out_blocks": "0", "process_user_time": 9.107596}
[0m00:16:54.285250 [debug] [MainThread]: Command `dbt run` failed at 00:16:54.285115 after 27.63 seconds
[0m00:16:54.286079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c4e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354f3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc80a0>]}
[0m00:16:54.286853 [debug] [MainThread]: Flushing usage events
[0m00:16:55.985289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:39.834893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5d270>]}


============================== 00:17:39.844081 | 9895b362-9936-4d11-b7ef-9528905b1263 ==============================
[0m00:17:39.844081 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:17:39.845631 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select marts'}
[0m00:17:46.575375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284c7340>]}
[0m00:17:46.686529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12849f820>]}
[0m00:17:46.687481 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:17:47.072214 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:17:47.577342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:47.578275 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_agg_transactions_by_kyc.sql
[0m00:17:48.013549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128d8c130>]}
[0m00:17:48.188991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:17:48.195504 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:17:48.237627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288ee950>]}
[0m00:17:48.238363 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:17:48.238845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c48cd0>]}
[0m00:17:48.241375 [info ] [MainThread]: 
[0m00:17:48.242132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:48.242719 [info ] [MainThread]: 
[0m00:17:48.243475 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:17:48.250025 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:17:48.250968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:49.144451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m00:17:49.145775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:49.791044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m00:17:49.792801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:50.427714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m00:17:50.430389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:51.051353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1288eef80>]}
[0m00:17:51.052405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:51.106440 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m00:17:51.107355 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m00:17:51.108116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m00:17:51.108950 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m00:17:51.122982 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m00:17:51.126099 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m00:17:51.149095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:51.750904 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m00:17:51.752385 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m00:17:52.550026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:60fd0692-ab0a-4495-85f5-50571eaa3a54&page=queryresults
[0m00:17:54.281716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125580850>]}
[0m00:17:54.282719 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.17s]
[0m00:17:54.283824 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m00:17:54.284395 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m00:17:54.285093 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m00:17:54.285853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m00:17:54.286365 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m00:17:54.291030 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m00:17:54.292165 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m00:17:54.295801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:55.008922 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m00:17:55.011209 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m00:17:55.687940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:de7127fe-aaf5-4cb6-91e0-61bfc25a8513&page=queryresults
[0m00:17:57.309602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128be6920>]}
[0m00:17:57.311437 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.02s]
[0m00:17:57.312919 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m00:17:57.313825 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m00:17:57.314874 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m00:17:57.315855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m00:17:57.316709 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m00:17:57.324792 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m00:17:57.326433 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m00:17:57.330056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:57.922030 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m00:17:57.925331 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m00:17:58.246405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:056febf1-4890-4d58-88b3-ca779f9ab64e&page=queryresults
[0m00:17:59.862524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128be6920>]}
[0m00:17:59.864174 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.55s]
[0m00:17:59.865647 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m00:17:59.866620 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m00:17:59.867928 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m00:17:59.869029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m00:17:59.870333 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m00:17:59.877124 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m00:17:59.880117 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m00:17:59.898342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:00.507898 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m00:18:00.510436 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m00:18:01.013150 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5b994166-ee78-46a2-a42f-d90d81d1fb30&page=queryresults
[0m00:18:05.295640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128be6920>]}
[0m00:18:05.296658 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.43s]
[0m00:18:05.297737 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m00:18:05.298762 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:18:05.299546 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc ..... [RUN]
[0m00:18:05.300395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_agg_transactions_by_kyc)
[0m00:18:05.301654 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:18:05.311882 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:18:05.313324 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:18:05.365972 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_agg_transactions_by_kyc"
[0m00:18:05.367672 [debug] [Thread-1 (]: On model.de_test_dwh.tb_agg_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_agg_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_agg_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
 and kyc_level_at_transaction is not null
group by all
    );
  
[0m00:18:05.368593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:06.135175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0a3a1b80-4827-493e-9d86-dc9a6ece77d4&page=queryresults
[0m00:18:08.388642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128da29e0>]}
[0m00:18:08.390251 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_dev_mart.tb_agg_transactions_by_kyc  [[32mCREATE TABLE (4.0 rows, 204.3 MiB processed)[0m in 3.09s]
[0m00:18:08.391980 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_agg_transactions_by_kyc
[0m00:18:08.393004 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m00:18:08.394193 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_dev_mart.tb_transactions_tracking ....... [RUN]
[0m00:18:08.395176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_agg_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m00:18:08.395955 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m00:18:08.407550 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:18:08.408929 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m00:18:08.413540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:09.052173 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:18:09.053523 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking` as DBT_INTERNAL_DEST
        using (

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.timeframe = DBT_INTERNAL_DEST.timeframe
                ) and (
                    DBT_INTERNAL_SOURCE.timeframe_type = DBT_INTERNAL_DEST.timeframe_type
                )

    
    when matched then update set
        `timeframe` = DBT_INTERNAL_SOURCE.`timeframe`,`timeframe_type` = DBT_INTERNAL_SOURCE.`timeframe_type`,`nb_transaction` = DBT_INTERNAL_SOURCE.`nb_transaction`,`nb_completed_transaction` = DBT_INTERNAL_SOURCE.`nb_completed_transaction`,`nb_users` = DBT_INTERNAL_SOURCE.`nb_users`,`total_volume_usd` = DBT_INTERNAL_SOURCE.`total_volume_usd`,`completed_volume_usd` = DBT_INTERNAL_SOURCE.`completed_volume_usd`
    

    when not matched then insert
        (`timeframe`, `timeframe_type`, `nb_transaction`, `nb_completed_transaction`, `nb_users`, `total_volume_usd`, `completed_volume_usd`)
    values
        (`timeframe`, `timeframe_type`, `nb_transaction`, `nb_completed_transaction`, `nb_users`, `total_volume_usd`, `completed_volume_usd`)


    
[0m00:18:09.241541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a0d8b670-8b40-4f44-88eb-9f69cca6ec14&page=queryresults
[0m00:18:09.242611 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a0d8b670-8b40-4f44-88eb-9f69cca6ec14&page=queryresults
[0m00:18:09.269946 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:18:09.270970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9895b362-9936-4d11-b7ef-9528905b1263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12937ca90>]}
[0m00:18:09.271921 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dwh_dev_mart.tb_transactions_tracking  [[31mERROR[0m in 0.88s]
[0m00:18:09.272882 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m00:18:09.274010 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql.
[0m00:18:09.278354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:09.336858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:09.337492 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m00:18:09.338047 [info ] [MainThread]: 
[0m00:18:09.338866 [info ] [MainThread]: Finished running 2 incremental models, 4 table models in 0 hours 0 minutes and 21.09 seconds (21.09s).
[0m00:18:09.341454 [debug] [MainThread]: Command end result
[0m00:18:09.394444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:18:09.398595 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:18:09.408600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:18:09.409160 [info ] [MainThread]: 
[0m00:18:09.409740 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:18:09.410315 [info ] [MainThread]: 
[0m00:18:09.411059 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)[0m
[0m00:18:09.412057 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/marts/tb_transactions_tracking.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:18:09.412817 [info ] [MainThread]: 
[0m00:18:09.413958 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_transactions_tracking.sql
[0m00:18:09.415519 [info ] [MainThread]: 
[0m00:18:09.416763 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m00:18:09.421974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 29.710558, "process_in_blocks": "0", "process_kernel_time": 2.061928, "process_mem_max_rss": "360300544", "process_out_blocks": "0", "process_user_time": 9.613732}
[0m00:18:09.423155 [debug] [MainThread]: Command `dbt run` failed at 00:18:09.422882 after 29.71 seconds
[0m00:18:09.423827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284c7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddc0a0>]}
[0m00:18:09.424363 [debug] [MainThread]: Flushing usage events
[0m00:18:10.886411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:00.779191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4724a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e430dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e431270>]}


============================== 00:19:00.786249 | 03a60cf3-ea47-4d33-98fe-626eeb4800ee ==============================
[0m00:19:00.786249 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:19:00.787081 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select marts', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test'}
[0m00:19:05.817067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdfc0a0>]}
[0m00:19:05.908266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdd4d00>]}
[0m00:19:05.910239 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:19:06.212086 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:19:06.552930 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m00:19:06.553739 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/marts/tb_transactions_by_kyc.sql
[0m00:19:06.554142 [debug] [MainThread]: Partial parsing: deleted file: de_test_dwh://models/marts/tb_agg_transactions_by_kyc.sql
[0m00:19:06.861756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c4130>]}
[0m00:19:06.988981 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:19:06.991356 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:19:07.009072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe87910>]}
[0m00:19:07.009843 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:19:07.010436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe9c760>]}
[0m00:19:07.012650 [info ] [MainThread]: 
[0m00:19:07.013282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:19:07.013806 [info ] [MainThread]: 
[0m00:19:07.014526 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:19:07.021935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:19:07.023391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:07.892935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_mart)
[0m00:19:07.895328 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_mart"
"
[0m00:19:07.915621 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_mart: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_mart"} */
create schema if not exists `cusma-383203`.`dwh_dev_mart`
  
[0m00:19:07.916543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:08.520351 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1f834ff5-c1b6-4d2c-b601-d7af285a6708&page=queryresults
[0m00:19:12.341433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m00:19:12.342200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:12.966435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m00:19:12.968906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:13.729879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m00:19:13.731056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:14.332692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303bb820>]}
[0m00:19:14.335189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:14.395539 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m00:19:14.396255 [info ] [Thread-1 (]: 1 of 6 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m00:19:14.397128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.dim_currencies)
[0m00:19:14.397584 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m00:19:14.409266 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m00:19:14.410565 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m00:19:14.459083 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m00:19:14.460271 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      

-- Dimension table: Unique currencies from transactions

with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m00:19:14.460888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:15.767011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1a56ea61-8f66-440b-87a4-13824b73f8d9&page=queryresults
[0m00:19:17.826393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306c1390>]}
[0m00:19:17.827427 [info ] [Thread-1 (]: 1 of 6 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.43s]
[0m00:19:17.828319 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m00:19:17.828903 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m00:19:17.829663 [info ] [Thread-1 (]: 2 of 6 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m00:19:17.830442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m00:19:17.830970 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m00:19:17.834950 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m00:19:17.836163 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m00:19:17.844152 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m00:19:17.845808 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m00:19:17.846439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:19.118849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6b41c29d-32e6-4a1a-a174-ad5651ed25ef&page=queryresults
[0m00:19:20.986548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c66cb0>]}
[0m00:19:20.988396 [info ] [Thread-1 (]: 2 of 6 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.16s]
[0m00:19:20.989826 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m00:19:20.991165 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m00:19:20.992997 [info ] [Thread-1 (]: 3 of 6 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m00:19:20.994415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m00:19:20.995878 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m00:19:21.003692 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m00:19:21.005631 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m00:19:21.011042 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m00:19:21.012221 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m00:19:21.013030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:21.914736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:37680965-c47a-4766-a490-472e68248e91&page=queryresults
[0m00:19:23.696913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c3ebc0>]}
[0m00:19:23.698549 [info ] [Thread-1 (]: 3 of 6 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.70s]
[0m00:19:23.699963 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m00:19:23.700890 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m00:19:23.702110 [info ] [Thread-1 (]: 4 of 6 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m00:19:23.703218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m00:19:23.703962 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m00:19:23.711225 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m00:19:23.712589 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m00:19:23.728901 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m00:19:23.730000 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m00:19:23.731458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:24.652491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cb54466d-7ff2-4c9a-838c-e4cbf16ffbc5&page=queryresults
[0m00:19:28.796831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fdd6740>]}
[0m00:19:28.798572 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (5.0m rows, 368.0 MiB processed)[0m in 5.09s]
[0m00:19:28.800005 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m00:19:28.801550 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:19:28.802906 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_dev_mart.tb_transactions_by_kyc ......... [RUN]
[0m00:19:28.804232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_transactions_by_kyc)
[0m00:19:28.805332 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m00:19:28.814458 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:19:28.816961 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m00:19:28.870169 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:19:28.871311 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where status = 'completed'
 and kyc_level_at_transaction is not null
group by all
    );
  
[0m00:19:28.871932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:29.897818 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:92c975cf-7b97-4407-8e91-376fbb5539c8&page=queryresults
[0m00:19:31.594278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c9a7d0>]}
[0m00:19:31.595914 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_dev_mart.tb_transactions_by_kyc .... [[32mCREATE TABLE (4.0 rows, 204.3 MiB processed)[0m in 2.79s]
[0m00:19:31.597307 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:19:31.598235 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m00:19:31.599472 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_dev_mart.tb_transactions_tracking ....... [RUN]
[0m00:19:31.600617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m00:19:31.601398 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m00:19:31.609442 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:19:31.612164 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m00:19:31.619298 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m00:19:31.620868 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
    );
  
[0m00:19:31.621546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:32.418204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1233cf28-0b1b-479f-beea-50354367fee8&page=queryresults
[0m00:19:34.792743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03a60cf3-ea47-4d33-98fe-626eeb4800ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130c9a980>]}
[0m00:19:34.794362 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_dev_mart.tb_transactions_tracking .. [[32mCREATE TABLE (59.0 rows, 204.3 MiB processed)[0m in 3.19s]
[0m00:19:34.795696 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m00:19:34.798026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:34.849036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:34.849748 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m00:19:34.850276 [info ] [MainThread]: 
[0m00:19:34.850917 [info ] [MainThread]: Finished running 2 incremental models, 4 table models in 0 hours 0 minutes and 27.84 seconds (27.84s).
[0m00:19:34.853034 [debug] [MainThread]: Command end result
[0m00:19:34.898620 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:19:34.900919 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:19:34.909834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:19:34.910416 [info ] [MainThread]: 
[0m00:19:34.911021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:34.911561 [info ] [MainThread]: 
[0m00:19:34.912112 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m00:19:34.914139 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 34.225777, "process_in_blocks": "0", "process_kernel_time": 1.657977, "process_mem_max_rss": "363585536", "process_out_blocks": "0", "process_user_time": 9.213754}
[0m00:19:34.914795 [debug] [MainThread]: Command `dbt run` succeeded at 00:19:34.914659 after 34.23 seconds
[0m00:19:34.915307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4724a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303b8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5edc90>]}
[0m00:19:34.915960 [debug] [MainThread]: Flushing usage events
[0m00:19:36.386718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:58.758983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4be4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4b8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4b9270>]}


============================== 00:20:58.766482 | d84770ac-592b-4c17-b834-8b104bf14228 ==============================
[0m00:20:58.766482 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:20:58.767364 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select tb_transactions_by_kyc', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'static_parser': 'True'}
[0m00:21:04.714454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ae60>]}
[0m00:21:04.790489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2e50f0>]}
[0m00:21:04.791341 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:21:05.127599 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:21:05.575847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:21:05.576874 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_transactions_by_kyc.sql
[0m00:21:05.900738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e6cc130>]}
[0m00:21:06.033801 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:21:06.039070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:21:06.084629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e477940>]}
[0m00:21:06.085344 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:21:06.085910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e1f1db0>]}
[0m00:21:06.087791 [info ] [MainThread]: 
[0m00:21:06.088421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:06.089007 [info ] [MainThread]: 
[0m00:21:06.089693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:21:06.090787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:21:06.091723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:06.998089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m00:21:06.999175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:07.681432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m00:21:07.684010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:08.286758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m00:21:08.289308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:21:08.982190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de0a0b0>]}
[0m00:21:08.983622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:09.042674 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:21:09.043483 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dwh_dev_mart.tb_transactions_by_kyc ......... [RUN]
[0m00:21:09.044257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.tb_transactions_by_kyc)
[0m00:21:09.044739 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m00:21:09.056597 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:21:09.058752 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m00:21:09.142481 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:21:09.143775 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
 and kyc_level_at_transaction is not null
group by all
    );
  
[0m00:21:09.144456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:09.769931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a5a592d5-8a41-4784-a471-28e11f9c457e&page=queryresults
[0m00:21:09.771760 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a5a592d5-8a41-4784-a471-28e11f9c457e&page=queryresults
[0m00:21:09.806431 [debug] [Thread-1 (]: Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got keyword AND at [24:2]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:21:09.810038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd84770ac-592b-4c17-b834-8b104bf14228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abedde0>]}
[0m00:21:09.811116 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dwh_dev_mart.tb_transactions_by_kyc  [[31mERROR[0m in 0.76s]
[0m00:21:09.811940 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:21:09.812667 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got keyword AND at [24:2]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql.
[0m00:21:09.814931 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:09.861214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:09.861815 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_by_kyc' was properly closed.
[0m00:21:09.862264 [info ] [MainThread]: 
[0m00:21:09.862840 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m00:21:09.863748 [debug] [MainThread]: Command end result
[0m00:21:09.908987 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:21:09.911528 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:21:09.921185 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:21:09.922390 [info ] [MainThread]: 
[0m00:21:09.923044 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:21:09.923555 [info ] [MainThread]: 
[0m00:21:09.924294 [error] [MainThread]: [31mFailure in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)[0m
[0m00:21:09.924883 [error] [MainThread]:   Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Syntax error: Expected ")" but got keyword AND at [24:2]
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:21:09.925335 [info ] [MainThread]: 
[0m00:21:09.925940 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:21:09.926728 [info ] [MainThread]: 
[0m00:21:09.927321 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:21:09.930977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.262558, "process_in_blocks": "0", "process_kernel_time": 1.675143, "process_mem_max_rss": "357593088", "process_out_blocks": "0", "process_user_time": 8.080598}
[0m00:21:09.931927 [debug] [MainThread]: Command `dbt run` failed at 00:21:09.931745 after 11.26 seconds
[0m00:21:09.932531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4be4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de1baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e232800>]}
[0m00:21:09.933054 [debug] [MainThread]: Flushing usage events
[0m00:21:11.257733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:22:12.281982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9c1270>]}


============================== 00:22:12.288945 | 5a03bc12-2f59-4301-8f3d-ba077715f62b ==============================
[0m00:22:12.288945 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:22:12.290018 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'empty': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tb_transactions_by_kyc'}
[0m00:22:18.602205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2a2080>]}
[0m00:22:18.688782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2dd090>]}
[0m00:22:18.689695 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:22:19.015622 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:22:19.465070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:22:19.466068 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_transactions_by_kyc.sql
[0m00:22:19.831987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fae4130>]}
[0m00:22:19.954662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:22:19.959901 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:22:20.005615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f880460>]}
[0m00:22:20.006401 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:22:20.006978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad8580>]}
[0m00:22:20.009069 [info ] [MainThread]: 
[0m00:22:20.009749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:22:20.010226 [info ] [MainThread]: 
[0m00:22:20.010886 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:22:20.012023 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:22:20.012944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:20.937312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m00:22:20.938552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:21.594791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m00:22:21.596244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:22.248053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m00:22:22.251349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:22.905057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f7e3a90>]}
[0m00:22:22.906283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:22:22.962149 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:22:22.962915 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dwh_dev_mart.tb_transactions_by_kyc ......... [RUN]
[0m00:22:22.963637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.tb_transactions_by_kyc)
[0m00:22:22.964125 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m00:22:22.975612 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:22:22.977689 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m00:22:23.063311 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:22:23.064523 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
    );
  
[0m00:22:23.065145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:23.883841 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e7a6a04d-f367-4dec-a4a2-46b15b581ff2&page=queryresults
[0m00:22:25.952907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a03bc12-2f59-4301-8f3d-ba077715f62b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2dc820>]}
[0m00:22:25.954007 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dwh_dev_mart.tb_transactions_by_kyc .... [[32mCREATE TABLE (4.0 rows, 204.3 MiB processed)[0m in 2.99s]
[0m00:22:25.955008 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:22:25.957781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:22:26.003894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:26.004493 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_by_kyc' was properly closed.
[0m00:22:26.004945 [info ] [MainThread]: 
[0m00:22:26.005469 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m00:22:26.006491 [debug] [MainThread]: Command end result
[0m00:22:26.050013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:22:26.052201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:22:26.060672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:22:26.061281 [info ] [MainThread]: 
[0m00:22:26.061970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:22:26.062446 [info ] [MainThread]: 
[0m00:22:26.063030 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:22:26.067644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.890045, "process_in_blocks": "0", "process_kernel_time": 1.822145, "process_mem_max_rss": "361017344", "process_out_blocks": "0", "process_user_time": 8.188633}
[0m00:22:26.068584 [debug] [MainThread]: Command `dbt run` succeeded at 00:22:26.068358 after 13.89 seconds
[0m00:22:26.069122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b6a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2a2080>]}
[0m00:22:26.069633 [debug] [MainThread]: Flushing usage events
[0m00:22:27.261608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:55.614440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5023e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4ecd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4ed240>]}


============================== 00:24:55.623140 | 54d52d1f-1581-4229-a9e7-4ea512921f61 ==============================
[0m00:24:55.623140 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:24:55.624251 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select tb_transactions_by_kyc', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m00:25:02.062516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe356f0>]}
[0m00:25:02.162366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4ef220>]}
[0m00:25:02.163468 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:25:02.529075 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:25:03.013465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:03.014470 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/marts/tb_transactions_by_kyc.sql
[0m00:25:03.380145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1306ec130>]}
[0m00:25:03.508616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:25:03.516155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:25:03.569599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe8a110>]}
[0m00:25:03.570681 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:25:03.571296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303e4820>]}
[0m00:25:03.574173 [info ] [MainThread]: 
[0m00:25:03.574988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:03.575463 [info ] [MainThread]: 
[0m00:25:03.576209 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:25:03.577316 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:25:03.578326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:04.479753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m00:25:04.482273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:05.124949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m00:25:05.126678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:05.742506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m00:25:05.745078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:06.343375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13052a8f0>]}
[0m00:25:06.344689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:06.398726 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:06.399466 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dwh_dev_mart.tb_transactions_by_kyc ......... [RUN]
[0m00:25:06.400253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.tb_transactions_by_kyc)
[0m00:25:06.400761 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:06.412549 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:25:06.414563 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:06.464570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:07.107222 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:25:07.109573 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc` as DBT_INTERNAL_DEST
        using (

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.kyc_level_at_transaction = DBT_INTERNAL_DEST.kyc_level_at_transaction
                )

    
    when matched then update set
        `kyc_level_at_transaction` = DBT_INTERNAL_SOURCE.`kyc_level_at_transaction`,`nb_transaction` = DBT_INTERNAL_SOURCE.`nb_transaction`,`nb_completed_transaction` = DBT_INTERNAL_SOURCE.`nb_completed_transaction`,`nb_users` = DBT_INTERNAL_SOURCE.`nb_users`,`total_volume_usd` = DBT_INTERNAL_SOURCE.`total_volume_usd`,`completed_volume_usd` = DBT_INTERNAL_SOURCE.`completed_volume_usd`
    

    when not matched then insert
        (`kyc_level_at_transaction`, `nb_transaction`, `nb_completed_transaction`, `nb_users`, `total_volume_usd`, `completed_volume_usd`)
    values
        (`kyc_level_at_transaction`, `nb_transaction`, `nb_completed_transaction`, `nb_users`, `total_volume_usd`, `completed_volume_usd`)


    
[0m00:25:07.285740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5ca8b6ca-ee75-4f4e-806b-1b72f947cead&page=queryresults
[0m00:25:07.288327 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5ca8b6ca-ee75-4f4e-806b-1b72f947cead&page=queryresults
[0m00:25:07.322190 [debug] [Thread-1 (]: Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:25:07.325942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54d52d1f-1581-4229-a9e7-4ea512921f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc76cb0>]}
[0m00:25:07.327745 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model dwh_dev_mart.tb_transactions_by_kyc  [[31mERROR[0m in 0.92s]
[0m00:25:07.329283 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:07.330373 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_by_kyc' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql.
[0m00:25:07.334555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:07.381359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:07.381970 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_by_kyc' was properly closed.
[0m00:25:07.382437 [info ] [MainThread]: 
[0m00:25:07.382950 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m00:25:07.383948 [debug] [MainThread]: Command end result
[0m00:25:07.431842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:25:07.434141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:25:07.442628 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:25:07.443238 [info ] [MainThread]: 
[0m00:25:07.443846 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:25:07.444560 [info ] [MainThread]: 
[0m00:25:07.445188 [error] [MainThread]: [31mFailure in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)[0m
[0m00:25:07.445790 [error] [MainThread]:   Database Error in model tb_transactions_by_kyc (models/marts/tb_transactions_by_kyc.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:25:07.446308 [info ] [MainThread]: 
[0m00:25:07.446886 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/marts/tb_transactions_by_kyc.sql
[0m00:25:07.447388 [info ] [MainThread]: 
[0m00:25:07.447917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:25:07.452602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.966543, "process_in_blocks": "0", "process_kernel_time": 1.895211, "process_mem_max_rss": "356614144", "process_out_blocks": "0", "process_user_time": 8.378972}
[0m00:25:07.453413 [debug] [MainThread]: Command `dbt run` failed at 00:25:07.453269 after 11.97 seconds
[0m00:25:07.454292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5023e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130703880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130518b80>]}
[0m00:25:07.454931 [debug] [MainThread]: Flushing usage events
[0m00:25:08.588041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:25:25.084949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcd9390>]}


============================== 00:25:25.093291 | f4d373df-f434-49db-9ea1-0fe8c318487c ==============================
[0m00:25:25.093291 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m00:25:25.094547 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt run --select tb_transactions_by_kyc', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m00:25:31.175188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5764d0>]}
[0m00:25:31.256930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5b81f0>]}
[0m00:25:31.257989 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m00:25:31.599178 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m00:25:32.060487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:25:32.061151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:25:32.127484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131be4130>]}
[0m00:25:32.261614 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:25:32.265291 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:25:32.301968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13155e8c0>]}
[0m00:25:32.302784 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m00:25:32.303354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13155f010>]}
[0m00:25:32.305415 [info ] [MainThread]: 
[0m00:25:32.306081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:25:32.306601 [info ] [MainThread]: 
[0m00:25:32.307283 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:25:32.308537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m00:25:32.309237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:33.129168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m00:25:33.130397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:33.723604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m00:25:33.725300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:34.319236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m00:25:34.321901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:34.950031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1314f9fc0>]}
[0m00:25:34.951393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:25:35.007462 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:35.008277 [info ] [Thread-1 (]: 1 of 1 START sql incremental model dwh_dev_mart.tb_transactions_by_kyc ......... [RUN]
[0m00:25:35.008981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.tb_transactions_by_kyc)
[0m00:25:35.009415 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:35.022351 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:25:35.024499 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:35.107707 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m00:25:35.108901 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
    );
  
[0m00:25:35.109488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:35.971747 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:94fdcbde-dde5-4aed-b616-f2ec4498cc4a&page=queryresults
[0m00:25:38.052426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d373df-f434-49db-9ea1-0fe8c318487c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13155e8f0>]}
[0m00:25:38.053776 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model dwh_dev_mart.tb_transactions_by_kyc .... [[32mCREATE TABLE (4.0 rows, 204.3 MiB processed)[0m in 3.04s]
[0m00:25:38.054732 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m00:25:38.056422 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:25:38.103175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:38.103768 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_by_kyc' was properly closed.
[0m00:25:38.104216 [info ] [MainThread]: 
[0m00:25:38.104722 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m00:25:38.105759 [debug] [MainThread]: Command end result
[0m00:25:38.148487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m00:25:38.150902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m00:25:38.159520 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m00:25:38.160426 [info ] [MainThread]: 
[0m00:25:38.161339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:38.161911 [info ] [MainThread]: 
[0m00:25:38.162464 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:25:38.169328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.199144, "process_in_blocks": "0", "process_kernel_time": 1.742937, "process_mem_max_rss": "356790272", "process_out_blocks": "0", "process_user_time": 7.685906}
[0m00:25:38.170364 [debug] [MainThread]: Command `dbt run` succeeded at 00:25:38.170041 after 13.20 seconds
[0m00:25:38.171105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e5b81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131c1ba60>]}
[0m00:25:38.171733 [debug] [MainThread]: Flushing usage events
[0m00:25:39.307908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:09.248557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082524d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10924d270>]}


============================== 15:33:09.257066 | 716ceef6-d38e-487f-8d11-6e0faf296fd7 ==============================
[0m15:33:09.257066 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:33:09.258356 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'empty': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'invocation_command': 'dbt run --select finance.staging', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True'}
[0m15:33:16.051925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '716ceef6-d38e-487f-8d11-6e0faf296fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839ae60>]}
[0m15:33:16.156724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '716ceef6-d38e-487f-8d11-6e0faf296fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aabd6c0>]}
[0m15:33:16.157948 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:33:16.532900 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:33:16.694391 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:33:16.695216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '716ceef6-d38e-487f-8d11-6e0faf296fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aeecb0>]}
[0m15:33:18.581942 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "dim_users".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("dim_users").
  
  To fix this, change the name of one of these resources:
  - model.de_test_dwh.dim_users (models/finance/marts/dim_users.sql)
  - model.de_test_dwh.dim_users (models/marts/dim_users.sql)
[0m15:33:18.588916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.452003, "process_in_blocks": "0", "process_kernel_time": 1.911686, "process_mem_max_rss": "345468928", "process_out_blocks": "0", "process_user_time": 8.14911}
[0m15:33:18.590155 [debug] [MainThread]: Command `dbt run` failed at 15:33:18.589805 after 9.45 seconds
[0m15:33:18.590887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082524d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073966e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b26c0a0>]}
[0m15:33:18.591430 [debug] [MainThread]: Flushing usage events
[0m15:33:20.053562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:18.976054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b524d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4d270>]}


============================== 15:36:18.984765 | e4867a75-acc8-4fd6-9726-148ebc698d5e ==============================
[0m15:36:18.984765 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:36:18.986067 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select finance.staging', 'debug': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs'}
[0m15:36:25.124885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4867a75-acc8-4fd6-9726-148ebc698d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014ee90>]}
[0m15:36:25.215336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4867a75-acc8-4fd6-9726-148ebc698d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1315f4490>]}
[0m15:36:25.216773 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:36:25.566783 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:36:25.718962 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:36:25.720154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4867a75-acc8-4fd6-9726-148ebc698d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123eecb0>]}
[0m15:36:27.654851 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on 'stg_users' in
package 'de_test_dwh' (models/finance/staging/schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m15:36:27.657261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e4867a75-acc8-4fd6-9726-148ebc698d5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1349cc5e0>]}
[0m15:36:27.847563 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_users. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_users in one of these files:
   - models/finance/staging/stg_test.yml
  models/finance/staging/schema.yml
[0m15:36:27.848641 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:36:27.855027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.978633, "process_in_blocks": "0", "process_kernel_time": 1.752639, "process_mem_max_rss": "350416896", "process_out_blocks": "0", "process_user_time": 8.500905}
[0m15:36:27.856029 [debug] [MainThread]: Command `dbt run` failed at 15:36:27.855783 after 8.98 seconds
[0m15:36:27.856781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b524d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134e02350>]}
[0m15:36:27.857328 [debug] [MainThread]: Flushing usage events
[0m15:36:29.295317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:30.982466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e126410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f118d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f119240>]}


============================== 15:37:30.989915 | 1baae4ff-f15e-4976-9857-bcbe6c09bd74 ==============================
[0m15:37:30.989915 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:37:30.990749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt run --select finance.staging', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test'}
[0m15:37:34.390757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0edba0>]}
[0m15:37:34.477018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3d840>]}
[0m15:37:34.477993 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:37:34.790520 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:37:34.933286 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:37:34.934076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130e76560>]}
[0m15:37:36.822654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13158c040>]}
[0m15:37:36.947296 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:37:36.951581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:37:36.998042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13158c490>]}
[0m15:37:36.998863 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:37:36.999431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13158e890>]}
[0m15:37:37.001743 [info ] [MainThread]: 
[0m15:37:37.002422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:37.003008 [info ] [MainThread]: 
[0m15:37:37.003962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:37:37.011849 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m15:37:37.012883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:37.907061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m15:37:37.907979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:38.621604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m15:37:38.624119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:39.255001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m15:37:39.257559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:39.892656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a51f90>]}
[0m15:37:39.894094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:39.951794 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m15:37:39.952533 [info ] [Thread-1 (]: 1 of 3 START sql view model dwh_dev_staging.stg_rates .......................... [RUN]
[0m15:37:39.953298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.stg_rates)
[0m15:37:39.953699 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m15:37:39.964629 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m15:37:39.966240 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m15:37:40.008142 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m15:37:40.009783 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m15:37:40.010654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:41.760902 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dd64f7dd-f5d3-4151-93a0-d79fd95eb61e&page=queryresults
[0m15:37:42.222023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db102b0>]}
[0m15:37:42.223121 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dwh_dev_staging.stg_rates ..................... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m15:37:42.224071 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m15:37:42.224708 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m15:37:42.225588 [info ] [Thread-1 (]: 2 of 3 START sql view model dwh_dev_staging.stg_transactions ................... [RUN]
[0m15:37:42.226379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m15:37:42.226911 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m15:37:42.231935 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m15:37:42.233143 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m15:37:42.239314 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m15:37:42.240541 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m15:37:42.241281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:43.263288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e15cd30f-1401-417d-bd82-6b9289d2df25&page=queryresults
[0m15:37:43.577765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a8ffd0>]}
[0m15:37:43.578768 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dwh_dev_staging.stg_transactions .............. [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m15:37:43.580081 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m15:37:43.580824 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m15:37:43.581662 [info ] [Thread-1 (]: 3 of 3 START sql view model dwh_dev_staging.stg_users .......................... [RUN]
[0m15:37:43.582601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m15:37:43.583379 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m15:37:43.590084 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m15:37:43.591307 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m15:37:43.600589 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m15:37:43.603323 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m15:37:43.604143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:44.621957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7700d504-22c0-4052-8f66-23309307d6ce&page=queryresults
[0m15:37:44.945947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1baae4ff-f15e-4976-9857-bcbe6c09bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db102b0>]}
[0m15:37:44.947575 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dwh_dev_staging.stg_users ..................... [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m15:37:44.949063 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m15:37:44.951344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:45.001541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:45.002169 [debug] [MainThread]: Connection 'model.de_test_dwh.stg_users' was properly closed.
[0m15:37:45.002694 [info ] [MainThread]: 
[0m15:37:45.003252 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m15:37:45.004614 [debug] [MainThread]: Command end result
[0m15:37:45.048657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:37:45.051277 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:37:45.059280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:37:45.059849 [info ] [MainThread]: 
[0m15:37:45.060621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:45.061196 [info ] [MainThread]: 
[0m15:37:45.061861 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:37:45.063904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.175394, "process_in_blocks": "0", "process_kernel_time": 1.299459, "process_mem_max_rss": "367538176", "process_out_blocks": "0", "process_user_time": 8.900439}
[0m15:37:45.064596 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:45.064439 after 14.18 seconds
[0m15:37:45.065126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e126410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131595900>]}
[0m15:37:45.065678 [debug] [MainThread]: Flushing usage events
[0m15:37:46.464739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:28.041274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107042530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffd2a0>]}


============================== 15:38:28.045908 | b1f6725f-0902-4294-a2a2-e4079baf94e3 ==============================
[0m15:38:28.045908 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:38:28.046728 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run --select finance.staging', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m15:38:30.742253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126988820>]}
[0m15:38:30.812951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fff340>]}
[0m15:38:30.813774 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:38:31.111548 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:38:31.282377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:31.282925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:31.498273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fe6080>]}
[0m15:38:31.625133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:38:31.627786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:38:31.646266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129972b60>]}
[0m15:38:31.647080 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:38:31.647624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129fabac0>]}
[0m15:38:31.650005 [info ] [MainThread]: 
[0m15:38:31.650802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:31.651391 [info ] [MainThread]: 
[0m15:38:31.652132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:31.660252 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m15:38:31.661790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:32.558753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m15:38:32.560003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:33.170996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m15:38:33.173526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:33.842418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m15:38:33.845665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:34.492040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129b48970>]}
[0m15:38:34.493281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:34.546312 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m15:38:34.547114 [info ] [Thread-1 (]: 1 of 3 START sql view model dwh_dev_staging.stg_rates .......................... [RUN]
[0m15:38:34.548082 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.stg_rates'
[0m15:38:34.548629 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m15:38:34.562138 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m15:38:34.563234 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m15:38:34.607518 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m15:38:34.630928 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m15:38:34.632040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:35.720942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:917b6e82-b3ea-489f-a337-940b73aa2181&page=queryresults
[0m15:38:36.103984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129970550>]}
[0m15:38:36.105166 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dwh_dev_staging.stg_rates ..................... [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m15:38:36.106206 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m15:38:36.106820 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m15:38:36.107589 [info ] [Thread-1 (]: 2 of 3 START sql view model dwh_dev_staging.stg_transactions ................... [RUN]
[0m15:38:36.108430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m15:38:36.109031 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m15:38:36.115465 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m15:38:36.116914 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m15:38:36.129385 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m15:38:36.131831 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m15:38:36.132988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:37.079400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a62cc7c5-7835-4eaf-9cdf-dda209148db8&page=queryresults
[0m15:38:37.374341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676cd30>]}
[0m15:38:37.376001 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dwh_dev_staging.stg_transactions .............. [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m15:38:37.377566 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m15:38:37.378552 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m15:38:37.379560 [info ] [Thread-1 (]: 3 of 3 START sql view model dwh_dev_staging.stg_users .......................... [RUN]
[0m15:38:37.380569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m15:38:37.381371 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m15:38:37.387790 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m15:38:37.389057 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m15:38:37.396701 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m15:38:37.398171 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m15:38:37.399022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:38.435670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4de81668-4c97-4153-b962-466d7f48f765&page=queryresults
[0m15:38:38.776284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1f6725f-0902-4294-a2a2-e4079baf94e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a011c00>]}
[0m15:38:38.777859 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dwh_dev_staging.stg_users ..................... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m15:38:38.779188 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m15:38:38.781514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:38.831473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:38.832339 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_staging' was properly closed.
[0m15:38:38.832725 [debug] [MainThread]: Connection 'model.de_test_dwh.stg_users' was properly closed.
[0m15:38:38.833263 [info ] [MainThread]: 
[0m15:38:38.833764 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m15:38:38.835028 [debug] [MainThread]: Command end result
[0m15:38:38.877218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:38:38.879418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:38:38.887207 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:38:38.887959 [info ] [MainThread]: 
[0m15:38:38.888566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:38.889101 [info ] [MainThread]: 
[0m15:38:38.889664 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:38:38.891673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.930541, "process_in_blocks": "0", "process_kernel_time": 0.938035, "process_mem_max_rss": "356425728", "process_out_blocks": "0", "process_user_time": 6.567414}
[0m15:38:38.892757 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:38.892528 after 10.93 seconds
[0m15:38:38.893334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107042530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e2ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bbe80>]}
[0m15:38:38.893847 [debug] [MainThread]: Flushing usage events
[0m15:38:40.226820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:42.982587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ccdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123cd270>]}


============================== 15:39:42.987386 | f5acada2-467e-4e54-97ab-b0d0feb51a06 ==============================
[0m15:39:42.987386 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:39:42.988249 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select finance.intermediate', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m15:39:45.737159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111516e30>]}
[0m15:39:45.812966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f50f0>]}
[0m15:39:45.813873 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:39:46.129269 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:39:46.293520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:46.294071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:46.508962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13441a020>]}
[0m15:39:46.631310 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:39:46.633609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:39:46.650182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133da7100>]}
[0m15:39:46.650890 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:39:46.651473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1343d3a90>]}
[0m15:39:46.653488 [info ] [MainThread]: 
[0m15:39:46.654119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:46.654643 [info ] [MainThread]: 
[0m15:39:46.655314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:46.661844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m15:39:46.663067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:47.477199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m15:39:47.478547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:48.148022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m15:39:48.149938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:48.725668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m15:39:48.728149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:49.369269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c61a0>]}
[0m15:39:49.370514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:49.422463 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m15:39:49.423210 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m15:39:49.424149 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.int_rates_usdt'
[0m15:39:49.424655 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m15:39:49.441732 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m15:39:49.443053 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m15:39:49.473207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:50.145855 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m15:39:50.147061 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m15:39:51.192619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fa597bc3-1bcc-4732-ae27-8e85a1b8b46a&page=queryresults
[0m15:39:55.396430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130df8850>]}
[0m15:39:55.397873 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.97s]
[0m15:39:55.398952 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m15:39:55.399610 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m15:39:55.400548 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh_dev_intermediate.int_users_scd2 ............... [RUN]
[0m15:39:55.401326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.int_users_scd2)
[0m15:39:55.402078 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m15:39:55.425308 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m15:39:55.427121 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m15:39:55.432470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:56.064076 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m15:39:56.066758 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m15:39:57.338296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bd6acb71-be10-48ec-8a9f-f0c929ba6589&page=queryresults
[0m15:39:58.970051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134546440>]}
[0m15:39:58.971689 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh_dev_intermediate.int_users_scd2 .......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.57s]
[0m15:39:58.973130 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m15:39:58.974101 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m15:39:58.975322 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m15:39:58.976405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m15:39:58.977139 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m15:39:58.985830 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m15:39:58.987201 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m15:39:58.993388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:59.607963 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m15:39:59.610683 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
    );
  
[0m15:40:00.612376 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b72afa35-7799-45f0-9de3-50154007065e&page=queryresults
[0m15:40:00.764655 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b72afa35-7799-45f0-9de3-50154007065e&page=queryresults
[0m15:40:00.796121 [debug] [Thread-1 (]: Database Error in model int_transactions_with_rates (models/finance/intermediate/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/finance/intermediate/int_transactions_with_rates.sql
[0m15:40:00.797373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5acada2-467e-4e54-97ab-b0d0feb51a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134946b90>]}
[0m15:40:00.798474 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model dwh_dev_intermediate.int_transactions_with_rates  [[31mERROR[0m in 1.82s]
[0m15:40:00.799565 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m15:40:00.800419 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.int_transactions_with_rates' to be skipped because of status 'error'.  Reason: Database Error in model int_transactions_with_rates (models/finance/intermediate/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/finance/intermediate/int_transactions_with_rates.sql.
[0m15:40:00.802693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:00.849095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:00.849715 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_mart' was properly closed.
[0m15:40:00.850141 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m15:40:00.850640 [info ] [MainThread]: 
[0m15:40:00.851236 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.20 seconds (14.20s).
[0m15:40:00.852651 [debug] [MainThread]: Command end result
[0m15:40:00.896124 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:40:00.898481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:40:00.906642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:40:00.907268 [info ] [MainThread]: 
[0m15:40:00.907904 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:40:00.908523 [info ] [MainThread]: 
[0m15:40:00.909433 [error] [MainThread]: [31mFailure in model int_transactions_with_rates (models/finance/intermediate/int_transactions_with_rates.sql)[0m
[0m15:40:00.910111 [error] [MainThread]:   Database Error in model int_transactions_with_rates (models/finance/intermediate/int_transactions_with_rates.sql)
  SELECT * must have a FROM clause at [55:5]
  compiled code at target/run/de_test_dwh/models/finance/intermediate/int_transactions_with_rates.sql
[0m15:40:00.910634 [info ] [MainThread]: 
[0m15:40:00.911205 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/intermediate/int_transactions_with_rates.sql
[0m15:40:00.911702 [info ] [MainThread]: 
[0m15:40:00.912248 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m15:40:00.914458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 18.015966, "process_in_blocks": "0", "process_kernel_time": 0.975497, "process_mem_max_rss": "356544512", "process_out_blocks": "0", "process_user_time": 6.778183}
[0m15:40:00.915409 [debug] [MainThread]: Command `dbt run` failed at 15:40:00.915200 after 18.02 seconds
[0m15:40:00.916191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ce4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111516e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133dc6260>]}
[0m15:40:00.916933 [debug] [MainThread]: Flushing usage events
[0m15:40:02.262802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:44.865751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c5270>]}


============================== 15:40:44.870546 | 4d3a97f4-5ae1-4b4c-8753-5e13f8415a34 ==============================
[0m15:40:44.870546 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:40:44.871389 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select finance.intermediate', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False'}
[0m15:40:48.212471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d42e00>]}
[0m15:40:48.311495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a2081f0>]}
[0m15:40:48.312682 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:40:48.711251 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:40:48.970512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:40:48.971930 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/intermediate/int_transactions_with_rates.sql
[0m15:40:49.731214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d966470>]}
[0m15:40:49.921523 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:40:49.924001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:40:49.941842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6a91b0>]}
[0m15:40:49.942564 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:40:49.943053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d6aa830>]}
[0m15:40:49.945201 [info ] [MainThread]: 
[0m15:40:49.945862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:49.946336 [info ] [MainThread]: 
[0m15:40:49.947013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:49.953905 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m15:40:49.956566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:50.678734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m15:40:50.679577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:51.282095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m15:40:51.283975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:51.947676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m15:40:51.950119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:52.529517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d14dfc0>]}
[0m15:40:52.530572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:52.580600 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m15:40:52.581355 [info ] [Thread-1 (]: 1 of 3 START sql table model dwh_dev_intermediate.int_rates_usdt ............... [RUN]
[0m15:40:52.582186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.int_rates_usdt)
[0m15:40:52.582769 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m15:40:52.597862 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m15:40:52.599260 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m15:40:52.632564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:53.307350 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m15:40:53.308497 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m15:40:54.144775 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4a667dc8-2bf6-4d22-8f6c-5adb4559cdb7&page=queryresults
[0m15:40:58.256893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a2082e0>]}
[0m15:40:58.257846 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dwh_dev_intermediate.int_rates_usdt .......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.67s]
[0m15:40:58.258822 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m15:40:58.259391 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m15:40:58.260285 [info ] [Thread-1 (]: 2 of 3 START sql table model dwh_dev_intermediate.int_users_scd2 ............... [RUN]
[0m15:40:58.261063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.int_users_scd2)
[0m15:40:58.261528 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m15:40:58.282639 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m15:40:58.284998 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m15:40:58.289499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:58.939618 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m15:40:58.942123 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m15:40:59.597273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b72ed53b-e029-4273-9689-9d598516670e&page=queryresults
[0m15:41:01.331094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db26b00>]}
[0m15:41:01.332388 [info ] [Thread-1 (]: 2 of 3 OK created sql table model dwh_dev_intermediate.int_users_scd2 .......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.07s]
[0m15:41:01.333422 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m15:41:01.334116 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m15:41:01.334849 [info ] [Thread-1 (]: 3 of 3 START sql table model dwh_dev_intermediate.int_transactions_with_rates .. [RUN]
[0m15:41:01.335609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m15:41:01.336107 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m15:41:01.341201 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m15:41:01.342565 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m15:41:01.348923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:02.158717 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m15:41:02.161407 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_rates as (
    select
        currency,
        usdt_price,
        price_timestamp,
        row_number() over (
            partition by currency, timestamp_trunc(price_timestamp, hour)
            order by price_timestamp desc
        ) as rn
    from rates
),

transactions_with_rates as (
    select
        t.*,
        lr_source.usdt_price as source_usdt_price,
        lr_source.price_timestamp as source_rate_timestamp,
        lr_dest.usdt_price as destination_usdt_price,
        lr_dest.price_timestamp as destination_rate_timestamp
    from transactions t
    left join latest_rates lr_source
        on lr_source.currency = t.source_currency
       and lr_source.price_timestamp <= t.created_at
       and lr_source.rn = 1
    left join latest_rates lr_dest
        on lr_dest.currency = t.destination_currency
       and lr_dest.price_timestamp <= t.created_at
       and lr_dest.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m15:41:03.182706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b757f303-eb90-4ee0-8bfd-39e69ccf830e&page=queryresults
[0m15:41:13.294803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3a97f4-5ae1-4b4c-8753-5e13f8415a34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a2082e0>]}
[0m15:41:13.296372 [info ] [Thread-1 (]: 3 of 3 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (4.7m rows, 676.7 KiB processed)[0m in 11.96s]
[0m15:41:13.297713 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m15:41:13.299958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:13.352480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:13.353395 [debug] [MainThread]: Connection 'model.de_test_dwh.int_transactions_with_rates' was properly closed.
[0m15:41:13.354046 [info ] [MainThread]: 
[0m15:41:13.355029 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 23.41 seconds (23.41s).
[0m15:41:13.356700 [debug] [MainThread]: Command end result
[0m15:41:13.404141 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:41:13.406981 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:41:13.417485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:41:13.418033 [info ] [MainThread]: 
[0m15:41:13.418600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:13.419123 [info ] [MainThread]: 
[0m15:41:13.419647 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:41:13.421753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.638552, "process_in_blocks": "0", "process_kernel_time": 1.138588, "process_mem_max_rss": "360472576", "process_out_blocks": "0", "process_user_time": 7.605315}
[0m15:41:13.422493 [debug] [MainThread]: Command `dbt run` succeeded at 15:41:13.422371 after 28.64 seconds
[0m15:41:13.423014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d1ee4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a941c90>]}
[0m15:41:13.423487 [debug] [MainThread]: Flushing usage events
[0m15:41:14.520476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:03.117541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109530dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109531270>]}


============================== 15:42:03.124844 | ee8c1367-86b0-4313-ac89-a9644ef14f9b ==============================
[0m15:42:03.124844 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:42:03.126428 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select finance.marts', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m15:42:07.336400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d1810>]}
[0m15:42:07.432656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e104c0>]}
[0m15:42:07.434029 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:42:07.791373 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:42:08.218001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:08.219402 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/schema.yml
[0m15:42:08.662516 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_daily' in the 'models' section of file 'models/finance/marts/schema.yml'
[0m15:42:08.664906 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'agg_transactions_by_kyc' in the 'models' section of file 'models/finance/marts/schema.yml'
[0m15:42:08.959532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b954430>]}
[0m15:42:09.134570 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:42:09.138845 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:42:09.162267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b8dd150>]}
[0m15:42:09.163385 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:42:09.164056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b2d5d20>]}
[0m15:42:09.166259 [info ] [MainThread]: 
[0m15:42:09.167069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:09.167604 [info ] [MainThread]: 
[0m15:42:09.169064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:09.177450 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m15:42:09.178724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:09.951986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m15:42:09.953064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:10.597129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m15:42:10.599235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:11.300676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m15:42:11.302660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:11.889651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8fac0>]}
[0m15:42:11.890370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:11.936882 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m15:42:11.937637 [info ] [Thread-1 (]: 1 of 4 START sql table model dwh_dev_mart.dim_currencies ....................... [RUN]
[0m15:42:11.938655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.dim_currencies)
[0m15:42:11.939149 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m15:42:11.952385 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m15:42:11.954317 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m15:42:11.973890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:12.607568 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m15:42:12.608858 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m15:42:13.518559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9bd53565-848f-456d-b8b0-48ad3a31b486&page=queryresults
[0m15:42:15.574545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fa4310>]}
[0m15:42:15.575975 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dwh_dev_mart.dim_currencies .................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.63s]
[0m15:42:15.577233 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m15:42:15.577981 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m15:42:15.578823 [info ] [Thread-1 (]: 2 of 4 START sql table model dwh_dev_mart.dim_date ............................. [RUN]
[0m15:42:15.582262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m15:42:15.583368 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m15:42:15.723086 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m15:42:15.725702 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m15:42:15.732231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:16.376786 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m15:42:16.379452 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m15:42:17.215805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9301b621-1cc1-4fce-8214-5bffb226639b&page=queryresults
[0m15:42:19.183143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c436a0>]}
[0m15:42:19.184944 [info ] [Thread-1 (]: 2 of 4 OK created sql table model dwh_dev_mart.dim_date ........................ [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.60s]
[0m15:42:19.186669 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m15:42:19.188123 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m15:42:19.189224 [info ] [Thread-1 (]: 3 of 4 START sql table model dwh_dev_mart.dim_users ............................ [RUN]
[0m15:42:19.190180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.dim_users)
[0m15:42:19.190933 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m15:42:19.197055 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m15:42:19.198323 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m15:42:19.203871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:19.783978 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m15:42:19.786653 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m15:42:20.186913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6a3fa4ff-3c90-49c8-a9ac-3f7c1a03e6d5&page=queryresults
[0m15:42:21.786617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c436a0>]}
[0m15:42:21.788395 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dwh_dev_mart.dim_users ....................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.60s]
[0m15:42:21.789663 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m15:42:21.790531 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m15:42:21.791642 [info ] [Thread-1 (]: 4 of 4 START sql table model dwh_dev_mart.fct_transactions ..................... [RUN]
[0m15:42:21.792551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m15:42:21.793095 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m15:42:21.798857 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m15:42:21.800462 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m15:42:21.820203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:22.373841 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m15:42:22.375121 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m15:42:23.006897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4f7b1311-74a6-4049-9572-150bc0dbb359&page=queryresults
[0m15:42:26.922207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8c1367-86b0-4313-ac89-a9644ef14f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c436a0>]}
[0m15:42:26.923186 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dwh_dev_mart.fct_transactions ................ [[32mCREATE TABLE (4.7m rows, 344.6 MiB processed)[0m in 5.13s]
[0m15:42:26.924367 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m15:42:26.926759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:26.977816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:26.978705 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m15:42:26.979906 [info ] [MainThread]: 
[0m15:42:26.981352 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 17.81 seconds (17.81s).
[0m15:42:26.985009 [debug] [MainThread]: Command end result
[0m15:42:27.035610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:42:27.038272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:42:27.046579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:42:27.047474 [info ] [MainThread]: 
[0m15:42:27.048461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:27.049714 [info ] [MainThread]: 
[0m15:42:27.050628 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:42:27.052864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.06263, "process_in_blocks": "0", "process_kernel_time": 1.358924, "process_mem_max_rss": "364367872", "process_out_blocks": "0", "process_user_time": 8.671406}
[0m15:42:27.053897 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:27.053652 after 24.06 seconds
[0m15:42:27.054667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b671f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d1810>]}
[0m15:42:27.055256 [debug] [MainThread]: Flushing usage events
[0m15:42:28.275388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:46.588322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a564d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4d270>]}


============================== 15:42:46.592433 | e7a792c1-d203-4d0f-a421-f02022957094 ==============================
[0m15:42:46.592433 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:42:46.593290 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select finance.marts', 'target_path': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'version_check': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m15:42:50.392417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9ee60>]}
[0m15:42:50.479911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106183be0>]}
[0m15:42:50.480867 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:42:50.826118 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:42:51.275017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:51.275848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:51.375162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab04370>]}
[0m15:42:51.541496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:42:51.545480 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:42:51.591440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12aa6d7b0>]}
[0m15:42:51.592371 [info ] [MainThread]: Found 10 models, 19 data tests, 3 sources, 624 macros
[0m15:42:51.592968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ab061d0>]}
[0m15:42:51.595588 [info ] [MainThread]: 
[0m15:42:51.596206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:51.596700 [info ] [MainThread]: 
[0m15:42:51.597415 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:51.605098 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_intermediate'
[0m15:42:51.605909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:52.189051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m15:42:52.191912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:52.777230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m15:42:52.777911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:53.427714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a792c1-d203-4d0f-a421-f02022957094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107168820>]}
[0m15:42:53.429334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:53.498164 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:42:53.499144 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_currencies_currency ............................ [RUN]
[0m15:42:53.500186 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648'
[0m15:42:53.500728 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:42:53.534387 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:42:53.535894 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:42:53.566544 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:42:53.567843 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
where currency is null



  
  
      
    ) dbt_internal_test
[0m15:42:53.568530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:54.694903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0e23092a-3189-4a72-b5b4-16999db4c95b&page=queryresults
[0m15:42:55.359869 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_currencies_currency .................................. [[32mPASS[0m in 1.86s]
[0m15:42:55.361251 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:42:55.362080 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:42:55.362964 [info ] [Thread-1 (]: 2 of 13 START test not_null_dim_date_date ...................................... [RUN]
[0m15:42:55.363893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m15:42:55.364598 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:42:55.372312 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:42:55.373777 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:42:55.380190 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:42:55.381405 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `cusma-383203`.`dwh_dev_mart`.`dim_date`
where date is null



  
  
      
    ) dbt_internal_test
[0m15:42:55.382379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:56.278952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:444f7ff3-174c-4f85-bba1-669001b57ba2&page=queryresults
[0m15:42:56.742579 [info ] [Thread-1 (]: 2 of 13 PASS not_null_dim_date_date ............................................ [[32mPASS[0m in 1.38s]
[0m15:42:56.744458 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:42:56.745442 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:42:56.746455 [info ] [Thread-1 (]: 3 of 13 START test not_null_dim_users_effective_from ........................... [RUN]
[0m15:42:56.747577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m15:42:56.748456 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:42:56.757617 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:42:56.759600 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:42:56.767647 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:42:56.768831 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_from
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_from is null



  
  
      
    ) dbt_internal_test
[0m15:42:56.769661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:57.667467 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f100cbe8-ee0f-46c9-9df1-17a0d9fa08c3&page=queryresults
[0m15:42:58.390236 [info ] [Thread-1 (]: 3 of 13 PASS not_null_dim_users_effective_from ................................. [[32mPASS[0m in 1.64s]
[0m15:42:58.392123 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:42:58.393088 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:42:58.394142 [info ] [Thread-1 (]: 4 of 13 START test not_null_dim_users_effective_to ............................. [RUN]
[0m15:42:58.395223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m15:42:58.396093 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:42:58.404942 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:42:58.406221 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:42:58.412546 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:42:58.413731 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_to
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_to is null



  
  
      
    ) dbt_internal_test
[0m15:42:58.414442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:59.507513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d2561a4f-1035-4b24-9324-c99035f1176c&page=queryresults
[0m15:42:59.972827 [info ] [Thread-1 (]: 4 of 13 PASS not_null_dim_users_effective_to ................................... [[32mPASS[0m in 1.58s]
[0m15:42:59.974726 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:42:59.975719 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:42:59.976830 [info ] [Thread-1 (]: 5 of 13 START test not_null_dim_users_kyc_level ................................ [RUN]
[0m15:42:59.978050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m15:42:59.978930 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:42:59.988322 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:42:59.990310 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:42:59.995020 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:42:59.996223 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_kyc_level.552489338e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m15:42:59.996936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:00.840585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8514051e-0397-481e-bdc5-eb70320f3094&page=queryresults
[0m15:43:01.292537 [info ] [Thread-1 (]: 5 of 13 PASS not_null_dim_users_kyc_level ...................................... [[32mPASS[0m in 1.31s]
[0m15:43:01.294047 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:43:01.294975 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:43:01.295919 [info ] [Thread-1 (]: 6 of 13 START test not_null_dim_users_user_id .................................. [RUN]
[0m15:43:01.297170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m15:43:01.298097 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:43:01.306893 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:43:01.308204 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:43:01.312549 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:43:01.313714 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:43:01.314392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:02.172859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5b6f00bf-f26a-452f-808a-4910c572d039&page=queryresults
[0m15:43:02.608538 [info ] [Thread-1 (]: 6 of 13 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 1.31s]
[0m15:43:02.610100 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:43:02.611043 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:43:02.612081 [info ] [Thread-1 (]: 7 of 13 START test not_null_dim_users_user_kyc_key ............................. [RUN]
[0m15:43:02.613252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m15:43:02.614158 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:43:02.623020 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:43:02.624638 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:43:02.629085 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:43:02.630203 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_kyc_key
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_kyc_key is null



  
  
      
    ) dbt_internal_test
[0m15:43:02.630932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:03.409936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6be2bfbe-ea6b-4f14-9d7c-8e069cca6360&page=queryresults
[0m15:43:03.872596 [info ] [Thread-1 (]: 7 of 13 PASS not_null_dim_users_user_kyc_key ................................... [[32mPASS[0m in 1.26s]
[0m15:43:03.874847 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:43:03.875858 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5
[0m15:43:03.876913 [info ] [Thread-1 (]: 8 of 13 START test not_null_fct_transactions_transaction_amount_usd ............ [RUN]
[0m15:43:03.878025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5)
[0m15:43:03.878930 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5
[0m15:43:03.891361 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5"
[0m15:43:03.892675 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5
[0m15:43:03.897013 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5"
[0m15:43:03.898374 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where transaction_amount_usd is null



  
  
      
    ) dbt_internal_test
[0m15:43:03.899268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:04.768300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8d9b88ae-813b-4c71-811d-6d2b7a66998c&page=queryresults
[0m15:43:04.770223 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8d9b88ae-813b-4c71-811d-6d2b7a66998c&page=queryresults
[0m15:43:04.793799 [debug] [Thread-1 (]: Database Error in test not_null_fct_transactions_transaction_amount_usd (models/finance/marts/schema.yml)
  Unrecognized name: transaction_amount_usd at [18:7]
  compiled code at target/run/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_transaction_amount_usd.sql
[0m15:43:04.794882 [error] [Thread-1 (]: 8 of 13 ERROR not_null_fct_transactions_transaction_amount_usd ................. [[31mERROR[0m in 0.92s]
[0m15:43:04.795922 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5
[0m15:43:04.796596 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:43:04.797513 [debug] [Thread-4 (]: Marking all children of 'test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fct_transactions_transaction_amount_usd (models/finance/marts/schema.yml)
  Unrecognized name: transaction_amount_usd at [18:7]
  compiled code at target/run/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_transaction_amount_usd.sql.
[0m15:43:04.798214 [info ] [Thread-1 (]: 9 of 13 START test not_null_fct_transactions_txn_id ............................ [RUN]
[0m15:43:04.800649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_transaction_amount_usd.71768abad5, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m15:43:04.801484 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:43:04.809225 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:43:04.810221 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:43:04.813838 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:43:04.815216 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m15:43:04.815902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:05.961894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2db47f6c-b9c0-43c6-a33d-a704c4d2d238&page=queryresults
[0m15:43:06.496232 [info ] [Thread-1 (]: 9 of 13 PASS not_null_fct_transactions_txn_id .................................. [[32mPASS[0m in 1.70s]
[0m15:43:06.498186 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:43:06.499164 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:43:06.500208 [info ] [Thread-1 (]: 10 of 13 START test unique_dim_currencies_currency ............................. [RUN]
[0m15:43:06.501339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m15:43:06.502256 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:43:06.515540 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:43:06.516841 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:43:06.523955 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:43:06.525397 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_currencies_currency.20f50226d8: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select currency as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
  where currency is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:43:06.526193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:07.805457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5501196c-9f1d-4bb0-9e3b-88ef229fe1e6&page=queryresults
[0m15:43:08.385483 [info ] [Thread-1 (]: 10 of 13 PASS unique_dim_currencies_currency ................................... [[32mPASS[0m in 1.88s]
[0m15:43:08.386652 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:43:08.387389 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:43:08.388132 [info ] [Thread-1 (]: 11 of 13 START test unique_dim_date_date ....................................... [RUN]
[0m15:43:08.388947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m15:43:08.389582 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:43:08.397484 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:43:08.398638 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:43:08.406242 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:43:08.407492 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_date`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:43:08.408350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:09.236713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9f238949-d7b3-4d4e-a89e-1805d09a25cd&page=queryresults
[0m15:43:09.686149 [info ] [Thread-1 (]: 11 of 13 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.30s]
[0m15:43:09.687703 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:43:09.688675 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:43:09.689550 [info ] [Thread-1 (]: 12 of 13 START test unique_dim_users_user_kyc_key .............................. [RUN]
[0m15:43:09.690546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m15:43:09.691350 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:43:09.700372 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:43:09.701863 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:43:09.706358 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:43:09.707475 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_kyc_key as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_users`
  where user_kyc_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:43:09.708111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:10.490775 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7a059926-bbc0-4947-bdb8-abf2ffcfbf05&page=queryresults
[0m15:43:11.011167 [info ] [Thread-1 (]: 12 of 13 PASS unique_dim_users_user_kyc_key .................................... [[32mPASS[0m in 1.32s]
[0m15:43:11.012949 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:43:11.013920 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:43:11.014911 [info ] [Thread-1 (]: 13 of 13 START test unique_fct_transactions_txn_id ............................. [RUN]
[0m15:43:11.016820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m15:43:11.018046 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:43:11.027888 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:43:11.029177 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:43:11.034594 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:43:11.035779 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:43:11.036431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:12.152119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3ab2b00c-54ac-496b-8e80-48fa2c0e8a8f&page=queryresults
[0m15:43:12.623749 [error] [Thread-1 (]: 13 of 13 FAIL 68 unique_fct_transactions_txn_id ................................ [[31mFAIL 68[0m in 1.61s]
[0m15:43:12.625620 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:43:12.627989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:12.680229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:12.680771 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_staging' was properly closed.
[0m15:43:12.681161 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480' was properly closed.
[0m15:43:12.681597 [info ] [MainThread]: 
[0m15:43:12.682080 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 21.08 seconds (21.08s).
[0m15:43:12.685135 [debug] [MainThread]: Command end result
[0m15:43:12.727423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:43:12.729882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:43:12.740254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:43:12.740781 [info ] [MainThread]: 
[0m15:43:12.741424 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:43:12.742241 [info ] [MainThread]: 
[0m15:43:12.743253 [error] [MainThread]: [31mFailure in test not_null_fct_transactions_transaction_amount_usd (models/finance/marts/schema.yml)[0m
[0m15:43:12.743956 [error] [MainThread]:   Database Error in test not_null_fct_transactions_transaction_amount_usd (models/finance/marts/schema.yml)
  Unrecognized name: transaction_amount_usd at [18:7]
  compiled code at target/run/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_transaction_amount_usd.sql
[0m15:43:12.744479 [info ] [MainThread]: 
[0m15:43:12.745046 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_transaction_amount_usd.sql
[0m15:43:12.745546 [info ] [MainThread]: 
[0m15:43:12.746195 [error] [MainThread]: [31mFailure in test unique_fct_transactions_txn_id (models/finance/marts/schema.yml)[0m
[0m15:43:12.746863 [error] [MainThread]:   Got 68 results, configured to fail if != 0
[0m15:43:12.747514 [info ] [MainThread]: 
[0m15:43:12.748130 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/unique_fct_transactions_txn_id.sql
[0m15:43:12.748667 [info ] [MainThread]: 
[0m15:43:12.749219 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=13
[0m15:43:12.753739 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 26.250751, "process_in_blocks": "0", "process_kernel_time": 1.252474, "process_mem_max_rss": "360943616", "process_out_blocks": "0", "process_user_time": 9.106938}
[0m15:43:12.754512 [debug] [MainThread]: Command `dbt test` failed at 15:43:12.754386 after 26.25 seconds
[0m15:43:12.755039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a564d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106183be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd5c60>]}
[0m15:43:12.755506 [debug] [MainThread]: Flushing usage events
[0m15:43:14.049661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:55.281555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad08be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad09090>]}


============================== 15:53:55.293094 | d40eb733-b4c8-4556-b9d0-d2da1bbdda4b ==============================
[0m15:53:55.293094 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:53:55.294919 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'invocation_command': 'dbt test --select finance.marts', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80'}
[0m15:54:02.063882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb9f00>]}
[0m15:54:02.148240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4ee020>]}
[0m15:54:02.149152 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:54:02.618369 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:54:03.057292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m15:54:03.058163 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/finance/marts/tb_transactions_tracking.sql
[0m15:54:03.058684 [debug] [MainThread]: Partial parsing: added file: de_test_dwh://models/finance/marts/tb_transactions_by_kyc.sql
[0m15:54:03.059418 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/schema.yml
[0m15:54:03.672083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf76110>]}
[0m15:54:03.809887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:54:03.815272 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:54:03.894519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf77280>]}
[0m15:54:03.895473 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m15:54:03.896163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cf74a90>]}
[0m15:54:03.899442 [info ] [MainThread]: 
[0m15:54:03.900253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:03.900807 [info ] [MainThread]: 
[0m15:54:03.901584 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:54:03.910602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_intermediate'
[0m15:54:03.911476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:04.748776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m15:54:04.751507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:05.390893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m15:54:05.393025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:06.022647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40eb733-b4c8-4556-b9d0-d2da1bbdda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c67cf10>]}
[0m15:54:06.023806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:06.076137 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:54:06.076821 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_currencies_currency ............................ [RUN]
[0m15:54:06.077785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648)
[0m15:54:06.078965 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:54:06.101612 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:54:06.102682 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:54:06.137608 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:54:06.139060 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
where currency is null



  
  
      
    ) dbt_internal_test
[0m15:54:06.139726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:06.973812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ed6dc92d-7932-45be-95d0-cd268e0079e2&page=queryresults
[0m15:54:07.593218 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_currencies_currency .................................. [[32mPASS[0m in 1.52s]
[0m15:54:07.595441 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:54:07.596692 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:54:07.597890 [info ] [Thread-1 (]: 2 of 13 START test not_null_dim_date_date ...................................... [RUN]
[0m15:54:07.599230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m15:54:07.600300 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:54:07.611284 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:54:07.612732 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:54:07.618652 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:54:07.619975 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `cusma-383203`.`dwh_dev_mart`.`dim_date`
where date is null



  
  
      
    ) dbt_internal_test
[0m15:54:07.620895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:08.611628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5566845e-ad07-4c96-908d-714b2dcf0313&page=queryresults
[0m15:54:09.122352 [info ] [Thread-1 (]: 2 of 13 PASS not_null_dim_date_date ............................................ [[32mPASS[0m in 1.52s]
[0m15:54:09.124107 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:54:09.125026 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:54:09.126006 [info ] [Thread-1 (]: 3 of 13 START test not_null_dim_users_effective_from ........................... [RUN]
[0m15:54:09.127115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m15:54:09.128000 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:54:09.137136 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:54:09.139162 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:54:09.143474 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:54:09.144608 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_from
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_from is null



  
  
      
    ) dbt_internal_test
[0m15:54:09.145287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:10.144311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bdece298-6c5a-4979-94b8-814b3f828827&page=queryresults
[0m15:54:10.652984 [info ] [Thread-1 (]: 3 of 13 PASS not_null_dim_users_effective_from ................................. [[32mPASS[0m in 1.53s]
[0m15:54:10.654854 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:54:10.655976 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:54:10.656879 [info ] [Thread-1 (]: 4 of 13 START test not_null_dim_users_effective_to ............................. [RUN]
[0m15:54:10.658327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m15:54:10.659362 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:54:10.667835 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:54:10.669195 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:54:10.674182 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:54:10.676272 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_to
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_to is null



  
  
      
    ) dbt_internal_test
[0m15:54:10.677214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:11.684706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:daeb98eb-9eb2-4fbb-b0af-b1ad81a97a55&page=queryresults
[0m15:54:12.178409 [info ] [Thread-1 (]: 4 of 13 PASS not_null_dim_users_effective_to ................................... [[32mPASS[0m in 1.52s]
[0m15:54:12.180175 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:54:12.181230 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:54:12.182218 [info ] [Thread-1 (]: 5 of 13 START test not_null_dim_users_kyc_level ................................ [RUN]
[0m15:54:12.183346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m15:54:12.184231 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:54:12.196235 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:54:12.197516 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:54:12.202600 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:54:12.204858 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_kyc_level.552489338e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m15:54:12.205926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:13.015551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8536a682-51f3-4a07-9b77-4e3542d849e5&page=queryresults
[0m15:54:13.514601 [info ] [Thread-1 (]: 5 of 13 PASS not_null_dim_users_kyc_level ...................................... [[32mPASS[0m in 1.33s]
[0m15:54:13.516556 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:54:13.517608 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:54:13.518646 [info ] [Thread-1 (]: 6 of 13 START test not_null_dim_users_user_id .................................. [RUN]
[0m15:54:13.519774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m15:54:13.520659 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:54:13.531464 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:54:13.532736 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:54:13.538606 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:54:13.539909 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:54:13.540591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:14.550279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5f981c60-932c-4e2d-b687-7eba66fb7be2&page=queryresults
[0m15:54:15.152260 [info ] [Thread-1 (]: 6 of 13 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 1.63s]
[0m15:54:15.154036 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:54:15.155014 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:54:15.156108 [info ] [Thread-1 (]: 7 of 13 START test not_null_dim_users_user_kyc_key ............................. [RUN]
[0m15:54:15.157390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m15:54:15.158494 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:54:15.168553 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:54:15.169824 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:54:15.173931 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:54:15.174949 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_kyc_key
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_kyc_key is null



  
  
      
    ) dbt_internal_test
[0m15:54:15.175588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:15.823183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bf40714b-e624-4f86-94c3-ae22aded2f25&page=queryresults
[0m15:54:16.307875 [info ] [Thread-1 (]: 7 of 13 PASS not_null_dim_users_user_kyc_key ................................... [[32mPASS[0m in 1.15s]
[0m15:54:16.309710 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:54:16.310653 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:54:16.311706 [info ] [Thread-1 (]: 8 of 13 START test not_null_fct_transactions_destination_amount_usd ............ [RUN]
[0m15:54:16.312854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0)
[0m15:54:16.313723 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:54:16.323042 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m15:54:16.324342 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:54:16.328927 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m15:54:16.330119 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select destination_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where destination_amount_usd is null



  
  
      
    ) dbt_internal_test
[0m15:54:16.330798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:17.212789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ee2cc03d-8b17-4a08-8a39-a7be726b3055&page=queryresults
[0m15:54:17.697943 [error] [Thread-1 (]: 8 of 13 FAIL 25 not_null_fct_transactions_destination_amount_usd ............... [[31mFAIL 25[0m in 1.38s]
[0m15:54:17.700041 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:54:17.701004 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:54:17.702040 [info ] [Thread-1 (]: 9 of 13 START test not_null_fct_transactions_txn_id ............................ [RUN]
[0m15:54:17.703175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m15:54:17.704022 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:54:17.712464 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:54:17.713966 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:54:17.720336 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:54:17.723334 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m15:54:17.724249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:18.468719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1684828b-7706-4d2b-93b2-aadda4ef1d84&page=queryresults
[0m15:54:18.978398 [info ] [Thread-1 (]: 9 of 13 PASS not_null_fct_transactions_txn_id .................................. [[32mPASS[0m in 1.28s]
[0m15:54:18.980172 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:54:18.981398 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:54:18.982559 [info ] [Thread-1 (]: 10 of 13 START test unique_dim_currencies_currency ............................. [RUN]
[0m15:54:18.983695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m15:54:18.984543 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:54:18.999217 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:54:19.000664 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:54:19.005154 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:54:19.006384 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_currencies_currency.20f50226d8: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select currency as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
  where currency is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:54:19.007188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:19.720435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fc6081e5-3029-4c77-9177-68f2f6dd9dc2&page=queryresults
[0m15:54:20.241040 [info ] [Thread-1 (]: 10 of 13 PASS unique_dim_currencies_currency ................................... [[32mPASS[0m in 1.26s]
[0m15:54:20.242861 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:54:20.243834 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:54:20.244870 [info ] [Thread-1 (]: 11 of 13 START test unique_dim_date_date ....................................... [RUN]
[0m15:54:20.245998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m15:54:20.246859 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:54:20.258986 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:54:20.260343 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:54:20.266962 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:54:20.268254 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_date`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:54:20.268857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:21.104559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a68a2230-ee9f-4da3-baac-7ef797d0aa18&page=queryresults
[0m15:54:21.602036 [info ] [Thread-1 (]: 11 of 13 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.36s]
[0m15:54:21.603771 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:54:21.604777 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:54:21.605784 [info ] [Thread-1 (]: 12 of 13 START test unique_dim_users_user_kyc_key .............................. [RUN]
[0m15:54:21.607061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m15:54:21.608006 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:54:21.619184 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:54:21.620505 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:54:21.624745 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:54:21.625829 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_kyc_key as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_users`
  where user_kyc_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:54:21.626524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:22.390938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:041aee07-5fa5-4169-8cb8-68eda76055b7&page=queryresults
[0m15:54:22.901404 [info ] [Thread-1 (]: 12 of 13 PASS unique_dim_users_user_kyc_key .................................... [[32mPASS[0m in 1.29s]
[0m15:54:22.903230 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:54:22.904329 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:54:22.905428 [info ] [Thread-1 (]: 13 of 13 START test unique_fct_transactions_txn_id ............................. [RUN]
[0m15:54:22.906520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m15:54:22.907418 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:54:22.916579 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:54:22.917851 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:54:22.922292 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:54:22.923379 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:54:22.924177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:23.905405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:791a4fc9-b190-4667-bcc3-6495f3f8e179&page=queryresults
[0m15:54:24.375064 [error] [Thread-1 (]: 13 of 13 FAIL 68 unique_fct_transactions_txn_id ................................ [[31mFAIL 68[0m in 1.47s]
[0m15:54:24.376896 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:54:24.379303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:24.431366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:24.431963 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480' was properly closed.
[0m15:54:24.432437 [info ] [MainThread]: 
[0m15:54:24.432940 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 20.53 seconds (20.53s).
[0m15:54:24.436066 [debug] [MainThread]: Command end result
[0m15:54:24.481237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:54:24.483854 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:54:24.495358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:54:24.495931 [info ] [MainThread]: 
[0m15:54:24.496506 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:54:24.497089 [info ] [MainThread]: 
[0m15:54:24.497680 [error] [MainThread]: [31mFailure in test not_null_fct_transactions_destination_amount_usd (models/finance/marts/schema.yml)[0m
[0m15:54:24.498267 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m15:54:24.498776 [info ] [MainThread]: 
[0m15:54:24.499309 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_destination_amount_usd.sql
[0m15:54:24.499829 [info ] [MainThread]: 
[0m15:54:24.500352 [error] [MainThread]: [31mFailure in test unique_fct_transactions_txn_id (models/finance/marts/schema.yml)[0m
[0m15:54:24.500830 [error] [MainThread]:   Got 68 results, configured to fail if != 0
[0m15:54:24.501245 [info ] [MainThread]: 
[0m15:54:24.501852 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/unique_fct_transactions_txn_id.sql
[0m15:54:24.502599 [info ] [MainThread]: 
[0m15:54:24.503195 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=13
[0m15:54:24.508156 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 29.33246, "process_in_blocks": "0", "process_kernel_time": 2.054366, "process_mem_max_rss": "366641152", "process_out_blocks": "0", "process_user_time": 11.00357}
[0m15:54:24.509402 [debug] [MainThread]: Command `dbt test` failed at 15:54:24.509137 after 29.33 seconds
[0m15:54:24.510113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d0a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb9f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e89c60>]}
[0m15:54:24.510727 [debug] [MainThread]: Flushing usage events
[0m15:54:25.813819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:29.908270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcc9270>]}


============================== 15:58:29.914831 | f5a036e4-bebc-4db3-bdf8-f714f02c1dd2 ==============================
[0m15:58:29.914831 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:58:29.915688 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt test --select finance.marts', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error': 'None'}
[0m15:58:35.977245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee1ae30>]}
[0m15:58:36.063336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fafa170>]}
[0m15:58:36.064257 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m15:58:36.400319 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m15:58:36.867304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:36.867908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:36.928132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131bd0e20>]}
[0m15:58:37.054714 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:58:37.058405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:58:37.118553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a4f730>]}
[0m15:58:37.119441 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m15:58:37.120005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131a4e050>]}
[0m15:58:37.122605 [info ] [MainThread]: 
[0m15:58:37.123230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:37.123914 [info ] [MainThread]: 
[0m15:58:37.124728 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:58:37.133386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_intermediate'
[0m15:58:37.134412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:37.976934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m15:58:37.979826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:38.567476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m15:58:38.570049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:39.183439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a036e4-bebc-4db3-bdf8-f714f02c1dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13151a230>]}
[0m15:58:39.184685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:39.242945 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:58:39.243616 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_currencies_currency ............................ [RUN]
[0m15:58:39.244416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648)
[0m15:58:39.245005 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:58:39.272361 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:58:39.274008 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:58:39.300115 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m15:58:39.301257 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
where currency is null



  
  
      
    ) dbt_internal_test
[0m15:58:39.301833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:40.059945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:95f1eb63-3807-4777-b465-520b55210dfc&page=queryresults
[0m15:58:40.673127 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_currencies_currency .................................. [[32mPASS[0m in 1.43s]
[0m15:58:40.674555 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m15:58:40.675411 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:58:40.676343 [info ] [Thread-1 (]: 2 of 13 START test not_null_dim_date_date ...................................... [RUN]
[0m15:58:40.677392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m15:58:40.678168 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:58:40.686725 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:58:40.689032 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:58:40.693762 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m15:58:40.695174 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `cusma-383203`.`dwh_dev_mart`.`dim_date`
where date is null



  
  
      
    ) dbt_internal_test
[0m15:58:40.695872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:41.546730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:73556111-c982-4d81-8877-3d8ecb1d6195&page=queryresults
[0m15:58:42.104868 [info ] [Thread-1 (]: 2 of 13 PASS not_null_dim_date_date ............................................ [[32mPASS[0m in 1.43s]
[0m15:58:42.106662 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m15:58:42.107682 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:58:42.108745 [info ] [Thread-1 (]: 3 of 13 START test not_null_dim_users_effective_from ........................... [RUN]
[0m15:58:42.109943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m15:58:42.110943 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:58:42.124059 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:58:42.125737 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:58:42.131551 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m15:58:42.132743 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_from
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_from is null



  
  
      
    ) dbt_internal_test
[0m15:58:42.133395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.877465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cec5c9dd-7097-42cb-a6a1-b048becf2081&page=queryresults
[0m15:58:43.381962 [info ] [Thread-1 (]: 3 of 13 PASS not_null_dim_users_effective_from ................................. [[32mPASS[0m in 1.27s]
[0m15:58:43.383126 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m15:58:43.383915 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:58:43.384777 [info ] [Thread-1 (]: 4 of 13 START test not_null_dim_users_effective_to ............................. [RUN]
[0m15:58:43.385949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m15:58:43.386688 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:58:43.395052 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:58:43.397639 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:58:43.404059 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m15:58:43.405476 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_to
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_to is null



  
  
      
    ) dbt_internal_test
[0m15:58:43.406417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:44.106169 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f4b6844c-8d25-419d-be05-bd8f5bcd0723&page=queryresults
[0m15:58:44.593572 [info ] [Thread-1 (]: 4 of 13 PASS not_null_dim_users_effective_to ................................... [[32mPASS[0m in 1.21s]
[0m15:58:44.594625 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m15:58:44.595267 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:58:44.595976 [info ] [Thread-1 (]: 5 of 13 START test not_null_dim_users_kyc_level ................................ [RUN]
[0m15:58:44.596683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m15:58:44.597183 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:58:44.603310 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:58:44.604353 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:58:44.609941 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m15:58:44.611043 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_kyc_level.552489338e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m15:58:44.611832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:45.437692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4dffdbe3-bf38-4729-81b3-41fcf558b95a&page=queryresults
[0m15:58:45.927263 [info ] [Thread-1 (]: 5 of 13 PASS not_null_dim_users_kyc_level ...................................... [[32mPASS[0m in 1.33s]
[0m15:58:45.930887 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m15:58:45.932069 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:58:45.933128 [info ] [Thread-1 (]: 6 of 13 START test not_null_dim_users_user_id .................................. [RUN]
[0m15:58:45.934268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m15:58:45.935606 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:58:45.947562 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:58:45.953436 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:58:45.961101 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m15:58:45.962167 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:58:45.962749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:46.718848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:57ac7371-f2da-43f1-8ca5-1e4c0b9ab579&page=queryresults
[0m15:58:47.197281 [info ] [Thread-1 (]: 6 of 13 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 1.26s]
[0m15:58:47.217339 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m15:58:47.218969 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:58:47.220764 [info ] [Thread-1 (]: 7 of 13 START test not_null_dim_users_user_kyc_key ............................. [RUN]
[0m15:58:47.222157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m15:58:47.223029 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:58:47.234034 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:58:47.235459 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:58:47.241662 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m15:58:47.242796 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_kyc_key
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_kyc_key is null



  
  
      
    ) dbt_internal_test
[0m15:58:47.243673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:47.995076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7f647fc8-7141-430e-aa1f-b547ccece6d5&page=queryresults
[0m15:58:48.496650 [info ] [Thread-1 (]: 7 of 13 PASS not_null_dim_users_user_kyc_key ................................... [[32mPASS[0m in 1.27s]
[0m15:58:48.498096 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m15:58:48.498903 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:58:48.499978 [info ] [Thread-1 (]: 8 of 13 START test not_null_fct_transactions_destination_amount_usd ............ [RUN]
[0m15:58:48.500945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0)
[0m15:58:48.501733 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:58:48.512453 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m15:58:48.514185 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:58:48.520301 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m15:58:48.521563 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select destination_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where destination_amount_usd is null



  
  
      
    ) dbt_internal_test
[0m15:58:48.522233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:49.633041 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cfad4e52-861c-439b-8897-ff6721a92dd4&page=queryresults
[0m15:58:50.076036 [error] [Thread-1 (]: 8 of 13 FAIL 25 not_null_fct_transactions_destination_amount_usd ............... [[31mFAIL 25[0m in 1.57s]
[0m15:58:50.077728 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m15:58:50.078735 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:58:50.079746 [info ] [Thread-1 (]: 9 of 13 START test not_null_fct_transactions_txn_id ............................ [RUN]
[0m15:58:50.080750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m15:58:50.081478 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:58:50.089551 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:58:50.091270 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:58:50.098356 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m15:58:50.100209 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m15:58:50.101995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:50.865171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9a04cf37-8cf1-480c-aa04-cda6bc3ea88d&page=queryresults
[0m15:58:51.326276 [info ] [Thread-1 (]: 9 of 13 PASS not_null_fct_transactions_txn_id .................................. [[32mPASS[0m in 1.25s]
[0m15:58:51.329153 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m15:58:51.330561 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:58:51.331784 [info ] [Thread-1 (]: 10 of 13 START test unique_dim_currencies_currency ............................. [RUN]
[0m15:58:51.333253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m15:58:51.334636 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:58:51.351557 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:58:51.353556 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:58:51.358013 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m15:58:51.359274 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_currencies_currency.20f50226d8: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select currency as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
  where currency is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:58:51.359891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:52.194481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f5c72cbb-bd3c-441f-83f3-36c95b41b640&page=queryresults
[0m15:58:52.650272 [info ] [Thread-1 (]: 10 of 13 PASS unique_dim_currencies_currency ................................... [[32mPASS[0m in 1.32s]
[0m15:58:52.652074 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m15:58:52.652982 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:58:52.653951 [info ] [Thread-1 (]: 11 of 13 START test unique_dim_date_date ....................................... [RUN]
[0m15:58:52.655010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m15:58:52.655856 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:58:52.666172 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:58:52.669502 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:58:52.677254 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m15:58:52.680138 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_date`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:58:52.681526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:53.629936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0879ec84-f15a-439f-8155-7978b06d254b&page=queryresults
[0m15:58:54.089964 [info ] [Thread-1 (]: 11 of 13 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.43s]
[0m15:58:54.091768 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m15:58:54.092749 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:58:54.093817 [info ] [Thread-1 (]: 12 of 13 START test unique_dim_users_user_kyc_key .............................. [RUN]
[0m15:58:54.095126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m15:58:54.096069 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:58:54.104541 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:58:54.108057 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:58:54.113997 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m15:58:54.115974 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_kyc_key as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_users`
  where user_kyc_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:58:54.118776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:54.848641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b8e7508a-a7b9-4860-91d1-695693af5d6d&page=queryresults
[0m15:58:55.328158 [info ] [Thread-1 (]: 12 of 13 PASS unique_dim_users_user_kyc_key .................................... [[32mPASS[0m in 1.23s]
[0m15:58:55.329936 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m15:58:55.330972 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:58:55.331967 [info ] [Thread-1 (]: 13 of 13 START test unique_fct_transactions_txn_id ............................. [RUN]
[0m15:58:55.333127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m15:58:55.334075 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:58:55.346370 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:58:55.347653 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:58:55.351925 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m15:58:55.353138 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:58:55.353803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:56.188687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:10b222b1-f18c-4746-aecd-e5d9250aa465&page=queryresults
[0m15:58:56.656307 [error] [Thread-1 (]: 13 of 13 FAIL 68 unique_fct_transactions_txn_id ................................ [[31mFAIL 68[0m in 1.32s]
[0m15:58:56.657442 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m15:58:56.659854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:56.710049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:56.710846 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480' was properly closed.
[0m15:58:56.711462 [info ] [MainThread]: 
[0m15:58:56.712043 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 19.59 seconds (19.59s).
[0m15:58:56.717991 [debug] [MainThread]: Command end result
[0m15:58:56.775657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m15:58:56.780125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m15:58:56.791150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m15:58:56.792028 [info ] [MainThread]: 
[0m15:58:56.792933 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:58:56.794042 [info ] [MainThread]: 
[0m15:58:56.795040 [error] [MainThread]: [31mFailure in test not_null_fct_transactions_destination_amount_usd (models/finance/marts/schema.yml)[0m
[0m15:58:56.795850 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m15:58:56.796880 [info ] [MainThread]: 
[0m15:58:56.797674 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_destination_amount_usd.sql
[0m15:58:56.798384 [info ] [MainThread]: 
[0m15:58:56.799117 [error] [MainThread]: [31mFailure in test unique_fct_transactions_txn_id (models/finance/marts/schema.yml)[0m
[0m15:58:56.799815 [error] [MainThread]:   Got 68 results, configured to fail if != 0
[0m15:58:56.800410 [info ] [MainThread]: 
[0m15:58:56.801031 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/unique_fct_transactions_txn_id.sql
[0m15:58:56.801521 [info ] [MainThread]: 
[0m15:58:56.801986 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=13
[0m15:58:56.808231 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 26.99741, "process_in_blocks": "0", "process_kernel_time": 1.955842, "process_mem_max_rss": "359870464", "process_out_blocks": "0", "process_user_time": 10.295289}
[0m15:58:56.809101 [debug] [MainThread]: Command `dbt test` failed at 15:58:56.808943 after 27.00 seconds
[0m15:58:56.809743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd24a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fafa170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132192b00>]}
[0m15:58:56.810380 [debug] [MainThread]: Flushing usage events
[0m15:58:58.033956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:56.042296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112182500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113180c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131810c0>]}


============================== 15:59:56.049588 | 5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb ==============================
[0m15:59:56.049588 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m15:59:56.050530 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt test --select finance.marts', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False'}
[0m16:00:02.921724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ab2710>]}
[0m16:00:02.993144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fc0a0>]}
[0m16:00:02.994028 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:00:03.322316 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:00:03.766798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:00:03.768127 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/schema.yml
[0m16:00:04.307714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135460130>]}
[0m16:00:04.450338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:00:04.456445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:00:04.516010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13504b100>]}
[0m16:00:04.516775 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:00:04.517351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13503e320>]}
[0m16:00:04.519519 [info ] [MainThread]: 
[0m16:00:04.520347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:04.521069 [info ] [MainThread]: 
[0m16:00:04.522441 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:00:04.534670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_mart'
[0m16:00:04.535934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:05.187058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:00:05.190292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:05.804102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:00:05.805719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:06.395672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b9d94e9-4271-4ed2-a490-52d7fc3e2ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a1e230>]}
[0m16:00:06.397084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:06.452235 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:00:06.452892 [info ] [Thread-1 (]: 1 of 2 START test not_null_fct_transactions_txn_id ............................. [RUN]
[0m16:00:06.453645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m16:00:06.454115 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:00:06.480220 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:00:06.481815 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:00:06.508201 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:00:06.509413 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:00:06.510037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.316084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:061c1610-2862-419d-9306-71463dc1962c&page=queryresults
[0m16:00:07.957237 [info ] [Thread-1 (]: 1 of 2 PASS not_null_fct_transactions_txn_id ................................... [[32mPASS[0m in 1.50s]
[0m16:00:07.958658 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:00:07.959502 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:00:07.960425 [info ] [Thread-1 (]: 2 of 2 START test unique_fct_transactions_txn_id ............................... [RUN]
[0m16:00:07.961356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m16:00:07.962065 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:00:07.975258 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:00:07.976769 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:00:07.982678 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:00:07.984001 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:00:07.984756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:08.794491 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0483a49b-edc9-424d-a8ba-7980ca3e643f&page=queryresults
[0m16:00:09.275186 [error] [Thread-1 (]: 2 of 2 FAIL 68 unique_fct_transactions_txn_id .................................. [[31mFAIL 68[0m in 1.31s]
[0m16:00:09.276307 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:00:09.277911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:09.328384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:09.328978 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480' was properly closed.
[0m16:00:09.329680 [info ] [MainThread]: 
[0m16:00:09.330256 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m16:00:09.331310 [debug] [MainThread]: Command end result
[0m16:00:09.378249 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:00:09.380807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:00:09.392340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:00:09.392907 [info ] [MainThread]: 
[0m16:00:09.393435 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:00:09.393933 [info ] [MainThread]: 
[0m16:00:09.394458 [error] [MainThread]: [31mFailure in test unique_fct_transactions_txn_id (models/finance/marts/schema.yml)[0m
[0m16:00:09.395023 [error] [MainThread]:   Got 68 results, configured to fail if != 0
[0m16:00:09.395443 [info ] [MainThread]: 
[0m16:00:09.395935 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/unique_fct_transactions_txn_id.sql
[0m16:00:09.396403 [info ] [MainThread]: 
[0m16:00:09.396890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m16:00:09.401355 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 13.466422, "process_in_blocks": "0", "process_kernel_time": 1.98253, "process_mem_max_rss": "363966464", "process_out_blocks": "0", "process_user_time": 8.64129}
[0m16:00:09.402549 [debug] [MainThread]: Command `dbt test` failed at 16:00:09.402119 after 13.47 seconds
[0m16:00:09.403439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112182500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129fc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1354a5480>]}
[0m16:00:09.404251 [debug] [MainThread]: Flushing usage events
[0m16:00:10.634822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:51.007779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d040dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d041270>]}


============================== 16:07:51.015094 | 887b43f7-5449-473e-958a-7f11c82d8621 ==============================
[0m16:07:51.015094 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:07:51.015939 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'fail_fast': 'False', 'empty': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select finance.intemediate', 'use_experimental_parser': 'False'}
[0m16:07:58.106329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '887b43f7-5449-473e-958a-7f11c82d8621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c18ee60>]}
[0m16:07:58.210686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '887b43f7-5449-473e-958a-7f11c82d8621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce6d900>]}
[0m16:07:58.211969 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:07:58.604967 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:07:59.530041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:59.531628 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/intermediate/int_transactions_with_rates.sql
[0m16:08:00.610217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '887b43f7-5449-473e-958a-7f11c82d8621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f2a9090>]}
[0m16:08:00.903028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:08:00.908262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:08:00.967070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '887b43f7-5449-473e-958a-7f11c82d8621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f02e530>]}
[0m16:08:00.969329 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:08:00.970691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '887b43f7-5449-473e-958a-7f11c82d8621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f02ee90>]}
[0m16:08:00.972887 [warn ] [MainThread]: The selection criterion 'finance.intemediate' does not match any enabled nodes
[0m16:08:00.975423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:08:00.977959 [debug] [MainThread]: Command end result
[0m16:08:01.038795 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:08:01.046610 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:08:01.096575 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:08:01.120515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.227105, "process_in_blocks": "0", "process_kernel_time": 1.986868, "process_mem_max_rss": "343695360", "process_out_blocks": "0", "process_user_time": 7.782639}
[0m16:08:01.122814 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:01.122511 after 10.23 seconds
[0m16:08:01.124122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce6d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0205b0>]}
[0m16:08:01.125111 [debug] [MainThread]: Flushing usage events
[0m16:08:02.402751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:09.952148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e34e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f314dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f315270>]}


============================== 16:09:09.959921 | 7fc71e91-bd41-4c74-b798-c1fbd467fb37 ==============================
[0m16:09:09.959921 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:09:09.960878 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select finance', 'warn_error': 'None', 'no_print': 'None', 'empty': 'False', 'introspect': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True'}
[0m16:09:16.433833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130bde830>]}
[0m16:09:16.525297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb97970>]}
[0m16:09:16.526122 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:09:16.855029 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:09:17.299282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:17.299871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:17.363333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13129a7a0>]}
[0m16:09:17.480337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:09:17.484499 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:09:17.536150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13122fe50>]}
[0m16:09:17.537010 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:09:17.537675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13122d060>]}
[0m16:09:17.540044 [info ] [MainThread]: 
[0m16:09:17.540648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:17.541242 [info ] [MainThread]: 
[0m16:09:17.542633 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:09:17.553960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:09:17.555368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:18.533703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:19.316110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:20.038627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now create_cusma-383203_dwh_dev_intermediate)
[0m16:09:20.041504 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_intermediate"
"
[0m16:09:20.064121 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_intermediate: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_intermediate"} */
create schema if not exists `cusma-383203`.`dwh_dev_intermediate`
  
[0m16:09:20.064932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:20.767005 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4e1b38db-e1dc-4ae2-8f92-3992e8867c10&page=queryresults
[0m16:09:24.359377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_intermediate, now create_cusma-383203_dwh_dev_mart)
[0m16:09:24.360254 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_mart"
"
[0m16:09:24.363153 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_mart: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_mart"} */
create schema if not exists `cusma-383203`.`dwh_dev_mart`
  
[0m16:09:24.363658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:25.008637 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7f702594-194e-42de-8bab-ce5813912675&page=queryresults
[0m16:09:27.929151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_mart, now create_cusma-383203_dwh_dev_staging)
[0m16:09:27.930805 [debug] [ThreadPool]: Creating schema "database: "cusma-383203"
schema: "dwh_dev_staging"
"
[0m16:09:27.935850 [debug] [ThreadPool]: On create_cusma-383203_dwh_dev_staging: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "create_cusma-383203_dwh_dev_staging"} */
create schema if not exists `cusma-383203`.`dwh_dev_staging`
  
[0m16:09:27.936755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:28.601275 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7aa87d2b-22a7-4380-b346-55ca71f85302&page=queryresults
[0m16:09:31.118939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m16:09:31.120374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:31.870107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m16:09:31.872585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:32.551683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m16:09:32.553037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:33.329582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da60580>]}
[0m16:09:33.331052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:33.388776 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:09:33.390651 [info ] [Thread-1 (]: 1 of 12 START sql view model dwh_dev_staging.stg_rates ......................... [RUN]
[0m16:09:33.392293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.stg_rates)
[0m16:09:33.393623 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:09:33.417812 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:09:33.421514 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:09:33.453609 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m16:09:33.454698 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m16:09:33.455287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:34.463872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d18b5479-0dd7-4af1-98e3-70d92378b22d&page=queryresults
[0m16:09:34.762961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dcc0850>]}
[0m16:09:34.764398 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dwh_dev_staging.stg_rates .................... [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m16:09:34.765398 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:09:34.766102 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:09:34.767159 [info ] [Thread-1 (]: 2 of 12 START sql view model dwh_dev_staging.stg_transactions .................. [RUN]
[0m16:09:34.768114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:09:34.768730 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:09:34.773730 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:09:34.774737 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:09:34.778592 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m16:09:34.779749 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m16:09:34.780493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:35.592838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a98343c3-a11b-48f1-9fc9-536890739463&page=queryresults
[0m16:09:35.959420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d524be0>]}
[0m16:09:35.960997 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dwh_dev_staging.stg_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m16:09:35.962591 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:09:35.963599 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:09:35.964826 [info ] [Thread-1 (]: 3 of 12 START sql view model dwh_dev_staging.stg_users ......................... [RUN]
[0m16:09:35.966069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:09:35.966899 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:09:35.973507 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:09:35.974768 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:09:35.985144 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m16:09:35.986885 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m16:09:35.987555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:36.822086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ae49caac-fdd2-471f-8960-65da0e5a85da&page=queryresults
[0m16:09:37.132779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d524be0>]}
[0m16:09:37.134407 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dwh_dev_staging.stg_users .................... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m16:09:37.135833 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:09:37.136829 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:09:37.138215 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh_dev_intermediate.int_rates_usdt .............. [RUN]
[0m16:09:37.139177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:09:37.139930 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:09:37.147057 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:09:37.148494 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:09:37.201311 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m16:09:37.202493 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m16:09:37.203093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:38.588582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f6d84daa-4c0d-4010-9b71-e400d569f367&page=queryresults
[0m16:09:45.085705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131867df0>]}
[0m16:09:45.088650 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh_dev_intermediate.int_rates_usdt ......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 7.95s]
[0m16:09:45.090770 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:09:45.091896 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:09:45.093296 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh_dev_mart.dim_currencies ...................... [RUN]
[0m16:09:45.094773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.dim_currencies)
[0m16:09:45.096538 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:09:45.104929 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:09:45.106915 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:09:45.118574 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m16:09:45.121373 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m16:09:45.122182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:46.595824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f992de74-929b-4115-8837-a3a4ad5d4488&page=queryresults
[0m16:09:48.580897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d524be0>]}
[0m16:09:48.582503 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh_dev_mart.dim_currencies ................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.49s]
[0m16:09:48.583871 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:09:48.584806 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:09:48.585969 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh_dev_mart.dim_date ............................ [RUN]
[0m16:09:48.587109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:09:48.587875 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:09:48.594556 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:09:48.595882 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:09:48.602949 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m16:09:48.605782 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m16:09:48.607870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:49.726769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6cdf2e15-6493-422b-b522-435e4c7349be&page=queryresults
[0m16:09:51.467250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318553f0>]}
[0m16:09:51.468680 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh_dev_mart.dim_date ....................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 2.88s]
[0m16:09:51.469899 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:09:51.470779 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:09:51.471869 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh_dev_intermediate.int_users_scd2 .............. [RUN]
[0m16:09:51.472857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.int_users_scd2)
[0m16:09:51.473538 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:09:51.501821 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:09:51.504848 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:09:51.510152 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m16:09:51.511252 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m16:09:51.511844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:53.001759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7ec18cf3-014e-49d4-a948-4f84c71d4276&page=queryresults
[0m16:09:54.481537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318e47f0>]}
[0m16:09:54.483243 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh_dev_intermediate.int_users_scd2 ......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.01s]
[0m16:09:54.484606 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:09:54.485532 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:09:54.486856 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh_dev_intermediate.int_transactions_with_rates . [RUN]
[0m16:09:54.487928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m16:09:54.488709 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:09:54.497999 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:09:54.499805 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:09:54.505970 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:09:54.507499 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

transaction_source_rates as (
    select
        t.*,
        r.usdt_price as source_usdt_price,
        r.price_timestamp as source_rate_timestamp,
        row_number() over (
            partition by t.txn_id 
            order by r.price_timestamp desc
        ) as rn_source
    from transactions t
    left join rates r
        on r.currency = t.source_currency
       and r.price_timestamp <= t.created_at
),

transaction_destination_rates as (
    select
        t.*,
        r.usdt_price as destination_usdt_price,
        r.price_timestamp as destination_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc
        ) as rn_dest
    from transactions t
    left join rates r
        on r.currency = t.destination_currency
       and r.price_timestamp <= t.created_at
)

select
    t.txn_id,
    t.user_id,
    t.source_amount,
    t.destination_amount,
    t.created_at,
    tsr.source_usdt_price,
    tsr.source_rate_timestamp,
    tdr.destination_usdt_price,
    tdr.destination_rate_timestamp,
    date(t.created_at) as date_created,
    t.source_amount * coalesce(tsr.source_usdt_price, 0) as source_amount_usd,
    t.destination_amount * coalesce(tdr.destination_usdt_price, 0) as destination_amount_usd
from transactions t
left join transaction_source_rates tsr
    on tsr.txn_id = t.txn_id
    and tsr.rn_source = 1 
left join transaction_destination_rates tdr
    on tdr.txn_id = t.txn_id
    and tdr.rn_dest = 1
    );
  
[0m16:09:54.508401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:55.968121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ecf1323c-381c-4325-98ef-dbb5e351b2fa&page=queryresults
[0m16:10:00.379341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318eca60>]}
[0m16:10:00.382096 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (93.0 rows, 665.9 KiB processed)[0m in 5.89s]
[0m16:10:00.383363 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:10:00.383952 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:10:00.384869 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh_dev_mart.dim_users ........................... [RUN]
[0m16:10:00.386022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now model.de_test_dwh.dim_users)
[0m16:10:00.386792 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:10:00.393143 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:10:00.394208 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:10:00.399064 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m16:10:00.400335 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m16:10:00.401009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:01.363909 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8b159057-96ac-430c-9039-461700f05cd2&page=queryresults
[0m16:10:02.965437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1318edab0>]}
[0m16:10:02.966727 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh_dev_mart.dim_users ...................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.58s]
[0m16:10:02.967737 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:10:02.968357 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:10:02.969326 [info ] [Thread-1 (]: 10 of 12 START sql table model dwh_dev_mart.fct_transactions ................... [RUN]
[0m16:10:02.970274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:10:02.970903 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:10:02.979198 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:10:02.980220 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:10:02.985885 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m16:10:02.987368 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m16:10:02.988099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:03.955745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2b5593bd-3bb4-487b-91b3-12fab3868be4&page=queryresults
[0m16:10:04.067290 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2b5593bd-3bb4-487b-91b3-12fab3868be4&page=queryresults
[0m16:10:04.093575 [debug] [Thread-1 (]: Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name status not found inside t at [30:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:10:04.094557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc71e91-bd41-4c74-b798-c1fbd467fb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131867f40>]}
[0m16:10:04.096001 [error] [Thread-1 (]: 10 of 12 ERROR creating sql table model dwh_dev_mart.fct_transactions .......... [[31mERROR[0m in 1.12s]
[0m16:10:04.097352 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:10:04.098644 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.fct_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name status not found inside t at [30:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql.
[0m16:10:04.101416 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:10:04.102897 [info ] [Thread-1 (]: 11 of 12 SKIP relation dwh_dev_mart.tb_transactions_by_kyc ..................... [[33mSKIP[0m]
[0m16:10:04.104113 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:10:04.104822 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:10:04.105769 [info ] [Thread-1 (]: 12 of 12 SKIP relation dwh_dev_mart.tb_transactions_tracking ................... [[33mSKIP[0m]
[0m16:10:04.106599 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:10:04.108511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:04.157783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:04.158441 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m16:10:04.159090 [info ] [MainThread]: 
[0m16:10:04.160119 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 46.62 seconds (46.62s).
[0m16:10:04.163216 [debug] [MainThread]: Command end result
[0m16:10:04.211166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:10:04.214881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:10:04.229508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:10:04.230069 [info ] [MainThread]: 
[0m16:10:04.230709 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:10:04.231492 [info ] [MainThread]: 
[0m16:10:04.232276 [error] [MainThread]: [31mFailure in model fct_transactions (models/finance/marts/fct_transactions.sql)[0m
[0m16:10:04.233534 [error] [MainThread]:   Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name status not found inside t at [30:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:10:04.234256 [info ] [MainThread]: 
[0m16:10:04.235021 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:10:04.235735 [info ] [MainThread]: 
[0m16:10:04.238742 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=12
[0m16:10:04.244496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 54.395454, "process_in_blocks": "0", "process_kernel_time": 2.065379, "process_mem_max_rss": "359149568", "process_out_blocks": "0", "process_user_time": 11.016177}
[0m16:10:04.245640 [debug] [MainThread]: Command `dbt run` failed at 16:10:04.245405 after 54.40 seconds
[0m16:10:04.246497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e34e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb97970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13129a590>]}
[0m16:10:04.247334 [debug] [MainThread]: Flushing usage events
[0m16:10:05.900959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:44.665769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105048dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105049270>]}


============================== 16:11:44.672525 | d3212940-6d28-4996-91b5-103159d0a894 ==============================
[0m16:11:44.672525 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:11:44.673376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run --select finance', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m16:11:50.453065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239c23b0>]}
[0m16:11:50.532743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6d900>]}
[0m16:11:50.533588 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:11:50.854464 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:11:51.267866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:51.268778 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/intermediate/int_transactions_with_rates.sql
[0m16:11:51.610667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271e1150>]}
[0m16:11:51.748384 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:11:51.750991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:11:51.796985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f6a7d0>]}
[0m16:11:51.797804 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:11:51.798367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f69c60>]}
[0m16:11:51.800533 [info ] [MainThread]: 
[0m16:11:51.801170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:51.801642 [info ] [MainThread]: 
[0m16:11:51.802361 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:51.809662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:11:51.811269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:52.667630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:53.535605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:54.258637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m16:11:54.259896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:54.873682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m16:11:54.878556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:55.484305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m16:11:55.486852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:56.092830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103221480>]}
[0m16:11:56.094391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:56.152251 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:11:56.152995 [info ] [Thread-1 (]: 1 of 12 START sql view model dwh_dev_staging.stg_rates ......................... [RUN]
[0m16:11:56.153708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.stg_rates)
[0m16:11:56.154128 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:11:56.164944 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:11:56.166412 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:11:56.205536 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m16:11:56.206667 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m16:11:56.207399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:57.012028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:98455cb5-6a34-4abb-9bc7-160c72c23948&page=queryresults
[0m16:11:57.470277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127005330>]}
[0m16:11:57.471126 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dwh_dev_staging.stg_rates .................... [[32mCREATE VIEW (0 processed)[0m in 1.31s]
[0m16:11:57.472041 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:11:57.472652 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:11:57.473758 [info ] [Thread-1 (]: 2 of 12 START sql view model dwh_dev_staging.stg_transactions .................. [RUN]
[0m16:11:57.474543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:11:57.474942 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:11:57.478952 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:11:57.480256 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:11:57.484462 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m16:11:57.486963 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m16:11:57.488179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:58.156411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1451026f-7d8e-43f1-9e61-885bc88fb098&page=queryresults
[0m16:11:58.406064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12733f0a0>]}
[0m16:11:58.407494 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dwh_dev_staging.stg_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m16:11:58.408703 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:11:58.409512 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:11:58.410673 [info ] [Thread-1 (]: 3 of 12 START sql view model dwh_dev_staging.stg_users ......................... [RUN]
[0m16:11:58.411849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:11:58.412755 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:11:58.418346 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:11:58.419902 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:11:58.426643 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m16:11:58.429257 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m16:11:58.430144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:59.092615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f164781a-b741-40df-a358-123918701711&page=queryresults
[0m16:11:59.375124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127005330>]}
[0m16:11:59.376725 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dwh_dev_staging.stg_users .................... [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m16:11:59.378198 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:11:59.379085 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:11:59.380272 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh_dev_intermediate.int_rates_usdt .............. [RUN]
[0m16:11:59.381449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:11:59.382376 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:11:59.392373 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:11:59.394299 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:11:59.421154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:00.104723 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m16:12:00.105887 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m16:12:00.801396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7b1ff6aa-641d-4989-acdd-dbf3b6a7cc78&page=queryresults
[0m16:12:04.836700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277926e0>]}
[0m16:12:04.838336 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh_dev_intermediate.int_rates_usdt ......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.46s]
[0m16:12:04.839669 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:12:04.840562 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:12:04.841914 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh_dev_mart.dim_currencies ...................... [RUN]
[0m16:12:04.842956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.dim_currencies)
[0m16:12:04.843655 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:12:04.850350 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:12:04.851640 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:12:04.857822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:05.452661 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m16:12:05.455300 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m16:12:06.227725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4b152f28-1743-42f7-93d9-6cd8957bd90b&page=queryresults
[0m16:12:07.838176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271aa9e0>]}
[0m16:12:07.839753 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh_dev_mart.dim_currencies ................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.00s]
[0m16:12:07.841190 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:12:07.842157 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:12:07.843308 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh_dev_mart.dim_date ............................ [RUN]
[0m16:12:07.844383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:12:07.845156 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:12:07.853321 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:12:07.854712 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:12:07.858625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:08.480905 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m16:12:08.483850 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m16:12:09.198065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3eac226b-bbb3-4ec9-9382-04b0916c62ff&page=queryresults
[0m16:12:10.951007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379c340>]}
[0m16:12:10.952608 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh_dev_mart.dim_date ....................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.11s]
[0m16:12:10.953906 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:12:10.954844 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:12:10.955998 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh_dev_intermediate.int_users_scd2 .............. [RUN]
[0m16:12:10.957318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.int_users_scd2)
[0m16:12:10.958132 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:12:10.984360 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:12:10.986424 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:12:10.990509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:11.595226 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m16:12:11.596539 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m16:12:12.166468 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:382f0f51-c71c-4b06-ac0e-d2fe6aa3cc86&page=queryresults
[0m16:12:14.412635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f52f20>]}
[0m16:12:14.414374 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh_dev_intermediate.int_users_scd2 ......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.46s]
[0m16:12:14.415783 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:12:14.416717 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:12:14.417774 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh_dev_intermediate.int_transactions_with_rates . [RUN]
[0m16:12:14.419024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m16:12:14.419864 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:12:14.426991 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:12:14.428392 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:12:14.436414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:15.026816 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:12:15.029491 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

transaction_source_rates as (
    select
        t.*,
        r.usdt_price as source_usdt_price,
        r.price_timestamp as source_rate_timestamp,
        row_number() over (
            partition by t.txn_id 
            order by r.price_timestamp desc
        ) as rn_source
    from transactions t
    left join rates r
        on r.currency = t.source_currency
       and r.price_timestamp <= t.created_at
),

transaction_destination_rates as (
    select
        t.*,
        r.usdt_price as destination_usdt_price,
        r.price_timestamp as destination_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc
        ) as rn_dest
    from transactions t
    left join rates r
        on r.currency = t.destination_currency
       and r.price_timestamp <= t.created_at
)

select
    t.txn_id,
    t.user_id,
    t.source_amount,
    t.destination_amount,
    t.created_at,
    t.status,
    tsr.source_usdt_price,
    tsr.source_rate_timestamp,
    tdr.destination_usdt_price,
    tdr.destination_rate_timestamp,
    date(t.created_at) as date_created,
    t.source_amount * coalesce(tsr.source_usdt_price, 0) as source_amount_usd,
    t.destination_amount * coalesce(tdr.destination_usdt_price, 0) as destination_amount_usd
from transactions t
left join transaction_source_rates tsr
    on tsr.txn_id = t.txn_id
    and tsr.rn_source = 1 
left join transaction_destination_rates tdr
    on tdr.txn_id = t.txn_id
    and tdr.rn_dest = 1
    );
  
[0m16:12:15.853797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:75f91fd6-3353-4e45-8dfa-4253480f3c51&page=queryresults
[0m16:12:22.309911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379c340>]}
[0m16:12:22.311523 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (93.0 rows, 676.7 KiB processed)[0m in 7.89s]
[0m16:12:22.312892 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:12:22.313861 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:12:22.315453 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh_dev_mart.dim_users ........................... [RUN]
[0m16:12:22.316448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now model.de_test_dwh.dim_users)
[0m16:12:22.317170 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:12:22.323049 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:12:22.324314 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:12:22.328331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:22.939518 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m16:12:22.941293 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m16:12:23.328028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dd615833-26a0-4b3f-a3c8-6ffa00325848&page=queryresults
[0m16:12:25.763454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1277e20b0>]}
[0m16:12:25.765355 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh_dev_mart.dim_users ...................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 3.45s]
[0m16:12:25.766878 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:12:25.767878 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:12:25.769047 [info ] [Thread-1 (]: 10 of 12 START sql table model dwh_dev_mart.fct_transactions ................... [RUN]
[0m16:12:25.770028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:12:25.770869 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:12:25.777482 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:12:25.778805 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:12:25.783845 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m16:12:25.785156 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m16:12:25.785989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:26.606880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b1b450ee-821b-4aa2-b110-fdfd63b1e499&page=queryresults
[0m16:12:26.730985 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b1b450ee-821b-4aa2-b110-fdfd63b1e499&page=queryresults
[0m16:12:26.760102 [debug] [Thread-1 (]: Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name source_currency not found inside t at [31:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:12:26.761447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3212940-6d28-4996-91b5-103159d0a894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379c340>]}
[0m16:12:26.762661 [error] [Thread-1 (]: 10 of 12 ERROR creating sql table model dwh_dev_mart.fct_transactions .......... [[31mERROR[0m in 0.99s]
[0m16:12:26.763847 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:12:26.764907 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.fct_transactions' to be skipped because of status 'error'.  Reason: Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name source_currency not found inside t at [31:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql.
[0m16:12:26.767455 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:12:26.768544 [info ] [Thread-1 (]: 11 of 12 SKIP relation dwh_dev_mart.tb_transactions_by_kyc ..................... [[33mSKIP[0m]
[0m16:12:26.769765 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:12:26.770560 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:12:26.771363 [info ] [Thread-1 (]: 12 of 12 SKIP relation dwh_dev_mart.tb_transactions_tracking ................... [[33mSKIP[0m]
[0m16:12:26.772792 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:12:26.776590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:26.824420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:26.825231 [debug] [MainThread]: Connection 'model.de_test_dwh.fct_transactions' was properly closed.
[0m16:12:26.826218 [info ] [MainThread]: 
[0m16:12:26.826841 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 35.02 seconds (35.02s).
[0m16:12:26.829668 [debug] [MainThread]: Command end result
[0m16:12:26.871258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:12:26.874530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:12:26.884639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:12:26.885182 [info ] [MainThread]: 
[0m16:12:26.885791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:12:26.886324 [info ] [MainThread]: 
[0m16:12:26.886897 [error] [MainThread]: [31mFailure in model fct_transactions (models/finance/marts/fct_transactions.sql)[0m
[0m16:12:26.887436 [error] [MainThread]:   Database Error in model fct_transactions (models/finance/marts/fct_transactions.sql)
  Name source_currency not found inside t at [31:11]
  compiled code at target/run/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:12:26.888062 [info ] [MainThread]: 
[0m16:12:26.888824 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/fct_transactions.sql
[0m16:12:26.889356 [info ] [MainThread]: 
[0m16:12:26.889894 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=12
[0m16:12:26.892735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.321377, "process_in_blocks": "0", "process_kernel_time": 1.815985, "process_mem_max_rss": "362528768", "process_out_blocks": "0", "process_user_time": 10.364841}
[0m16:12:26.893537 [debug] [MainThread]: Command `dbt run` failed at 16:12:26.893404 after 42.32 seconds
[0m16:12:26.894052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e5030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271c59f0>]}
[0m16:12:26.894681 [debug] [MainThread]: Flushing usage events
[0m16:12:28.446259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:56.282436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101d6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111194d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111195240>]}


============================== 16:19:56.286840 | 23597700-c263-40a7-b8df-65d3de04dc30 ==============================
[0m16:19:56.286840 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:19:56.287647 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run --select finance.int_transactions_with_rates', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m16:20:00.092551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23597700-c263-40a7-b8df-65d3de04dc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e776ec0>]}
[0m16:20:00.190125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23597700-c263-40a7-b8df-65d3de04dc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111197370>]}
[0m16:20:00.190988 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:20:00.513640 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:20:01.064351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:01.065996 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/intermediate/int_transactions_with_rates.sql
[0m16:20:02.183524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23597700-c263-40a7-b8df-65d3de04dc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1332a91e0>]}
[0m16:20:02.407306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:20:02.410355 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:20:02.437511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23597700-c263-40a7-b8df-65d3de04dc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13302bb20>]}
[0m16:20:02.438260 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:20:02.438784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23597700-c263-40a7-b8df-65d3de04dc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13302bbe0>]}
[0m16:20:02.439639 [warn ] [MainThread]: The selection criterion 'finance.int_transactions_with_rates' does not match any enabled nodes
[0m16:20:02.441063 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:20:02.442070 [debug] [MainThread]: Command end result
[0m16:20:02.498303 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:20:02.502205 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:20:02.508379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:20:02.511279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.31839, "process_in_blocks": "0", "process_kernel_time": 1.143864, "process_mem_max_rss": "351092736", "process_out_blocks": "0", "process_user_time": 6.657036}
[0m16:20:02.512264 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:02.512100 after 6.32 seconds
[0m16:20:02.513080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101d6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111197370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13302cf10>]}
[0m16:20:02.513632 [debug] [MainThread]: Flushing usage events
[0m16:20:03.993862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:05.894362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e86500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e80d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e81240>]}


============================== 16:21:05.903171 | 586b8ecb-01a6-4189-b868-a67f4193fdc6 ==============================
[0m16:21:05.903171 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:21:05.904238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'partial_parse': 'True', 'invocation_command': 'dbt run --select finance', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True'}
[0m16:21:12.585537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358aa530>]}
[0m16:21:12.665707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113023e80>]}
[0m16:21:12.666620 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:21:13.004691 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:21:13.476220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:13.476924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:13.548971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e9e770>]}
[0m16:21:13.685213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:21:13.690320 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:21:13.739427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e31000>]}
[0m16:21:13.740860 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:21:13.741753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e300d0>]}
[0m16:21:13.744684 [info ] [MainThread]: 
[0m16:21:13.745498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:13.746088 [info ] [MainThread]: 
[0m16:21:13.747036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:21:13.756681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:21:13.757876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:14.810647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:15.703409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:16.440309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m16:21:16.441527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:17.099086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:21:17.104079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:17.770232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:21:17.789760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:18.437142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135ea3310>]}
[0m16:21:18.438003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:18.491451 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:21:18.492222 [info ] [Thread-1 (]: 1 of 12 START sql view model dwh_dev_staging.stg_rates ......................... [RUN]
[0m16:21:18.492949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.stg_rates)
[0m16:21:18.493551 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:21:18.508758 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:21:18.510316 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:21:18.552390 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m16:21:18.553710 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m16:21:18.554513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:19.408319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3db336b7-c35e-4769-a4c0-21309626b672&page=queryresults
[0m16:21:19.819954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1328c8280>]}
[0m16:21:19.821436 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dwh_dev_staging.stg_rates .................... [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m16:21:19.822412 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:21:19.823093 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:21:19.824087 [info ] [Thread-1 (]: 2 of 12 START sql view model dwh_dev_staging.stg_transactions .................. [RUN]
[0m16:21:19.824943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:21:19.825630 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:21:19.830431 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:21:19.831497 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:21:19.838817 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m16:21:19.840501 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m16:21:19.841158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:20.634036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dbd68750-ff43-416c-8247-fec184930713&page=queryresults
[0m16:21:20.995697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e9f070>]}
[0m16:21:20.997651 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dwh_dev_staging.stg_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m16:21:20.999364 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:21:21.000496 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:21:21.002155 [info ] [Thread-1 (]: 3 of 12 START sql view model dwh_dev_staging.stg_users ......................... [RUN]
[0m16:21:21.003341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:21:21.004272 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:21:21.011275 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:21:21.012761 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:21:21.020562 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m16:21:21.022122 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m16:21:21.023523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:21.771089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:aee21f33-c639-45d9-92ed-df75ad881e8b&page=queryresults
[0m16:21:22.101201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135e9f070>]}
[0m16:21:22.102804 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dwh_dev_staging.stg_users .................... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m16:21:22.104197 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:21:22.105118 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:21:22.106092 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh_dev_intermediate.int_rates_usdt .............. [RUN]
[0m16:21:22.107277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:21:22.108136 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:21:22.114808 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:21:22.116508 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:21:22.147049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:22.874120 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m16:21:22.875405 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m16:21:23.811274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ea425e56-9573-48b1-80d3-5fb569002565&page=queryresults
[0m16:21:27.805168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135eb6170>]}
[0m16:21:27.806794 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh_dev_intermediate.int_rates_usdt ......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.70s]
[0m16:21:27.808213 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:21:27.809192 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:21:27.810574 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh_dev_mart.dim_currencies ...................... [RUN]
[0m16:21:27.811628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.dim_currencies)
[0m16:21:27.812400 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:21:27.821571 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:21:27.824157 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:21:27.829452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:28.424974 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m16:21:28.427687 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m16:21:29.096357 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ae21f5f0-e32d-4a84-95ae-850a88d70a7a&page=queryresults
[0m16:21:31.400810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ee830>]}
[0m16:21:31.402406 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh_dev_mart.dim_currencies ................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.59s]
[0m16:21:31.403835 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:21:31.404797 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:21:31.405943 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh_dev_mart.dim_date ............................ [RUN]
[0m16:21:31.407002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:21:31.407753 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:21:31.414168 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:21:31.415408 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:21:31.421104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:32.053067 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m16:21:32.056824 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m16:21:32.689577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7eb80b4c-9c28-413c-b5ae-2bac941c853d&page=queryresults
[0m16:21:34.356299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ee830>]}
[0m16:21:34.359556 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh_dev_mart.dim_date ....................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 2.95s]
[0m16:21:34.362754 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:21:34.364797 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:21:34.366655 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh_dev_intermediate.int_users_scd2 .............. [RUN]
[0m16:21:34.368881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.int_users_scd2)
[0m16:21:34.370474 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:21:34.407272 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:21:34.408338 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:21:34.411562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:35.484277 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m16:21:35.485933 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m16:21:36.057300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a32567be-c24e-4731-87fb-0f6b34c9d502&page=queryresults
[0m16:21:38.373253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363849d0>]}
[0m16:21:38.374947 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh_dev_intermediate.int_users_scd2 ......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 4.00s]
[0m16:21:38.376396 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:21:38.377367 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:21:38.378741 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh_dev_intermediate.int_transactions_with_rates . [RUN]
[0m16:21:38.379931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m16:21:38.380715 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:21:38.390766 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:21:38.393556 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:21:38.398729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:38.993812 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:21:38.998615 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_source_rate as (
    select
        t.txn_id,
        r.usdt_price as source_usdt_price,
        r.price_timestamp as source_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc 
        ) as rn_source
    from transactions t
    left join rates r
        on r.currency = t.source_currency
        and r.price_timestamp <= t.created_at
),
latest_dest_rate as (
    select
        t.txn_id,
        r.usdt_price as destination_usdt_price,
        r.price_timestamp as destination_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc 
        ) as rn_dest
    from transactions t
    left join rates r
        on r.currency = t.destination_currency
        and r.price_timestamp <= t.created_at
),

transactions_with_rates as (
    select
        t.*,
        lsr.source_usdt_price,
        lsr.source_rate_timestamp,
        ldr.destination_usdt_price,
        ldr.destination_rate_timestamp
    from transactions t
    left join latest_source_rate lsr
        on lsr.txn_id = t.txn_id
        and lsr.rn_source = 1
    left join latest_dest_rate ldr
        on ldr.txn_id = t.txn_id
        and ldr.rn_dest = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m16:21:39.889130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:56a36ba9-e29c-4038-8b6a-e4270d806771&page=queryresults
[0m16:21:45.255760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136387730>]}
[0m16:21:45.257333 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (93.0 rows, 676.7 KiB processed)[0m in 6.88s]
[0m16:21:45.258724 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:21:45.259668 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:21:45.260883 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh_dev_mart.dim_users ........................... [RUN]
[0m16:21:45.261877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now model.de_test_dwh.dim_users)
[0m16:21:45.262662 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:21:45.270168 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:21:45.273943 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:21:45.281000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:45.876563 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m16:21:45.878741 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m16:21:46.237190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0fefc198-c263-4ce5-934f-4afa3dd2d500&page=queryresults
[0m16:21:47.960631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125ee830>]}
[0m16:21:47.963555 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh_dev_mart.dim_users ...................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.70s]
[0m16:21:47.965172 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:21:47.966150 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:21:47.967330 [info ] [Thread-1 (]: 10 of 12 START sql table model dwh_dev_mart.fct_transactions ................... [RUN]
[0m16:21:47.968318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:21:47.969077 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:21:47.977755 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:21:47.980062 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:21:47.985829 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m16:21:47.987307 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m16:21:47.988120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:48.798019 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ddc58305-5421-4ef0-b010-a860b759a36d&page=queryresults
[0m16:21:52.200735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363cd4e0>]}
[0m16:21:52.202680 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dwh_dev_mart.fct_transactions .............. [[32mCREATE TABLE (93.0 rows, 24.5 KiB processed)[0m in 4.23s]
[0m16:21:52.204340 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:21:52.207685 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:21:52.209106 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh_dev_mart.tb_transactions_by_kyc ............. [RUN]
[0m16:21:52.210623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_transactions_by_kyc)
[0m16:21:52.212204 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m16:21:52.223829 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:21:52.226763 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m16:21:52.235231 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:21:52.236662 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
    );
  
[0m16:21:52.237792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:53.096542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:eb152373-8939-44ff-af85-44642adfd1c9&page=queryresults
[0m16:21:54.716948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13654bf70>]}
[0m16:21:54.718684 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh_dev_mart.tb_transactions_by_kyc ........ [[32mCREATE TABLE (4.0 rows, 3.9 KiB processed)[0m in 2.51s]
[0m16:21:54.720089 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:21:54.721041 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:21:54.722276 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh_dev_mart.tb_transactions_tracking ........... [RUN]
[0m16:21:54.723439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m16:21:54.724275 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:21:54.736081 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:21:54.737638 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:21:54.743740 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:21:54.745157 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL  ---> chỉnh lại config best practice , bỏ sort
    );
  
[0m16:21:54.746216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:55.555413 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a03ce844-8fd6-4128-9fc1-03ab6aa310a4&page=queryresults
[0m16:21:55.676396 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a03ce844-8fd6-4128-9fc1-03ab6aa310a4&page=queryresults
[0m16:21:55.714084 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:21:55.715121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586b8ecb-01a6-4189-b868-a67f4193fdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f051e0>]}
[0m16:21:55.716122 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model dwh_dev_mart.tb_transactions_tracking .. [[31mERROR[0m in 0.99s]
[0m16:21:55.717024 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:21:55.717879 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql.
[0m16:21:55.720453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:55.766325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:55.767118 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:21:55.767920 [info ] [MainThread]: 
[0m16:21:55.768404 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 42.02 seconds (42.02s).
[0m16:21:55.771747 [debug] [MainThread]: Command end result
[0m16:21:55.817624 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:21:55.820963 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:21:55.830883 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:21:55.831486 [info ] [MainThread]: 
[0m16:21:55.832128 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:21:55.832704 [info ] [MainThread]: 
[0m16:21:55.833323 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)[0m
[0m16:21:55.833920 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:21:55.834453 [info ] [MainThread]: 
[0m16:21:55.834992 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:21:55.835492 [info ] [MainThread]: 
[0m16:21:55.836199 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m16:21:55.841089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 50.05283, "process_in_blocks": "0", "process_kernel_time": 2.123559, "process_mem_max_rss": "360697856", "process_out_blocks": "0", "process_user_time": 11.073776}
[0m16:21:55.842219 [debug] [MainThread]: Command `dbt run` failed at 16:21:55.841881 after 50.05 seconds
[0m16:21:55.843121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e86500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1358aa530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113004100>]}
[0m16:21:55.843729 [debug] [MainThread]: Flushing usage events
[0m16:21:57.397745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:47.589092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106191270>]}


============================== 16:23:47.596571 | c62760a9-85e5-42e5-a0cb-497dbbbc1fd8 ==============================
[0m16:23:47.596571 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:23:47.597445 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select finance', 'write_json': 'True'}
[0m16:23:53.009234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a823b0>]}
[0m16:23:53.079877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc5900>]}
[0m16:23:53.080740 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:23:53.406170 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:23:53.811984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:53.812586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:53.875837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128096770>]}
[0m16:23:53.996040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:23:53.998246 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:23:54.051358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128028f10>]}
[0m16:23:54.052482 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:23:54.053228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12802bee0>]}
[0m16:23:54.056386 [info ] [MainThread]: 
[0m16:23:54.057078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:54.057812 [info ] [MainThread]: 
[0m16:23:54.059278 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:23:54.068666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:23:54.069630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:54.856777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:55.606796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:56.396922 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m16:23:56.397637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:57.044130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m16:23:57.045723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:57.622544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m16:23:57.625232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:58.325633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382bbb0>]}
[0m16:23:58.327073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:58.382139 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:23:58.382888 [info ] [Thread-1 (]: 1 of 12 START sql view model dwh_dev_staging.stg_rates ......................... [RUN]
[0m16:23:58.383591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now model.de_test_dwh.stg_rates)
[0m16:23:58.384014 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:23:58.398172 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:23:58.400330 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:23:58.439383 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m16:23:58.440866 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m16:23:58.441528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:23:59.121732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:c1200190-decb-40cb-ad53-fac83ca3e95c&page=queryresults
[0m16:23:59.499929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124abc820>]}
[0m16:23:59.500874 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dwh_dev_staging.stg_rates .................... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m16:23:59.501774 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:23:59.502293 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:23:59.503029 [info ] [Thread-1 (]: 2 of 12 START sql view model dwh_dev_staging.stg_transactions .................. [RUN]
[0m16:23:59.503831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:23:59.504390 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:23:59.508744 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:23:59.509908 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:23:59.517953 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m16:23:59.519576 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m16:23:59.521341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:00.286780 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1bb58a98-6994-409f-b8b8-40d7558a4375&page=queryresults
[0m16:24:00.548832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12858bca0>]}
[0m16:24:00.550405 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dwh_dev_staging.stg_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m16:24:00.551725 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:24:00.552837 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:24:00.554051 [info ] [Thread-1 (]: 3 of 12 START sql view model dwh_dev_staging.stg_users ......................... [RUN]
[0m16:24:00.555188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:24:00.556007 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:24:00.562382 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:24:00.565616 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:24:00.572286 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m16:24:00.574350 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m16:24:00.576071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:01.308627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8af1e6e2-53a9-4bc7-b50c-868740428190&page=queryresults
[0m16:24:01.583011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12858bca0>]}
[0m16:24:01.584932 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dwh_dev_staging.stg_users .................... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m16:24:01.586862 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:24:01.588085 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:24:01.589462 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh_dev_intermediate.int_rates_usdt .............. [RUN]
[0m16:24:01.590656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:24:01.591567 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:24:01.599300 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:24:01.602289 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:24:01.629064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:02.287040 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m16:24:02.288309 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m16:24:02.944999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:622686b0-1737-408d-a481-13c56c7333b3&page=queryresults
[0m16:24:07.276610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128099990>]}
[0m16:24:07.278237 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh_dev_intermediate.int_rates_usdt ......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.69s]
[0m16:24:07.279585 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:24:07.280502 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:24:07.281932 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh_dev_mart.dim_currencies ...................... [RUN]
[0m16:24:07.282973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.dim_currencies)
[0m16:24:07.283715 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:24:07.291270 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:24:07.294369 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:24:07.298663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:07.934973 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m16:24:07.937606 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m16:24:08.781111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:919867a4-9361-4641-a089-33cd43054527&page=queryresults
[0m16:24:10.429643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938340>]}
[0m16:24:10.430973 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh_dev_mart.dim_currencies ................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.15s]
[0m16:24:10.432297 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:24:10.433006 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:24:10.434026 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh_dev_mart.dim_date ............................ [RUN]
[0m16:24:10.434916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:24:10.435672 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:24:10.442347 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:24:10.443982 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:24:10.449087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:11.086179 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m16:24:11.088774 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m16:24:12.161811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fb3218d8-f841-4d58-b2d8-710490650c24&page=queryresults
[0m16:24:13.956361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938340>]}
[0m16:24:13.957934 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh_dev_mart.dim_date ....................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.52s]
[0m16:24:13.959326 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:24:13.960260 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:24:13.961635 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh_dev_intermediate.int_users_scd2 .............. [RUN]
[0m16:24:13.962687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.int_users_scd2)
[0m16:24:13.963434 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:24:13.991328 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:24:13.992483 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:24:13.996305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:14.621814 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m16:24:14.624393 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m16:24:15.234070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e2368530-fc34-434c-9a6f-ae5ffc1ff242&page=queryresults
[0m16:24:16.874623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104938340>]}
[0m16:24:16.876227 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh_dev_intermediate.int_users_scd2 ......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 2.91s]
[0m16:24:16.877590 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:24:16.878531 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:24:16.879948 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh_dev_intermediate.int_transactions_with_rates . [RUN]
[0m16:24:16.881075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m16:24:16.881852 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:24:16.888620 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:24:16.890009 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:24:16.894637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:17.524760 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:24:17.527542 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_source_rate as (
    select
        t.txn_id,
        r.usdt_price as source_usdt_price,
        r.price_timestamp as source_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc 
        ) as rn_source
    from transactions t
    left join rates r
        on r.currency = t.source_currency
        and r.price_timestamp <= t.created_at
),
latest_dest_rate as (
    select
        t.txn_id,
        r.usdt_price as destination_usdt_price,
        r.price_timestamp as destination_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc 
        ) as rn_dest
    from transactions t
    left join rates r
        on r.currency = t.destination_currency
        and r.price_timestamp <= t.created_at
),

transactions_with_rates as (
    select
        t.*,
        lsr.source_usdt_price,
        lsr.source_rate_timestamp,
        ldr.destination_usdt_price,
        ldr.destination_rate_timestamp
    from transactions t
    left join latest_source_rate lsr
        on lsr.txn_id = t.txn_id
        and lsr.rn_source = 1
    left join latest_dest_rate ldr
        on ldr.txn_id = t.txn_id
        and ldr.rn_dest = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m16:24:18.272753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b114cb85-38af-4956-84ee-6eb6e9ee11d8&page=queryresults
[0m16:24:22.621538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12857df30>]}
[0m16:24:22.623119 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (93.0 rows, 676.7 KiB processed)[0m in 5.74s]
[0m16:24:22.624464 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:24:22.625466 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:24:22.626789 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh_dev_mart.dim_users ........................... [RUN]
[0m16:24:22.627888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now model.de_test_dwh.dim_users)
[0m16:24:22.628661 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:24:22.635647 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:24:22.639000 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:24:22.645254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:23.244868 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m16:24:23.248108 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m16:24:23.630375 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2586655f-a100-4978-97cc-aeae150a717f&page=queryresults
[0m16:24:25.290073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128687d60>]}
[0m16:24:25.291680 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh_dev_mart.dim_users ...................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.66s]
[0m16:24:25.293079 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:24:25.294032 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:24:25.295243 [info ] [Thread-1 (]: 10 of 12 START sql table model dwh_dev_mart.fct_transactions ................... [RUN]
[0m16:24:25.296351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:24:25.297099 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:24:25.305061 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:24:25.307141 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:24:25.312128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:25.910933 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m16:24:25.913551 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m16:24:26.258365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:31a57789-8e2c-4550-9fd1-c7e4e4b05c19&page=queryresults
[0m16:24:28.441944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1286828c0>]}
[0m16:24:28.443538 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dwh_dev_mart.fct_transactions .............. [[32mCREATE TABLE (93.0 rows, 24.5 KiB processed)[0m in 3.15s]
[0m16:24:28.444892 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:24:28.446349 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:24:28.447780 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh_dev_mart.tb_transactions_by_kyc ............. [RUN]
[0m16:24:28.448931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_transactions_by_kyc)
[0m16:24:28.449848 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m16:24:28.460430 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:24:28.461783 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m16:24:28.466288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:29.024359 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:24:29.028734 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
    );
  
[0m16:24:29.355686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:37d8632b-aef4-4587-bd0d-0cfb60703165&page=queryresults
[0m16:24:31.175802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12873feb0>]}
[0m16:24:31.177444 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh_dev_mart.tb_transactions_by_kyc ........ [[32mCREATE TABLE (4.0 rows, 3.9 KiB processed)[0m in 2.73s]
[0m16:24:31.178892 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:24:31.179849 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:24:31.181054 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh_dev_mart.tb_transactions_tracking ........... [RUN]
[0m16:24:31.182129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m16:24:31.182941 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:24:31.192899 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:24:31.194372 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:24:31.199450 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:24:31.201486 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL  ---> chỉnh lại config best practice , bỏ sort
    );
  
[0m16:24:31.202643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:32.028025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cf81833d-07be-4755-97fc-ecc2c6290a83&page=queryresults
[0m16:24:32.158155 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cf81833d-07be-4755-97fc-ecc2c6290a83&page=queryresults
[0m16:24:32.176793 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:24:32.178477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62760a9-85e5-42e5-a0cb-497dbbbc1fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280998a0>]}
[0m16:24:32.179917 [error] [Thread-1 (]: 12 of 12 ERROR creating sql table model dwh_dev_mart.tb_transactions_tracking .. [[31mERROR[0m in 1.00s]
[0m16:24:32.181072 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:24:32.182177 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql.
[0m16:24:32.185922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:32.233146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:32.233775 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:24:32.234340 [info ] [MainThread]: 
[0m16:24:32.234836 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 38.18 seconds (38.18s).
[0m16:24:32.237696 [debug] [MainThread]: Command end result
[0m16:24:32.280338 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:24:32.283087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:24:32.291561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:24:32.292460 [info ] [MainThread]: 
[0m16:24:32.293224 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:24:32.293794 [info ] [MainThread]: 
[0m16:24:32.294410 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)[0m
[0m16:24:32.295034 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:24:32.295550 [info ] [MainThread]: 
[0m16:24:32.296138 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:24:32.296667 [info ] [MainThread]: 
[0m16:24:32.297230 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m16:24:32.299717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 44.803535, "process_in_blocks": "0", "process_kernel_time": 1.812139, "process_mem_max_rss": "358977536", "process_out_blocks": "0", "process_user_time": 10.750031}
[0m16:24:32.301128 [debug] [MainThread]: Command `dbt run` failed at 16:24:32.300443 after 44.80 seconds
[0m16:24:32.302662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a823b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105351300>]}
[0m16:24:32.303582 [debug] [MainThread]: Flushing usage events
[0m16:24:33.869448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:56.632625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3f1480>]}


============================== 16:25:56.639428 | f8aecd92-6a5e-49f6-8383-718724b1311e ==============================
[0m16:25:56.639428 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:25:56.640343 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select finance.marts.tb_transactions_tracking', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:26:03.641280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53d330>]}
[0m16:26:03.718636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc6fb20>]}
[0m16:26:03.719565 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:26:04.058347 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:26:04.512040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:04.512821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:04.579549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302a27d0>]}
[0m16:26:04.702038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:26:04.708443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:26:04.764082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1302314e0>]}
[0m16:26:04.765130 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:26:04.765866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130230790>]}
[0m16:26:04.768578 [info ] [MainThread]: 
[0m16:26:04.769262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:04.769804 [info ] [MainThread]: 
[0m16:26:04.770783 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:04.772344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:26:04.773477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:05.620206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m16:26:05.621349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:06.227351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:26:06.229697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:06.824387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:26:06.827104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:07.527157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc0a0e0>]}
[0m16:26:07.527799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:07.574098 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:26:07.574865 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_mart.tb_transactions_tracking ............. [RUN]
[0m16:26:07.575632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.tb_transactions_tracking)
[0m16:26:07.576132 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:26:07.597244 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:26:07.598689 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:26:07.659190 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:26:07.660665 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL  ---> chỉnh lại config best practice , bỏ sort
    );
  
[0m16:26:07.661527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:08.592706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:03c8504e-5ef1-4b6a-a24a-b17aa3b0dee8&page=queryresults
[0m16:26:08.721178 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:03c8504e-5ef1-4b6a-a24a-b17aa3b0dee8&page=queryresults
[0m16:26:08.741041 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:08.744553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8aecd92-6a5e-49f6-8383-718724b1311e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb9add0>]}
[0m16:26:08.746197 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_mart.tb_transactions_tracking .... [[31mERROR[0m in 1.17s]
[0m16:26:08.747351 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:26:08.748237 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql.
[0m16:26:08.751290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:08.803856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:08.804485 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:26:08.804954 [info ] [MainThread]: 
[0m16:26:08.805652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m16:26:08.806823 [debug] [MainThread]: Command end result
[0m16:26:08.851064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:26:08.853270 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:26:08.863022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:26:08.864094 [info ] [MainThread]: 
[0m16:26:08.864842 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:08.865371 [info ] [MainThread]: 
[0m16:26:08.865951 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)[0m
[0m16:26:08.866535 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:08.866918 [info ] [MainThread]: 
[0m16:26:08.868159 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:08.868985 [info ] [MainThread]: 
[0m16:26:08.869577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:26:08.873033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.346395, "process_in_blocks": "0", "process_kernel_time": 1.965931, "process_mem_max_rss": "351772672", "process_out_blocks": "0", "process_user_time": 8.152347}
[0m16:26:08.873808 [debug] [MainThread]: Command `dbt run` failed at 16:26:08.873650 after 12.35 seconds
[0m16:26:08.874343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3f2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d570100>]}
[0m16:26:08.874815 [debug] [MainThread]: Flushing usage events
[0m16:26:10.230175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:49.774136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103faa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104facdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fad270>]}


============================== 16:26:49.782137 | 60442573-f00e-44dd-90ec-b658638395f3 ==============================
[0m16:26:49.782137 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:26:49.783023 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'log_format': 'default', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_colors': 'True', 'write_json': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select finance.marts.tb_transactions_tracking', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m16:26:53.468063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123898820>]}
[0m16:26:53.540591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd1900>]}
[0m16:26:53.541442 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:26:53.825780 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:26:54.150792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:54.151382 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:54.212545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126eb2800>]}
[0m16:26:54.327130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:26:54.329652 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:26:54.345167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e405b0>]}
[0m16:26:54.345968 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:26:54.346536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126e404c0>]}
[0m16:26:54.348522 [info ] [MainThread]: 
[0m16:26:54.349167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:54.349645 [info ] [MainThread]: 
[0m16:26:54.350648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:54.352214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:26:54.352846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:55.205764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_staging)
[0m16:26:55.206810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:55.820058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m16:26:55.823059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:56.412864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:26:56.415923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:57.019495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103199480>]}
[0m16:26:57.020659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:57.071668 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:26:57.072356 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_mart.tb_transactions_tracking ............. [RUN]
[0m16:26:57.073276 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.de_test_dwh.tb_transactions_tracking'
[0m16:26:57.073693 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:26:57.089479 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:26:57.091146 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:26:57.152567 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:26:57.153815 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL  ---> chỉnh lại config best practice , bỏ sort
    );
  
[0m16:26:57.154516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:57.873820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7f2be3a6-d09e-4672-a830-5565a6d1dad2&page=queryresults
[0m16:26:58.032816 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7f2be3a6-d09e-4672-a830-5565a6d1dad2&page=queryresults
[0m16:26:58.049302 [debug] [Thread-1 (]: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:58.055925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60442573-f00e-44dd-90ec-b658638395f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126eb0cd0>]}
[0m16:26:58.057458 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dwh_dev_mart.tb_transactions_tracking .... [[31mERROR[0m in 0.98s]
[0m16:26:58.058856 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:26:58.059760 [debug] [Thread-4 (]: Marking all children of 'model.de_test_dwh.tb_transactions_tracking' to be skipped because of status 'error'.  Reason: Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql.
[0m16:26:58.062404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:58.110701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:58.111268 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_intermediate' was properly closed.
[0m16:26:58.111698 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:26:58.112311 [info ] [MainThread]: 
[0m16:26:58.112972 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m16:26:58.113923 [debug] [MainThread]: Command end result
[0m16:26:58.154225 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:26:58.157067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:26:58.164806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:26:58.165337 [info ] [MainThread]: 
[0m16:26:58.166095 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:58.167038 [info ] [MainThread]: 
[0m16:26:58.167716 [error] [MainThread]: [31mFailure in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)[0m
[0m16:26:58.168330 [error] [MainThread]:   Database Error in model tb_transactions_tracking (models/finance/marts/tb_transactions_tracking.sql)
  Unrecognized name: transaction_date at [8:18]
  compiled code at target/run/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:58.168784 [info ] [MainThread]: 
[0m16:26:58.169308 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/tb_transactions_tracking.sql
[0m16:26:58.169978 [info ] [MainThread]: 
[0m16:26:58.170528 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:26:58.173143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.519116, "process_in_blocks": "0", "process_kernel_time": 1.239096, "process_mem_max_rss": "352624640", "process_out_blocks": "0", "process_user_time": 6.989525}
[0m16:26:58.174002 [debug] [MainThread]: Command `dbt run` failed at 16:26:58.173846 after 8.52 seconds
[0m16:26:58.174594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103faa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123898820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268a7790>]}
[0m16:26:58.175318 [debug] [MainThread]: Flushing usage events
[0m16:26:59.500832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:36.657889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea78dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea79270>]}


============================== 16:27:36.662747 | 1b864f10-e033-4264-b423-35e4b5529d9a ==============================
[0m16:27:36.662747 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:27:36.663565 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run --select finance.marts.tb_transactions_tracking', 'log_format': 'default', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test'}
[0m16:27:39.464761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303ef280>]}
[0m16:27:39.545346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1303efca0>]}
[0m16:27:39.546402 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:27:39.838570 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:27:40.185698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:27:40.186608 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/tb_transactions_tracking.sql
[0m16:27:40.592194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cb9180>]}
[0m16:27:40.722860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:27:40.725414 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:27:40.741213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a3a770>]}
[0m16:27:40.741954 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:27:40.742558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130a39ba0>]}
[0m16:27:40.744391 [info ] [MainThread]: 
[0m16:27:40.745029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:40.745543 [info ] [MainThread]: 
[0m16:27:40.746199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:27:40.747391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:27:40.747938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:41.570379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_mart)
[0m16:27:41.571187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:42.137165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:27:42.140396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:42.780867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:27:42.783389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:43.406072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc6d480>]}
[0m16:27:43.407093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:43.456169 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:27:43.456839 [info ] [Thread-1 (]: 1 of 1 START sql table model dwh_dev_mart.tb_transactions_tracking ............. [RUN]
[0m16:27:43.457569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now model.de_test_dwh.tb_transactions_tracking)
[0m16:27:43.458011 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:27:43.471884 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:27:43.473291 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:27:43.524418 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:27:43.563061 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
    );
  
[0m16:27:43.584850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:44.379055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:5df5cd09-224e-4fc6-9bd8-bf8c5821c60f&page=queryresults
[0m16:27:46.575935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b864f10-e033-4264-b423-35e4b5529d9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d4cc850>]}
[0m16:27:46.576960 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dwh_dev_mart.tb_transactions_tracking ........ [[32mCREATE TABLE (58.0 rows, 3.9 KiB processed)[0m in 3.12s]
[0m16:27:46.577832 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:27:46.579628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:46.625131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:46.625718 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:27:46.626185 [info ] [MainThread]: 
[0m16:27:46.626654 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m16:27:46.627765 [debug] [MainThread]: Command end result
[0m16:27:46.669491 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:27:46.671763 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:27:46.679206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:27:46.679874 [info ] [MainThread]: 
[0m16:27:46.680513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:46.681190 [info ] [MainThread]: 
[0m16:27:46.681781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:27:46.684884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.108896, "process_in_blocks": "0", "process_kernel_time": 0.987909, "process_mem_max_rss": "360550400", "process_out_blocks": "0", "process_user_time": 6.650975}
[0m16:27:46.685641 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:46.685499 after 10.11 seconds
[0m16:27:46.686286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da7e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c05ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbfdc60>]}
[0m16:27:46.687236 [debug] [MainThread]: Flushing usage events
[0m16:27:47.820532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:29.764295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105748fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105749480>]}


============================== 16:34:29.771483 | 39bfca7c-bf5a-4738-8e41-8c6087236d5a ==============================
[0m16:34:29.771483 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:34:29.772338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select finance', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'debug': 'False', 'log_cache_events': 'False'}
[0m16:34:36.151510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1241ca3b0>]}
[0m16:34:36.226094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556d900>]}
[0m16:34:36.226976 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:34:36.546328 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:34:36.991680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:36.992627 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/intermediate/int_transactions_with_rates.sql
[0m16:34:37.329292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279cd150>]}
[0m16:34:37.458940 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:34:37.463712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:34:37.508082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12776e7d0>]}
[0m16:34:37.508816 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:34:37.509311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12776dc60>]}
[0m16:34:37.511435 [info ] [MainThread]: 
[0m16:34:37.512074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:37.512584 [info ] [MainThread]: 
[0m16:34:37.513277 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:37.520537 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203'
[0m16:34:37.522780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:38.427534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:39.145010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:39.864580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203, now list_cusma-383203_dwh_dev_intermediate)
[0m16:34:39.865739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:40.503540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:34:40.504698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:41.138948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m16:34:41.141416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:41.808003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10392f7c0>]}
[0m16:34:41.809180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:41.858841 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:34:41.859581 [info ] [Thread-1 (]: 1 of 12 START sql view model dwh_dev_staging.stg_rates ......................... [RUN]
[0m16:34:41.860300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.stg_rates)
[0m16:34:41.860749 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:34:41.873360 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:34:41.875016 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:34:41.912498 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_rates"
[0m16:34:41.913797 [debug] [Thread-1 (]: On model.de_test_dwh.stg_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_rates"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_rates`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`rates`
),

renamed as (
    select
        cast(symbol as string) as symbol,
        cast(open_time as int64) as open_time,
        cast(close as float64) as close_price,
        cast(open as float64) as open_price,
        cast(high as float64) as high_price,
        cast(low as float64) as low_price,
        cast(volume as float64) as volume,
        cast(close_time as int64) as close_time,
        cast(quote_volume as float64) as quote_volume,
        cast(trades as int64) as trades,
        timestamp_millis(cast(open_time as int64)) as price_timestamp,
        timestamp_millis(cast(close_time as int64)) as close_timestamp
    from source
)

select * from renamed;


[0m16:34:41.914413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:42.673404 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1da5ed8c-8349-46bf-9f37-f6c0fe7f581b&page=queryresults
[0m16:34:43.086219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124204280>]}
[0m16:34:43.087146 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dwh_dev_staging.stg_rates .................... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m16:34:43.087989 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:34:43.088468 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:34:43.088964 [info ] [Thread-1 (]: 2 of 12 START sql view model dwh_dev_staging.stg_transactions .................. [RUN]
[0m16:34:43.089975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:34:43.090466 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:34:43.094084 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:34:43.095334 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:34:43.099982 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_transactions"
[0m16:34:43.100997 [debug] [Thread-1 (]: On model.de_test_dwh.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_transactions"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`transaction`
),

renamed as (
    select
        cast(txn_id as int64) as txn_id,
        cast(user_id as int64) as user_id,
        cast(status as string) as status,
        cast(source_currency as string) as source_currency,
        cast(destination_currency as string) as destination_currency,
        cast(created_at as timestamp) as created_at,
        cast(source_amount as float64) as source_amount,
        cast(destination_amount as float64) as destination_amount
    from source
)

select * from renamed;


[0m16:34:43.102432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:43.846888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ed5fd49e-5a52-4fab-9651-dd78655e73b8&page=queryresults
[0m16:34:44.133865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b18d30>]}
[0m16:34:44.135451 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dwh_dev_staging.stg_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m16:34:44.136928 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:34:44.137882 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:34:44.138990 [info ] [Thread-1 (]: 3 of 12 START sql view model dwh_dev_staging.stg_users ......................... [RUN]
[0m16:34:44.139967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:34:44.140732 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:34:44.146840 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:34:44.149167 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:34:44.157235 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.stg_users"
[0m16:34:44.158702 [debug] [Thread-1 (]: On model.de_test_dwh.stg_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.stg_users"} */


  create or replace view `cusma-383203`.`dwh_dev_staging`.`stg_users`
  OPTIONS()
  as 

with source as (
    select * from `cusma-383203`.`raw_data`.`users`
),

renamed as (
    select
        cast(user_id as int64) as user_id,
        cast(kyc_level as int64) as kyc_level,
        cast(created_at as timestamp) as created_at,
        cast(updated_at as timestamp) as updated_at
    from source
)

select * from renamed;


[0m16:34:44.159439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:44.864952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:72f4b2df-5cc2-4b8c-9b52-bfdb5f70d8e1&page=queryresults
[0m16:34:45.157233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279cd870>]}
[0m16:34:45.158788 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dwh_dev_staging.stg_users .................... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m16:34:45.160237 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:34:45.161220 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:34:45.162489 [info ] [Thread-1 (]: 4 of 12 START sql table model dwh_dev_intermediate.int_rates_usdt .............. [RUN]
[0m16:34:45.163562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:34:45.164488 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:34:45.173349 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:34:45.175532 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:34:45.202250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:45.899643 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_rates_usdt"
[0m16:34:45.901014 [debug] [Thread-1 (]: On model.de_test_dwh.int_rates_usdt: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_rates_usdt"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
      
    partition by price_date
    cluster by symbol

    
    OPTIONS()
    as (
      


with rates as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
),

parsed_rates as (
    select
        symbol,
        regexp_extract(symbol, r'^(.+)USDT$') as currency,
        close_price as usdt_price,
        price_timestamp,
        close_timestamp, 
        DATE(price_timestamp) as price_date
    from rates
    where symbol like '%USDT'
)
    select
        currency,
        usdt_price,
        price_timestamp,
        close_timestamp,
        symbol,
        price_date

    from parsed_rates
    where currency is not null
    );
  
[0m16:34:46.566423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:322db2c6-3c3d-4ab1-8bbe-4dd4810c8941&page=queryresults
[0m16:34:50.619344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124204280>]}
[0m16:34:50.622816 [info ] [Thread-1 (]: 4 of 12 OK created sql table model dwh_dev_intermediate.int_rates_usdt ......... [[32mCREATE TABLE (29.8k rows, 3.3 MiB processed)[0m in 5.46s]
[0m16:34:50.625980 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:34:50.627819 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:34:50.630412 [info ] [Thread-1 (]: 5 of 12 START sql table model dwh_dev_mart.dim_currencies ...................... [RUN]
[0m16:34:50.632697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now model.de_test_dwh.dim_currencies)
[0m16:34:50.634036 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:34:50.644990 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:34:50.648963 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:34:50.654460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:51.270109 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_currencies"
[0m16:34:51.272655 [debug] [Thread-1 (]: On model.de_test_dwh.dim_currencies: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_currencies"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
      
    
    

    
    OPTIONS()
    as (
      


with transactions as (
    select distinct
        source_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
    
    union distinct
    
    select distinct
        destination_currency as currency
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
)

select
    currency,
    currency as currency_code,
    case
        when currency = 'USDT' then 'Tether'
        when currency = 'BTC' then 'Bitcoin'
        when currency = 'ETH' then 'Ethereum'
        when currency = 'BNB' then 'Binance Coin'
        when currency = 'ADA' then 'Cardano'
        when currency = 'SOL' then 'Solana'
        when currency = 'DOGE' then 'Dogecoin'
        when currency = 'SHIB' then 'Shiba Inu'
        when currency = 'UNI' then 'Uniswap'
        when currency = 'NGN' then 'Nigerian Naira'
        else 'Unknown'
    end as currency_name
from transactions
where currency is not null
order by currency
    );
  
[0m16:34:52.038576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:acaa468c-5854-48d1-94fb-7982a524a6f3&page=queryresults
[0m16:34:53.814598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279cceb0>]}
[0m16:34:53.816327 [info ] [Thread-1 (]: 5 of 12 OK created sql table model dwh_dev_mart.dim_currencies ................. [[32mCREATE TABLE (29.0 rows, 10.7 KiB processed)[0m in 3.18s]
[0m16:34:53.817702 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:34:53.818614 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:34:53.819730 [info ] [Thread-1 (]: 6 of 12 START sql table model dwh_dev_mart.dim_date ............................ [RUN]
[0m16:34:53.820749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:34:53.821550 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:34:53.831061 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:34:53.832593 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:34:53.837227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:54.479663 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_date"
[0m16:34:54.482176 [debug] [Thread-1 (]: On model.de_test_dwh.dim_date: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_date"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_date`
      
    
    

    
    OPTIONS()
    as (
      


with date_range as (
    select
        min(date(created_at)) as start_date,
        max(date(created_at)) as end_date
    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

date_series as (
    select
        date_add(start_date, interval day_offset day) as date
    from date_range,
    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset
)

select
    date,
    extract(year from date) as year,
    extract(quarter from date) as quarter,
    extract(month from date) as month,
    extract(day from date) as day,
    extract(dayofweek from date) as day_of_week,
    format_date('%A', date) as day_name,
    format_date('%B', date) as month_name,
    extract(week from date) as week_of_year,
    extract(dayofyear from date) as day_of_year,
    case
        when extract(dayofweek from date) in (1, 7) then true
        else false
    end as is_weekend
from date_series
    );
  
[0m16:34:55.214903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f4b71950-1eae-4dd5-8a41-baa8ad863781&page=queryresults
[0m16:34:56.852913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279a4250>]}
[0m16:34:56.854483 [info ] [Thread-1 (]: 6 of 12 OK created sql table model dwh_dev_mart.dim_date ....................... [[32mCREATE TABLE (187.0 rows, 7.8 KiB processed)[0m in 3.03s]
[0m16:34:56.855801 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:34:56.856692 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:34:56.857691 [info ] [Thread-1 (]: 7 of 12 START sql table model dwh_dev_intermediate.int_users_scd2 .............. [RUN]
[0m16:34:56.858892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now model.de_test_dwh.int_users_scd2)
[0m16:34:56.859673 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:34:56.886315 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:34:56.887439 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:34:56.890684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:57.499928 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_users_scd2"
[0m16:34:57.502638 [debug] [Thread-1 (]: On model.de_test_dwh.int_users_scd2: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_users_scd2"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
      
    
    

    
    OPTIONS()
    as (
      

with users as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`
),

user_periods as (
    select
        user_id,
        kyc_level,
        created_at as period_start,
        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,
        updated_at as last_updated,
        case
            when updated_at is null or updated_at = created_at then true
            else false
        end as is_current_period
    from users
),

final as (
    select
        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,
        user_id,
        kyc_level,
        period_start as effective_from,
        period_end as effective_to,
        last_updated,
        is_current_period as is_current,
        timestamp_diff(period_end, period_start, second) as duration_seconds
    from user_periods
)

select * 
from final
order by user_id, effective_from
    );
  
[0m16:34:58.182822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e6f571fe-2a15-4d74-8d4e-fde8db960429&page=queryresults
[0m16:35:00.124400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279a7c70>]}
[0m16:35:00.125976 [info ] [Thread-1 (]: 7 of 12 OK created sql table model dwh_dev_intermediate.int_users_scd2 ......... [[32mCREATE TABLE (272.0 rows, 8.5 KiB processed)[0m in 3.27s]
[0m16:35:00.127341 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:35:00.128340 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:35:00.129768 [info ] [Thread-1 (]: 8 of 12 START sql table model dwh_dev_intermediate.int_transactions_with_rates . [RUN]
[0m16:35:00.130916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now model.de_test_dwh.int_transactions_with_rates)
[0m16:35:00.131680 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:35:00.139989 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:35:00.141471 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:35:00.147518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:00.712762 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:35:00.715425 [debug] [Thread-1 (]: On model.de_test_dwh.int_transactions_with_rates: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.int_transactions_with_rates"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
      
    partition by date_created
    

    
    OPTIONS()
    as (
      

with transactions as (
    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
),

rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`
),

latest_source_rate as (
    select
        t.txn_id,
        r.usdt_price as source_usdt_price,
        r.price_timestamp as source_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc
        ) as rn
    from transactions t
    left join rates r
        on r.currency = t.source_currency
        and r.price_timestamp <= t.created_at 
),

latest_dest_rate as (
    select
        t.txn_id,
        r.usdt_price as destination_usdt_price,
        r.price_timestamp as destination_rate_timestamp,
        row_number() over (
            partition by t.txn_id
            order by r.price_timestamp desc
        ) as rn
    from transactions t
    left join rates r
        on r.currency = t.destination_currency
        and r.price_timestamp <= t.created_at 
),

transactions_with_rates as (
    select
        t.*,
        lsr.source_usdt_price,
        lsr.source_rate_timestamp,
        ldr.destination_usdt_price,
        ldr.destination_rate_timestamp
    from transactions t
    left join latest_source_rate lsr
        on lsr.txn_id = t.txn_id
        and lsr.rn = 1
    left join latest_dest_rate ldr
        on ldr.txn_id = t.txn_id
        and ldr.rn = 1
)

select
    *,
    date(created_at) as date_created,
    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,
    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd
from transactions_with_rates
    );
  
[0m16:35:01.358492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:2b55659a-f4bf-4a36-b565-e50a0a2f456c&page=queryresults
[0m16:35:05.198696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124204280>]}
[0m16:35:05.200424 [info ] [Thread-1 (]: 8 of 12 OK created sql table model dwh_dev_intermediate.int_transactions_with_rates  [[32mCREATE TABLE (93.0 rows, 676.7 KiB processed)[0m in 5.07s]
[0m16:35:05.202390 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:35:05.203438 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:35:05.204604 [info ] [Thread-1 (]: 9 of 12 START sql table model dwh_dev_mart.dim_users ........................... [RUN]
[0m16:35:05.205691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now model.de_test_dwh.dim_users)
[0m16:35:05.206483 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:35:05.213607 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:35:05.215733 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:35:05.220017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:05.793088 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.dim_users"
[0m16:35:05.796901 [debug] [Thread-1 (]: On model.de_test_dwh.dim_users: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.dim_users"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`dim_users`
      
    
    

    
    OPTIONS()
    as (
      


select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
order by user_id, effective_from
    );
  
[0m16:35:06.168245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:c8444c15-825a-4dd8-88d6-a3d7fffbba51&page=queryresults
[0m16:35:07.826702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f01300>]}
[0m16:35:07.828297 [info ] [Thread-1 (]: 9 of 12 OK created sql table model dwh_dev_mart.dim_users ...................... [[32mCREATE TABLE (272.0 rows, 22.0 KiB processed)[0m in 2.62s]
[0m16:35:07.829604 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:35:07.830547 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:35:07.831743 [info ] [Thread-1 (]: 10 of 12 START sql table model dwh_dev_mart.fct_transactions ................... [RUN]
[0m16:35:07.832835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:35:07.833580 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:35:07.842087 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:35:07.843969 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:35:07.848255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:08.436386 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.fct_transactions"
[0m16:35:08.438527 [debug] [Thread-1 (]: On model.de_test_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.fct_transactions"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
      
    partition by transaction_date
    

    
    OPTIONS()
    as (
      


with transactions_with_rates as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`
),

users_scd2 as (
    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`
),

transactions_with_kyc as (
    select
        t.txn_id,
        t.user_id,
        u.user_kyc_key,
        t.status,
        t.source_currency,
        t.destination_currency,
        t.created_at as transaction_timestamp,
        date(t.created_at) as transaction_date,
        t.source_amount,
        t.destination_amount,
        t.source_amount_usd,
        t.destination_amount_usd,
        u.kyc_level as kyc_level_at_transaction
    from transactions_with_rates t
    left join users_scd2 u
        on t.user_id = u.user_id
        and t.created_at >= u.effective_from
        and t.created_at < u.effective_to
)

select * from transactions_with_kyc
    );
  
[0m16:35:09.037306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9ea26de0-e703-44d5-b269-ca213b311225&page=queryresults
[0m16:35:11.705868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124204280>]}
[0m16:35:11.707256 [info ] [Thread-1 (]: 10 of 12 OK created sql table model dwh_dev_mart.fct_transactions .............. [[32mCREATE TABLE (93.0 rows, 24.5 KiB processed)[0m in 3.87s]
[0m16:35:11.708299 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:35:11.709411 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:35:11.710308 [info ] [Thread-1 (]: 11 of 12 START sql table model dwh_dev_mart.tb_transactions_by_kyc ............. [RUN]
[0m16:35:11.711221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now model.de_test_dwh.tb_transactions_by_kyc)
[0m16:35:11.711939 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m16:35:11.717719 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:35:11.719094 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m16:35:11.722697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:12.291994 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:35:12.294812 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_by_kyc: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_by_kyc"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`
      
    
    

    
    OPTIONS()
    as (
      
      

select
    kyc_level_at_transaction,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where kyc_level_at_transaction is not null
group by all
    );
  
[0m16:35:12.630526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d6a6aeb8-ce11-45ee-83d9-8de8a3414f8e&page=queryresults
[0m16:35:14.315097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279cd990>]}
[0m16:35:14.316677 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dwh_dev_mart.tb_transactions_by_kyc ........ [[32mCREATE TABLE (4.0 rows, 3.9 KiB processed)[0m in 2.60s]
[0m16:35:14.318132 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:35:14.319084 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:35:14.320309 [info ] [Thread-1 (]: 12 of 12 START sql table model dwh_dev_mart.tb_transactions_tracking ........... [RUN]
[0m16:35:14.321490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m16:35:14.322317 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:35:14.329886 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:35:14.331492 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:35:14.335874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:14.968442 [debug] [Thread-1 (]: Writing runtime sql for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:35:14.971155 [debug] [Thread-1 (]: On model.de_test_dwh.tb_transactions_tracking: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "model.de_test_dwh.tb_transactions_tracking"} */

  
    

    create or replace table `cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`
      
    
    

    
    OPTIONS()
    as (
      

select
    transaction_date timeframe,
    "daily" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,
    "weekly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, month) timeframe,
    "monthly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL 

UNION ALL 

select
    DATE_TRUNC(transaction_date, QUARTER) timeframe,
    "quarterly" timeframe_type,
    count(distinct txn_id) as nb_transaction,
    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,
    count(distinct user_id) as nb_users,
    sum(destination_amount_usd) as total_volume_usd,
    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
group by ALL
    );
  
[0m16:35:15.282948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4534a2a3-2b18-406a-9441-4e6ab4ad779c&page=queryresults
[0m16:35:17.450889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39bfca7c-bf5a-4738-8e41-8c6087236d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b30610>]}
[0m16:35:17.452485 [info ] [Thread-1 (]: 12 of 12 OK created sql table model dwh_dev_mart.tb_transactions_tracking ...... [[32mCREATE TABLE (58.0 rows, 3.9 KiB processed)[0m in 3.13s]
[0m16:35:17.453833 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:35:17.456146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:17.506149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:17.506752 [debug] [MainThread]: Connection 'model.de_test_dwh.tb_transactions_tracking' was properly closed.
[0m16:35:17.507322 [info ] [MainThread]: 
[0m16:35:17.507891 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 39.99 seconds (39.99s).
[0m16:35:17.510757 [debug] [MainThread]: Command end result
[0m16:35:17.553551 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:35:17.556067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:35:17.566361 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:35:17.567181 [info ] [MainThread]: 
[0m16:35:17.567966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:17.568539 [info ] [MainThread]: 
[0m16:35:17.569112 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:35:17.574162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 47.907032, "process_in_blocks": "0", "process_kernel_time": 2.041978, "process_mem_max_rss": "362971136", "process_out_blocks": "0", "process_user_time": 11.029931}
[0m16:35:17.575069 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:17.574915 after 47.91 seconds
[0m16:35:17.575957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c5c60>]}
[0m16:35:17.576713 [debug] [MainThread]: Flushing usage events
[0m16:35:19.275183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:12.652395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110daa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111da8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111da90c0>]}


============================== 16:36:12.657484 | b406439b-eb1f-4b9d-92e9-0d5efa0c8c43 ==============================
[0m16:36:12.657484 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:36:12.658386 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select finance', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_cache_events': 'False', 'no_print': 'None'}
[0m16:36:15.750714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1336a2710>]}
[0m16:36:15.832017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111613910>]}
[0m16:36:15.832960 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:36:16.128157 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:36:16.520386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:16.521032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:16.581575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c9a8c0>]}
[0m16:36:16.695315 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:36:16.697850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:36:16.751567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c9dcf0>]}
[0m16:36:16.752468 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:36:16.753072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133c9f550>]}
[0m16:36:16.755845 [info ] [MainThread]: 
[0m16:36:16.756533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:16.757013 [info ] [MainThread]: 
[0m16:36:16.757787 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:16.765898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_staging'
[0m16:36:16.767318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:17.455896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m16:36:17.458605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:18.042874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:36:18.046457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:18.654051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b406439b-eb1f-4b9d-92e9-0d5efa0c8c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43a800>]}
[0m16:36:18.655394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:18.711592 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:36:18.712379 [info ] [Thread-1 (]: 1 of 8 START test not_null_fct_transactions_txn_id ............................. [RUN]
[0m16:36:18.713204 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d'
[0m16:36:18.713697 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:36:18.741791 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:36:18.744059 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:36:18.778554 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:36:18.779777 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:18.780509 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:19.693497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:861bc34f-9267-42c9-81a8-33fab1a3f3c1&page=queryresults
[0m16:36:20.275878 [info ] [Thread-1 (]: 1 of 8 PASS not_null_fct_transactions_txn_id ................................... [[32mPASS[0m in 1.56s]
[0m16:36:20.277337 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:36:20.278195 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:36:20.279121 [info ] [Thread-1 (]: 2 of 8 START test not_null_stg_rates_close_price ............................... [RUN]
[0m16:36:20.280121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m16:36:20.280897 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:36:20.288802 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:36:20.292154 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:36:20.297143 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:36:20.298358 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m16:36:20.299064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:21.566881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:34b4bfcf-a06f-499b-be6e-ac9ad6774ea8&page=queryresults
[0m16:36:22.029956 [info ] [Thread-1 (]: 2 of 8 PASS not_null_stg_rates_close_price ..................................... [[32mPASS[0m in 1.75s]
[0m16:36:22.031834 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:36:22.032781 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:36:22.033843 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_rates_symbol .................................... [RUN]
[0m16:36:22.034932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m16:36:22.035777 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:36:22.045746 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:36:22.047499 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:36:22.053708 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:36:22.055288 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:36:22.056016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:23.174943 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:64e78147-63c6-48f9-aff7-29033327e05f&page=queryresults
[0m16:36:23.629545 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_rates_symbol .......................................... [[32mPASS[0m in 1.59s]
[0m16:36:23.631017 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:36:23.631890 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:36:23.632736 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_transactions_txn_id ............................. [RUN]
[0m16:36:23.633627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m16:36:23.634577 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:36:23.641748 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:36:23.642878 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:36:23.648045 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:36:23.649144 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:23.649718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:24.854720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:c15bd95c-b97d-4383-a797-653d0bef9d6e&page=queryresults
[0m16:36:25.362589 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_transactions_txn_id ................................... [[32mPASS[0m in 1.73s]
[0m16:36:25.364512 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:36:25.365518 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:36:25.366562 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m16:36:25.367680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m16:36:25.368585 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:36:25.380146 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:36:25.381551 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:36:25.387124 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:36:25.388507 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:25.389199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:26.504924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9746fda7-186e-460d-871d-d05087345d25&page=queryresults
[0m16:36:26.991209 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 1.62s]
[0m16:36:26.993113 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:36:26.994098 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:36:26.995163 [info ] [Thread-1 (]: 6 of 8 START test unique_fct_transactions_txn_id ............................... [RUN]
[0m16:36:26.996255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m16:36:26.997131 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:36:27.012422 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:36:27.013814 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:36:27.018795 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:36:27.020464 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:27.021113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:27.990332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ee76c839-e563-4d05-9d91-ce07af746283&page=queryresults
[0m16:36:28.548345 [info ] [Thread-1 (]: 6 of 8 PASS unique_fct_transactions_txn_id ..................................... [[32mPASS[0m in 1.55s]
[0m16:36:28.550186 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:36:28.551178 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:36:28.552190 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_transactions_txn_id ............................... [RUN]
[0m16:36:28.553252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m16:36:28.554132 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:36:28.564138 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:36:28.566190 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:36:28.571175 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:36:28.572369 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:28.573002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:29.629244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3cc6e420-dc29-4336-902e-2be1be2a831f&page=queryresults
[0m16:36:30.109385 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_transactions_txn_id ..................................... [[32mPASS[0m in 1.56s]
[0m16:36:30.111175 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:36:30.112103 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:36:30.113347 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m16:36:30.114523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m16:36:30.115414 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:36:30.123725 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:36:30.125088 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:36:30.129546 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:36:30.130706 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:30.131506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:31.329367 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f4df2cfe-74a1-4021-872a-aca7d9707417&page=queryresults
[0m16:36:31.831908 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 1.72s]
[0m16:36:31.833886 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:36:31.836255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:31.888262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:31.888902 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_intermediate' was properly closed.
[0m16:36:31.889328 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m16:36:31.889796 [info ] [MainThread]: 
[0m16:36:31.890344 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 15.13 seconds (15.13s).
[0m16:36:31.892440 [debug] [MainThread]: Command end result
[0m16:36:31.932439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:36:31.935087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:36:31.944855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:36:31.945683 [info ] [MainThread]: 
[0m16:36:31.946388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:31.947015 [info ] [MainThread]: 
[0m16:36:31.947708 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m16:36:31.953133 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 19.387112, "process_in_blocks": "0", "process_kernel_time": 1.076928, "process_mem_max_rss": "357990400", "process_out_blocks": "0", "process_user_time": 7.749603}
[0m16:36:31.954094 [debug] [MainThread]: Command `dbt test` succeeded at 16:36:31.953950 after 19.39 seconds
[0m16:36:31.955288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110daa500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f29c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134385c60>]}
[0m16:36:31.956618 [debug] [MainThread]: Flushing usage events
[0m16:36:33.006756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:01.645376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f44cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f44d270>]}


============================== 16:37:01.649696 | 9fcf7860-41a7-4c98-9572-a6273c0deb95 ==============================
[0m16:37:01.649696 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:37:01.650491 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'empty': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt test --select finance.staging', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m16:37:04.729090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e596e60>]}
[0m16:37:04.805807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb97be0>]}
[0m16:37:04.806755 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:37:05.164747 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:37:05.570087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:05.570655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:05.633284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1313628c0>]}
[0m16:37:05.755325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:37:05.757811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:37:05.804389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131365810>]}
[0m16:37:05.805171 [info ] [MainThread]: Found 12 models, 8 data tests, 3 sources, 624 macros
[0m16:37:05.805717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131366500>]}
[0m16:37:05.808005 [info ] [MainThread]: 
[0m16:37:05.808646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:05.809188 [info ] [MainThread]: 
[0m16:37:05.809928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:05.817735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_mart'
[0m16:37:05.819184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:06.497834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:37:06.501245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:07.087407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_staging)
[0m16:37:07.089944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:07.674930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fcf7860-41a7-4c98-9572-a6273c0deb95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130cce230>]}
[0m16:37:07.676356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:07.730997 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:07.731595 [info ] [Thread-1 (]: 1 of 6 START test not_null_stg_rates_close_price ............................... [RUN]
[0m16:37:07.732373 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a'
[0m16:37:07.732824 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:07.761274 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:37:07.762291 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:07.788202 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:37:07.789545 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m16:37:07.790409 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:37:08.723141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3972eafe-f7af-4d6b-8d10-561459d002d5&page=queryresults
[0m16:37:09.283001 [info ] [Thread-1 (]: 1 of 6 PASS not_null_stg_rates_close_price ..................................... [[32mPASS[0m in 1.55s]
[0m16:37:09.284743 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:09.285664 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:09.286588 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_rates_symbol .................................... [RUN]
[0m16:37:09.288092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m16:37:09.288975 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:09.296950 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:37:09.298317 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:09.303191 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:37:09.304441 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:37:09.305304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:10.386222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:fa7f8389-1ccd-4804-bc76-0e82f0e4e8d9&page=queryresults
[0m16:37:10.844623 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_rates_symbol .......................................... [[32mPASS[0m in 1.56s]
[0m16:37:10.846430 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:10.847380 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:10.848442 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_transactions_txn_id ............................. [RUN]
[0m16:37:10.849535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m16:37:10.850410 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:10.858763 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:37:10.861358 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:10.866850 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:37:10.868066 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:10.868947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:12.127221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:88d9d4ee-39b8-4f2f-b68d-64ce485f43bc&page=queryresults
[0m16:37:12.611252 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_transactions_txn_id ................................... [[32mPASS[0m in 1.76s]
[0m16:37:12.613151 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:12.614122 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:12.615186 [info ] [Thread-1 (]: 4 of 6 START test not_null_stg_users_user_id ................................... [RUN]
[0m16:37:12.616340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m16:37:12.617228 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:12.626552 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:37:12.628354 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:12.634849 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:37:12.636204 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:12.637175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:13.867572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:56ca0264-3a73-4080-a064-582596c2f0dc&page=queryresults
[0m16:37:14.339343 [info ] [Thread-1 (]: 4 of 6 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 1.72s]
[0m16:37:14.341103 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:14.342085 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:37:14.343085 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_transactions_txn_id ............................... [RUN]
[0m16:37:14.344148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m16:37:14.344980 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:37:14.359997 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:37:14.361310 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:37:14.365431 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:37:14.366506 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:14.367344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:15.504599 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:7c8b5a04-e1f5-4d9a-b4ad-e3ec15e341c2&page=queryresults
[0m16:37:15.967035 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_transactions_txn_id ..................................... [[32mPASS[0m in 1.62s]
[0m16:37:15.968757 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:37:15.969710 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:37:15.970744 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_users_user_id ..................................... [RUN]
[0m16:37:15.971866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m16:37:15.972759 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:37:15.984983 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:37:15.986936 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:37:15.991541 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:37:15.992599 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:15.993192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:17.140624 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:cfb6070d-da3e-4ac3-8a72-c1c520c5e224&page=queryresults
[0m16:37:17.612724 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 1.64s]
[0m16:37:17.614388 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:37:17.616801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:17.665368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:17.666182 [debug] [MainThread]: Connection 'list_cusma-383203_dwh_dev_staging' was properly closed.
[0m16:37:17.666919 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m16:37:17.667676 [info ] [MainThread]: 
[0m16:37:17.668729 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 11.86 seconds (11.86s).
[0m16:37:17.672068 [debug] [MainThread]: Command end result
[0m16:37:17.724917 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:37:17.728492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:37:17.742738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:37:17.743974 [info ] [MainThread]: 
[0m16:37:17.745100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:17.745716 [info ] [MainThread]: 
[0m16:37:17.746266 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:37:17.748913 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.182344, "process_in_blocks": "0", "process_kernel_time": 1.112563, "process_mem_max_rss": "358354944", "process_out_blocks": "0", "process_user_time": 7.432923}
[0m16:37:17.751163 [debug] [MainThread]: Command `dbt test` succeeded at 16:37:17.750462 after 16.18 seconds
[0m16:37:17.752271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e44e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb97be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131367b50>]}
[0m16:37:17.753348 [debug] [MainThread]: Flushing usage events
[0m16:37:19.086701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:33.270204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113642410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f1270>]}


============================== 16:37:33.274710 | 7901a87a-3d26-4291-96a3-2135247583fc ==============================
[0m16:37:33.274710 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:37:33.275577 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt test --select finance', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'partial_parse': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default'}
[0m16:37:36.016808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145a01f0>]}
[0m16:37:36.092431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145a2290>]}
[0m16:37:36.093460 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:37:36.387810 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:37:36.710299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:36.711612 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/schema.yml
[0m16:37:37.979300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136960130>]}
[0m16:37:38.205653 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:37:38.208600 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:37:38.259486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13694a8c0>]}
[0m16:37:38.260471 [info ] [MainThread]: Found 12 models, 19 data tests, 3 sources, 624 macros
[0m16:37:38.261152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136949d80>]}
[0m16:37:38.265123 [info ] [MainThread]: 
[0m16:37:38.266051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:38.267397 [info ] [MainThread]: 
[0m16:37:38.269203 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:38.279546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_staging'
[0m16:37:38.280304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:38.915182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_mart)
[0m16:37:38.929075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:39.576145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_intermediate)
[0m16:37:39.580684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:40.172488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7901a87a-3d26-4291-96a3-2135247583fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f02200>]}
[0m16:37:40.173257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:40.221875 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:37:40.222510 [info ] [Thread-1 (]: 1 of 19 START test not_null_dim_currencies_currency ............................ [RUN]
[0m16:37:40.223243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648)
[0m16:37:40.223738 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:37:40.248053 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m16:37:40.250016 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:37:40.281257 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m16:37:40.283275 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
where currency is null



  
  
      
    ) dbt_internal_test
[0m16:37:40.284736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:41.206590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:c3286425-e6b3-4680-a40d-9f86708a007d&page=queryresults
[0m16:37:41.703260 [info ] [Thread-1 (]: 1 of 19 PASS not_null_dim_currencies_currency .................................. [[32mPASS[0m in 1.48s]
[0m16:37:41.704703 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:37:41.705556 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:37:41.706504 [info ] [Thread-1 (]: 2 of 19 START test not_null_dim_date_date ...................................... [RUN]
[0m16:37:41.707494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m16:37:41.708267 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:37:41.716330 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m16:37:41.719674 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:37:41.724651 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m16:37:41.725939 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `cusma-383203`.`dwh_dev_mart`.`dim_date`
where date is null



  
  
      
    ) dbt_internal_test
[0m16:37:41.726528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:42.631732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:82e1c05d-d720-433a-a438-279ab83c91cf&page=queryresults
[0m16:37:43.063030 [info ] [Thread-1 (]: 2 of 19 PASS not_null_dim_date_date ............................................ [[32mPASS[0m in 1.36s]
[0m16:37:43.064967 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:37:43.065985 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:37:43.067088 [info ] [Thread-1 (]: 3 of 19 START test not_null_dim_users_effective_from ........................... [RUN]
[0m16:37:43.068239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m16:37:43.069151 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:37:43.078616 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m16:37:43.080719 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:37:43.087159 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m16:37:43.088641 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_from
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_from is null



  
  
      
    ) dbt_internal_test
[0m16:37:43.089562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:43.899338 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b39a7a88-d364-4c79-93d1-85b5c09ca843&page=queryresults
[0m16:37:44.360532 [info ] [Thread-1 (]: 3 of 19 PASS not_null_dim_users_effective_from ................................. [[32mPASS[0m in 1.29s]
[0m16:37:44.362385 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:37:44.363385 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:37:44.364517 [info ] [Thread-1 (]: 4 of 19 START test not_null_dim_users_effective_to ............................. [RUN]
[0m16:37:44.365675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m16:37:44.366582 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:37:44.375809 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m16:37:44.457291 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:37:44.476070 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m16:37:44.477423 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_to
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_to is null



  
  
      
    ) dbt_internal_test
[0m16:37:44.478202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:45.302139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3216295f-b216-412d-9617-2354014002da&page=queryresults
[0m16:37:45.793041 [info ] [Thread-1 (]: 4 of 19 PASS not_null_dim_users_effective_to ................................... [[32mPASS[0m in 1.43s]
[0m16:37:45.794630 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:37:45.795470 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:37:45.796336 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_users_kyc_level ................................ [RUN]
[0m16:37:45.797230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m16:37:45.798333 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:37:45.808433 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m16:37:45.809611 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:37:45.813244 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m16:37:45.815039 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_kyc_level.552489338e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m16:37:45.816056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:46.634650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4ad3ed37-7248-425c-843e-a89958a3cccc&page=queryresults
[0m16:37:47.108262 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_users_kyc_level ...................................... [[32mPASS[0m in 1.31s]
[0m16:37:47.111162 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:37:47.112322 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:37:47.113444 [info ] [Thread-1 (]: 6 of 19 START test not_null_dim_users_user_id .................................. [RUN]
[0m16:37:47.115840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m16:37:47.117789 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:37:47.126316 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m16:37:47.127716 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:37:47.132173 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m16:37:47.133688 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:47.134519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:47.928836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8a34c6ad-d064-4c29-ade2-09121c30f298&page=queryresults
[0m16:37:48.470122 [info ] [Thread-1 (]: 6 of 19 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 1.35s]
[0m16:37:48.472710 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:37:48.475486 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:37:48.477061 [info ] [Thread-1 (]: 7 of 19 START test not_null_dim_users_user_kyc_key ............................. [RUN]
[0m16:37:48.480773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m16:37:48.481383 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:37:48.489292 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m16:37:48.490591 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:37:48.496011 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m16:37:48.499419 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_kyc_key
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_kyc_key is null



  
  
      
    ) dbt_internal_test
[0m16:37:48.502451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:49.399358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:4b48f11e-a121-40b9-a24a-104fb6f3150e&page=queryresults
[0m16:37:49.837197 [info ] [Thread-1 (]: 7 of 19 PASS not_null_dim_users_user_kyc_key ................................... [[32mPASS[0m in 1.36s]
[0m16:37:49.838150 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:37:49.838839 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m16:37:49.839490 [info ] [Thread-1 (]: 8 of 19 START test not_null_fct_transactions_destination_amount_usd ............ [RUN]
[0m16:37:49.840255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0)
[0m16:37:49.840730 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m16:37:49.848059 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m16:37:49.849978 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m16:37:49.853867 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"
[0m16:37:49.855069 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select destination_amount_usd
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where destination_amount_usd is null



  
  
      
    ) dbt_internal_test
[0m16:37:49.855787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:50.977125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e6c469d5-ad55-44b9-808d-c6b0c993e70e&page=queryresults
[0m16:37:51.428069 [error] [Thread-1 (]: 8 of 19 FAIL 5 not_null_fct_transactions_destination_amount_usd ................ [[31mFAIL 5[0m in 1.59s]
[0m16:37:51.429241 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0
[0m16:37:51.430111 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:37:51.431672 [info ] [Thread-1 (]: 9 of 19 START test not_null_fct_transactions_txn_id ............................ [RUN]
[0m16:37:51.433053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_destination_amount_usd.0588e378e0, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m16:37:51.434340 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:37:51.443618 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:37:51.444905 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:37:51.451151 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:37:51.452280 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:51.453010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:52.236865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d9720595-8120-4839-98c0-7e406c974f6a&page=queryresults
[0m16:37:52.758682 [info ] [Thread-1 (]: 9 of 19 PASS not_null_fct_transactions_txn_id .................................. [[32mPASS[0m in 1.33s]
[0m16:37:52.759980 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:37:52.760900 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:52.761754 [info ] [Thread-1 (]: 10 of 19 START test not_null_stg_rates_close_price ............................. [RUN]
[0m16:37:52.762588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m16:37:52.763215 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:52.770582 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:37:52.771542 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:52.776137 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:37:52.778514 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m16:37:52.779304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:53.740849 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bda15cfe-c34b-485c-a05b-7e594a263c38&page=queryresults
[0m16:37:54.214488 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stg_rates_close_price ................................... [[32mPASS[0m in 1.45s]
[0m16:37:54.215791 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:37:54.216583 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:54.217244 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_rates_symbol .................................. [RUN]
[0m16:37:54.218019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m16:37:54.218506 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:54.224363 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:37:54.225700 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:54.230778 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:37:54.232989 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:37:54.233789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:55.442259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:b45f4813-6090-4ccc-8f65-e23be7fa4a95&page=queryresults
[0m16:37:55.871786 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_rates_symbol ........................................ [[32mPASS[0m in 1.65s]
[0m16:37:55.873328 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:37:55.874276 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:55.875254 [info ] [Thread-1 (]: 12 of 19 START test not_null_stg_transactions_txn_id ........................... [RUN]
[0m16:37:55.876396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m16:37:55.877202 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:55.885082 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:37:55.886387 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:55.890697 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:37:55.892210 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:55.893077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:56.951072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:0a54506c-2381-4edb-a9d9-83455108d371&page=queryresults
[0m16:37:57.386248 [info ] [Thread-1 (]: 12 of 19 PASS not_null_stg_transactions_txn_id ................................. [[32mPASS[0m in 1.51s]
[0m16:37:57.387411 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:37:57.388133 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:57.389182 [info ] [Thread-1 (]: 13 of 19 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:37:57.390135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m16:37:57.390997 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:57.398000 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:37:57.399346 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:57.402863 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:37:57.403868 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:37:57.404428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:58.596401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:20ea4063-b02a-43eb-840b-fd8d1b6e0185&page=queryresults
[0m16:37:59.079835 [info ] [Thread-1 (]: 13 of 19 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 1.69s]
[0m16:37:59.082370 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:37:59.083751 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:37:59.085291 [info ] [Thread-1 (]: 14 of 19 START test unique_dim_currencies_currency ............................. [RUN]
[0m16:37:59.086921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m16:37:59.088451 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:37:59.105576 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m16:37:59.106715 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:37:59.110374 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m16:37:59.111463 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_currencies_currency.20f50226d8: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select currency as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
  where currency is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:59.112275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:59.939662 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:ba990bb9-401e-4f6a-8a27-81ac09f5b572&page=queryresults
[0m16:38:00.411434 [info ] [Thread-1 (]: 14 of 19 PASS unique_dim_currencies_currency ................................... [[32mPASS[0m in 1.32s]
[0m16:38:00.413045 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:38:00.414030 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:38:00.415083 [info ] [Thread-1 (]: 15 of 19 START test unique_dim_date_date ....................................... [RUN]
[0m16:38:00.416659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m16:38:00.417704 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:38:00.426623 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m16:38:00.427832 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:38:00.433099 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m16:38:00.434726 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_date`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:00.435416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:01.280335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:c983b574-284d-4cd2-8ae1-7519d59a905c&page=queryresults
[0m16:38:01.701820 [info ] [Thread-1 (]: 15 of 19 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.28s]
[0m16:38:01.704357 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:38:01.705758 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:38:01.706938 [info ] [Thread-1 (]: 16 of 19 START test unique_dim_users_user_kyc_key .............................. [RUN]
[0m16:38:01.708369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m16:38:01.709320 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:38:01.716922 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m16:38:01.718178 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:38:01.726355 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m16:38:01.729871 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_kyc_key as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_users`
  where user_kyc_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:01.731436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:02.492414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:8a39dc33-592a-49e2-a16d-1d3827668da5&page=queryresults
[0m16:38:02.928728 [info ] [Thread-1 (]: 16 of 19 PASS unique_dim_users_user_kyc_key .................................... [[32mPASS[0m in 1.22s]
[0m16:38:02.930440 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:38:02.931441 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:38:02.932619 [info ] [Thread-1 (]: 17 of 19 START test unique_fct_transactions_txn_id ............................. [RUN]
[0m16:38:02.934475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m16:38:02.935699 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:38:02.946490 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:38:02.948252 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:38:02.954097 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:38:02.955560 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:02.956547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:03.738332 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6893b04a-5809-45b4-abb5-cf0a8f440da5&page=queryresults
[0m16:38:04.337684 [info ] [Thread-1 (]: 17 of 19 PASS unique_fct_transactions_txn_id ................................... [[32mPASS[0m in 1.40s]
[0m16:38:04.339231 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:38:04.340187 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:38:04.341312 [info ] [Thread-1 (]: 18 of 19 START test unique_stg_transactions_txn_id ............................. [RUN]
[0m16:38:04.342813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m16:38:04.344051 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:38:04.352667 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:38:04.354617 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:38:04.360155 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:38:04.361364 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:04.361926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:05.457311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:f1a556a0-90b4-4ea4-a4bf-ddc4abddc87c&page=queryresults
[0m16:38:05.901539 [info ] [Thread-1 (]: 18 of 19 PASS unique_stg_transactions_txn_id ................................... [[32mPASS[0m in 1.56s]
[0m16:38:05.903241 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:38:05.904604 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:38:05.905969 [info ] [Thread-1 (]: 19 of 19 START test unique_stg_users_user_id ................................... [RUN]
[0m16:38:05.907150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m16:38:05.907973 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:38:05.917755 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:38:05.919003 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:38:05.924799 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:38:05.925948 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:05.926559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:07.218393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:681c1220-600d-474c-87b2-66bbf9716719&page=queryresults
[0m16:38:07.672573 [info ] [Thread-1 (]: 19 of 19 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 1.77s]
[0m16:38:07.673949 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:38:07.676114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:07.726879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:07.727497 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m16:38:07.728042 [info ] [MainThread]: 
[0m16:38:07.728543 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 29.46 seconds (29.46s).
[0m16:38:07.733577 [debug] [MainThread]: Command end result
[0m16:38:07.782024 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:38:07.786837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:38:07.799802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:38:07.800589 [info ] [MainThread]: 
[0m16:38:07.801232 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:07.801904 [info ] [MainThread]: 
[0m16:38:07.802504 [error] [MainThread]: [31mFailure in test not_null_fct_transactions_destination_amount_usd (models/finance/marts/schema.yml)[0m
[0m16:38:07.803003 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m16:38:07.803546 [info ] [MainThread]: 
[0m16:38:07.804615 [info ] [MainThread]:   compiled code at target/compiled/de_test_dwh/models/finance/marts/schema.yml/not_null_fct_transactions_destination_amount_usd.sql
[0m16:38:07.805939 [info ] [MainThread]: 
[0m16:38:07.807069 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m16:38:07.810318 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 34.620354, "process_in_blocks": "0", "process_kernel_time": 1.251544, "process_mem_max_rss": "366956544", "process_out_blocks": "0", "process_user_time": 10.541826}
[0m16:38:07.811038 [debug] [MainThread]: Command `dbt test` failed at 16:38:07.810901 after 34.62 seconds
[0m16:38:07.811567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113642410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145a01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1370446a0>]}
[0m16:38:07.812061 [debug] [MainThread]: Flushing usage events
[0m16:38:08.973386 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:52.203853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d1570>]}


============================== 16:38:52.211277 | 083430d4-d967-4224-9e18-c96012ecabc5 ==============================
[0m16:38:52.211277 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:38:52.212164 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --select finance', 'log_format': 'default', 'printer_width': '80', 'empty': 'None'}
[0m16:38:57.849686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029d2e60>]}
[0m16:38:57.929470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126cde020>]}
[0m16:38:57.930393 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:38:58.285038 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:38:58.755918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:58.757060 [debug] [MainThread]: Partial parsing: updated file: de_test_dwh://models/finance/marts/schema.yml
[0m16:38:59.352681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12775d690>]}
[0m16:38:59.510980 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:38:59.514267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:38:59.575834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12732ca60>]}
[0m16:38:59.577179 [info ] [MainThread]: Found 12 models, 18 data tests, 3 sources, 624 macros
[0m16:38:59.578322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12734a3e0>]}
[0m16:38:59.581805 [info ] [MainThread]: 
[0m16:38:59.582592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:59.583079 [info ] [MainThread]: 
[0m16:38:59.584088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:59.595635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_mart'
[0m16:38:59.596502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:00.194224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now list_cusma-383203_dwh_dev_staging)
[0m16:39:00.197761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:00.786950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m16:39:00.788288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:01.412736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083430d4-d967-4224-9e18-c96012ecabc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126d061d0>]}
[0m16:39:01.413671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:01.469459 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:39:01.471180 [info ] [Thread-1 (]: 1 of 18 START test not_null_dim_currencies_currency ............................ [RUN]
[0m16:39:01.473975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648)
[0m16:39:01.474983 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:39:01.507935 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m16:39:01.509468 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:39:01.542414 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m16:39:01.543637 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select currency
from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
where currency is null



  
  
      
    ) dbt_internal_test
[0m16:39:01.544449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:02.312647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9f2790e7-11b3-4c1a-8179-a1b15556002d&page=queryresults
[0m16:39:02.886410 [info ] [Thread-1 (]: 1 of 18 PASS not_null_dim_currencies_currency .................................. [[32mPASS[0m in 1.41s]
[0m16:39:02.888347 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:39:02.889424 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:39:02.890668 [info ] [Thread-1 (]: 2 of 18 START test not_null_dim_date_date ...................................... [RUN]
[0m16:39:02.891446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m16:39:02.892169 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:39:02.899388 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m16:39:02.901179 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:39:02.909019 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m16:39:02.910311 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `cusma-383203`.`dwh_dev_mart`.`dim_date`
where date is null



  
  
      
    ) dbt_internal_test
[0m16:39:02.911330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:03.804741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:d80fad67-0663-4220-ba52-18e5f3235d9a&page=queryresults
[0m16:39:04.287472 [info ] [Thread-1 (]: 2 of 18 PASS not_null_dim_date_date ............................................ [[32mPASS[0m in 1.40s]
[0m16:39:04.289302 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:39:04.290236 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:39:04.291228 [info ] [Thread-1 (]: 3 of 18 START test not_null_dim_users_effective_from ........................... [RUN]
[0m16:39:04.292302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m16:39:04.293136 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:39:04.302079 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m16:39:04.303374 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:39:04.307856 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m16:39:04.308977 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_from
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_from is null



  
  
      
    ) dbt_internal_test
[0m16:39:04.309661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:05.079260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:92e6c791-9883-4ff0-8e20-dab5669d31f6&page=queryresults
[0m16:39:05.585625 [info ] [Thread-1 (]: 3 of 18 PASS not_null_dim_users_effective_from ................................. [[32mPASS[0m in 1.29s]
[0m16:39:05.587127 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:39:05.587955 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:39:05.589400 [info ] [Thread-1 (]: 4 of 18 START test not_null_dim_users_effective_to ............................. [RUN]
[0m16:39:05.590253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m16:39:05.590963 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:39:05.598365 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m16:39:05.599639 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:39:05.605950 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m16:39:05.607146 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_to
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where effective_to is null



  
  
      
    ) dbt_internal_test
[0m16:39:05.608099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:06.405136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:dec39f46-32b2-4fc5-902f-00f84b16d553&page=queryresults
[0m16:39:06.909693 [info ] [Thread-1 (]: 4 of 18 PASS not_null_dim_users_effective_to ................................... [[32mPASS[0m in 1.32s]
[0m16:39:06.911131 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:39:06.911682 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:39:06.912235 [info ] [Thread-1 (]: 5 of 18 START test not_null_dim_users_kyc_level ................................ [RUN]
[0m16:39:06.912951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m16:39:06.913408 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:39:06.925938 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m16:39:06.927253 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:39:06.930734 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m16:39:06.932570 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_kyc_level.552489338e: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kyc_level
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where kyc_level is null



  
  
      
    ) dbt_internal_test
[0m16:39:06.933682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:07.634242 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:01b25809-bfa8-4ade-b2b0-cc16f5c5eb30&page=queryresults
[0m16:39:08.099070 [info ] [Thread-1 (]: 5 of 18 PASS not_null_dim_users_kyc_level ...................................... [[32mPASS[0m in 1.19s]
[0m16:39:08.100699 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:39:08.102865 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:39:08.104477 [info ] [Thread-1 (]: 6 of 18 START test not_null_dim_users_user_id .................................. [RUN]
[0m16:39:08.106015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m16:39:08.107859 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:39:08.116638 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m16:39:08.117687 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:39:08.121995 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m16:39:08.123443 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:39:08.125134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:08.754751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:96d9545e-77d1-4442-8f43-fd44fdfd7f1b&page=queryresults
[0m16:39:09.241389 [info ] [Thread-1 (]: 6 of 18 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 1.14s]
[0m16:39:09.249558 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:39:09.251584 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:39:09.252685 [info ] [Thread-1 (]: 7 of 18 START test not_null_dim_users_user_kyc_key ............................. [RUN]
[0m16:39:09.253710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m16:39:09.255208 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:39:09.275125 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m16:39:09.276717 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:39:09.281738 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m16:39:09.283420 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_kyc_key
from `cusma-383203`.`dwh_dev_mart`.`dim_users`
where user_kyc_key is null



  
  
      
    ) dbt_internal_test
[0m16:39:09.284437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:09.934118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:52da8d9f-bb6c-4b0c-b2b1-0d3f207082f1&page=queryresults
[0m16:39:10.387811 [info ] [Thread-1 (]: 7 of 18 PASS not_null_dim_users_user_kyc_key ................................... [[32mPASS[0m in 1.13s]
[0m16:39:10.389904 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:39:10.391513 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:39:10.392465 [info ] [Thread-1 (]: 8 of 18 START test not_null_fct_transactions_txn_id ............................ [RUN]
[0m16:39:10.393297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m16:39:10.394068 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:39:10.401251 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:39:10.402752 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:39:10.409756 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:39:10.411488 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:39:10.413031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:11.220887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:71e1b389-6cc8-47c6-9c58-8c6b2ecbfc78&page=queryresults
[0m16:39:11.700686 [info ] [Thread-1 (]: 8 of 18 PASS not_null_fct_transactions_txn_id .................................. [[32mPASS[0m in 1.31s]
[0m16:39:11.701902 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:39:11.702625 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:39:11.703350 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_rates_close_price .............................. [RUN]
[0m16:39:11.704593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m16:39:11.705777 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:39:11.713375 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:39:11.714934 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:39:11.718884 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:39:11.719992 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select close_price
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where close_price is null



  
  
      
    ) dbt_internal_test
[0m16:39:11.720610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:12.860630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:03bd25c6-39b8-4b32-8630-cf002dd0bb70&page=queryresults
[0m16:39:13.300648 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_rates_close_price .................................... [[32mPASS[0m in 1.60s]
[0m16:39:13.302670 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:39:13.304362 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:39:13.305480 [info ] [Thread-1 (]: 10 of 18 START test not_null_stg_rates_symbol .................................. [RUN]
[0m16:39:13.307492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m16:39:13.309143 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:39:13.322775 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:39:13.324362 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:39:13.329811 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:39:13.331006 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from `cusma-383203`.`dwh_dev_staging`.`stg_rates`
where symbol is null



  
  
      
    ) dbt_internal_test
[0m16:39:13.332066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:14.394109 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a917be03-78bc-42e3-8269-1f2e7c7f15f3&page=queryresults
[0m16:39:14.839239 [info ] [Thread-1 (]: 10 of 18 PASS not_null_stg_rates_symbol ........................................ [[32mPASS[0m in 1.53s]
[0m16:39:14.840840 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:39:14.842212 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:39:14.843245 [info ] [Thread-1 (]: 11 of 18 START test not_null_stg_transactions_txn_id ........................... [RUN]
[0m16:39:14.844162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m16:39:14.844875 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:39:14.855256 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:39:14.858069 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:39:14.861989 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:39:14.863133 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m16:39:14.864292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:16.545868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:70587a09-3359-4e7f-bf17-585ff0b550d9&page=queryresults
[0m16:39:17.009751 [info ] [Thread-1 (]: 11 of 18 PASS not_null_stg_transactions_txn_id ................................. [[32mPASS[0m in 2.17s]
[0m16:39:17.011999 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:39:17.013062 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:39:17.014092 [info ] [Thread-1 (]: 12 of 18 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:39:17.015186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m16:39:17.015919 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:39:17.027572 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:39:17.028749 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:39:17.032652 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:39:17.033661 [debug] [Thread-1 (]: On test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `cusma-383203`.`dwh_dev_staging`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:39:17.034384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:18.079617 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:1474127b-ca08-4219-9ac5-b264a98efe97&page=queryresults
[0m16:39:18.535765 [info ] [Thread-1 (]: 12 of 18 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 1.52s]
[0m16:39:18.536734 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:39:18.537287 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:39:18.537908 [info ] [Thread-1 (]: 13 of 18 START test unique_dim_currencies_currency ............................. [RUN]
[0m16:39:18.538637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m16:39:18.539117 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:39:18.549642 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m16:39:18.551025 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:39:18.555866 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m16:39:18.557554 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_currencies_currency.20f50226d8: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select currency as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`
  where currency is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:18.558224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:19.256935 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a6b58edb-601d-4778-8c7f-51b5a61237a0&page=queryresults
[0m16:39:19.717081 [info ] [Thread-1 (]: 13 of 18 PASS unique_dim_currencies_currency ................................... [[32mPASS[0m in 1.18s]
[0m16:39:19.718254 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:39:19.718942 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:39:19.719811 [info ] [Thread-1 (]: 14 of 18 START test unique_dim_date_date ....................................... [RUN]
[0m16:39:19.720715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m16:39:19.721275 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:39:19.727259 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m16:39:19.728223 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:39:19.732660 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m16:39:19.733963 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select date as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_date`
  where date is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:19.734708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:20.539314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:3d011617-ea38-47dc-9f9c-9ea7b44daaf0&page=queryresults
[0m16:39:21.014613 [info ] [Thread-1 (]: 14 of 18 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.29s]
[0m16:39:21.016312 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:39:21.017700 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:39:21.019225 [info ] [Thread-1 (]: 15 of 18 START test unique_dim_users_user_kyc_key .............................. [RUN]
[0m16:39:21.020566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m16:39:21.021424 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:39:21.028817 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m16:39:21.029965 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:39:21.034027 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m16:39:21.035191 [debug] [Thread-1 (]: On test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_kyc_key as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`dim_users`
  where user_kyc_key is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:21.035831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:21.868858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:55f6d6fe-837b-41e9-b95e-9821b6490e22&page=queryresults
[0m16:39:22.331340 [info ] [Thread-1 (]: 15 of 18 PASS unique_dim_users_user_kyc_key .................................... [[32mPASS[0m in 1.31s]
[0m16:39:22.333200 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:39:22.334484 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:39:22.335924 [info ] [Thread-1 (]: 16 of 18 START test unique_fct_transactions_txn_id ............................. [RUN]
[0m16:39:22.337112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m16:39:22.337941 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:39:22.345719 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:39:22.347082 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:39:22.351745 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:39:22.353317 [debug] [Thread-1 (]: On test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:22.354456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:23.100047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e21712a8-f0da-46c5-bf86-60bb15ebbff2&page=queryresults
[0m16:39:23.562408 [info ] [Thread-1 (]: 16 of 18 PASS unique_fct_transactions_txn_id ................................... [[32mPASS[0m in 1.23s]
[0m16:39:23.563900 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:39:23.564670 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:39:23.565524 [info ] [Thread-1 (]: 17 of 18 START test unique_stg_transactions_txn_id ............................. [RUN]
[0m16:39:23.566634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m16:39:23.567808 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:39:23.573934 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:39:23.575448 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:39:23.581807 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:39:23.583458 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select txn_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`
  where txn_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:23.584615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:24.530880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:e3092e5b-7d14-4802-b0d9-1fe40dad9a73&page=queryresults
[0m16:39:24.969454 [info ] [Thread-1 (]: 17 of 18 PASS unique_stg_transactions_txn_id ................................... [[32mPASS[0m in 1.40s]
[0m16:39:24.970505 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:39:24.971092 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:39:24.971768 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_users_user_id ................................... [RUN]
[0m16:39:24.972465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m16:39:24.973106 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:39:24.979746 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:39:24.981930 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:39:24.987072 [debug] [Thread-1 (]: Writing runtime sql for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:39:24.988327 [debug] [Thread-1 (]: On test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "node_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `cusma-383203`.`dwh_dev_staging`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:39:24.988973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:26.066448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:6228f8a4-4454-4472-b8c7-4e21393bfe2a&page=queryresults
[0m16:39:26.534318 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 1.56s]
[0m16:39:26.535573 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:39:26.537663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:26.627485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:26.629282 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m16:39:26.631100 [info ] [MainThread]: 
[0m16:39:26.632447 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 27.05 seconds (27.05s).
[0m16:39:26.638234 [debug] [MainThread]: Command end result
[0m16:39:26.691077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:39:26.694777 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:39:26.707173 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:39:26.707848 [info ] [MainThread]: 
[0m16:39:26.708441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:26.708916 [info ] [MainThread]: 
[0m16:39:26.709428 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m16:39:26.713637 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 34.594128, "process_in_blocks": "0", "process_kernel_time": 1.902224, "process_mem_max_rss": "366436352", "process_out_blocks": "0", "process_user_time": 11.402065}
[0m16:39:26.715545 [debug] [MainThread]: Command `dbt test` succeeded at 16:39:26.715133 after 34.60 seconds
[0m16:39:26.716330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043d64a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f18640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12732ef80>]}
[0m16:39:26.717104 [debug] [MainThread]: Flushing usage events
[0m16:39:28.142646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:26.152292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cabe4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac1570>]}


============================== 16:55:26.160434 | ccbae5ef-c654-495d-a219-c35aef145e58 ==============================
[0m16:55:26.160434 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:55:26.161573 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True'}
[0m16:55:33.163827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09ae60>]}
[0m16:55:33.258576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f42ce20>]}
[0m16:55:33.259653 [info ] [MainThread]: Registered adapter: bigquery=1.10.3
[0m16:55:33.673925 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m16:55:34.268213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:34.269113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:34.352692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fad4a90>]}
[0m16:55:34.417604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa432b0>]}
[0m16:55:34.418669 [info ] [MainThread]: Found 12 models, 18 data tests, 3 sources, 624 macros
[0m16:55:34.419386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa43430>]}
[0m16:55:34.423376 [info ] [MainThread]: 
[0m16:55:34.424175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:34.424953 [info ] [MainThread]: 
[0m16:55:34.425702 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:55:34.433315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_cusma-383203_dwh_dev_staging'
[0m16:55:34.434014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:35.233195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_staging, now list_cusma-383203_dwh_dev_intermediate)
[0m16:55:35.235802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:35.861016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_intermediate, now list_cusma-383203_dwh_dev_mart)
[0m16:55:35.863491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:36.567508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccbae5ef-c654-495d-a219-c35aef145e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b14fbb0>]}
[0m16:55:36.568788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:36.625389 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_rates
[0m16:55:36.626370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_cusma-383203_dwh_dev_mart, now model.de_test_dwh.stg_rates)
[0m16:55:36.626901 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_rates
[0m16:55:36.643532 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_rates"
[0m16:55:36.645066 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_rates
[0m16:55:36.645923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.692833 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_rates
[0m16:55:36.693445 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_transactions
[0m16:55:36.694353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_rates, now model.de_test_dwh.stg_transactions)
[0m16:55:36.695023 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_transactions
[0m16:55:36.700074 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_transactions"
[0m16:55:36.701003 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_transactions
[0m16:55:36.701576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.749054 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_transactions
[0m16:55:36.749745 [debug] [Thread-1 (]: Began running node model.de_test_dwh.stg_users
[0m16:55:36.750570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_transactions, now model.de_test_dwh.stg_users)
[0m16:55:36.751078 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.stg_users
[0m16:55:36.756752 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.stg_users"
[0m16:55:36.757667 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.stg_users
[0m16:55:36.758158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.802359 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.stg_users
[0m16:55:36.802997 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_rates_usdt
[0m16:55:36.803866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.stg_users, now model.de_test_dwh.int_rates_usdt)
[0m16:55:36.804423 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_rates_usdt
[0m16:55:36.808594 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_rates_usdt"
[0m16:55:36.809556 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_rates_usdt
[0m16:55:36.810097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.854486 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_rates_usdt
[0m16:55:36.855193 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:55:36.856019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_rates_usdt, now test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a)
[0m16:55:36.856506 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:55:36.871007 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a"
[0m16:55:36.875216 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:55:36.876040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.920613 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a
[0m16:55:36.921282 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:55:36.921993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a, now test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5)
[0m16:55:36.922576 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:55:36.928434 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5"
[0m16:55:36.931068 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:55:36.931891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:36.978515 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5
[0m16:55:36.979696 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_currencies
[0m16:55:36.980689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5, now model.de_test_dwh.dim_currencies)
[0m16:55:36.981394 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_currencies
[0m16:55:36.986578 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_currencies"
[0m16:55:36.989268 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_currencies
[0m16:55:36.989959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.039148 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_currencies
[0m16:55:37.039813 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_date
[0m16:55:37.040581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_currencies, now model.de_test_dwh.dim_date)
[0m16:55:37.041118 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_date
[0m16:55:37.048701 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_date"
[0m16:55:37.050550 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_date
[0m16:55:37.051688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.099808 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_date
[0m16:55:37.100548 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:55:37.101551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_date, now test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957)
[0m16:55:37.102460 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:55:37.109297 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957"
[0m16:55:37.111043 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:55:37.111913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.160324 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957
[0m16:55:37.161475 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:55:37.162536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957, now test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7)
[0m16:55:37.163195 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:55:37.173036 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7"
[0m16:55:37.174286 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:55:37.175507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.224459 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7
[0m16:55:37.225524 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_users_scd2
[0m16:55:37.226722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7, now model.de_test_dwh.int_users_scd2)
[0m16:55:37.227491 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_users_scd2
[0m16:55:37.252719 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_users_scd2"
[0m16:55:37.253730 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_users_scd2
[0m16:55:37.254529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.302668 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_users_scd2
[0m16:55:37.303591 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:55:37.305204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_users_scd2, now test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77)
[0m16:55:37.306084 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:55:37.314469 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77"
[0m16:55:37.315628 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:55:37.316375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.364277 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77
[0m16:55:37.365005 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:55:37.365824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77, now test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b)
[0m16:55:37.366421 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:55:37.373081 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b"
[0m16:55:37.374326 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:55:37.375558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.422556 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b
[0m16:55:37.423622 [debug] [Thread-1 (]: Began running node model.de_test_dwh.int_transactions_with_rates
[0m16:55:37.424957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b, now model.de_test_dwh.int_transactions_with_rates)
[0m16:55:37.425725 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.int_transactions_with_rates
[0m16:55:37.431316 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.int_transactions_with_rates"
[0m16:55:37.433540 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.int_transactions_with_rates
[0m16:55:37.434442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.484304 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.int_transactions_with_rates
[0m16:55:37.485468 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:55:37.486330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.int_transactions_with_rates, now test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648)
[0m16:55:37.487173 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:55:37.494522 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648"
[0m16:55:37.496029 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:55:37.497010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.543600 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648
[0m16:55:37.544593 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:55:37.545636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648, now test.de_test_dwh.unique_dim_currencies_currency.20f50226d8)
[0m16:55:37.546471 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:55:37.553538 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8"
[0m16:55:37.556618 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:55:37.557512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.606502 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_currencies_currency.20f50226d8
[0m16:55:37.607307 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:55:37.608325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_currencies_currency.20f50226d8, now test.de_test_dwh.not_null_dim_date_date.78f11e7735)
[0m16:55:37.609000 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:55:37.617471 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_date_date.78f11e7735"
[0m16:55:37.619741 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:55:37.620367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.665905 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_date_date.78f11e7735
[0m16:55:37.666508 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:55:37.667090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_date_date.78f11e7735, now test.de_test_dwh.unique_dim_date_date.dd069a8d31)
[0m16:55:37.667619 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:55:37.673477 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_date_date.dd069a8d31"
[0m16:55:37.674809 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:55:37.675372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.723748 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_date_date.dd069a8d31
[0m16:55:37.724706 [debug] [Thread-1 (]: Began running node model.de_test_dwh.dim_users
[0m16:55:37.726015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_date_date.dd069a8d31, now model.de_test_dwh.dim_users)
[0m16:55:37.726790 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.dim_users
[0m16:55:37.732319 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.dim_users"
[0m16:55:37.733822 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.dim_users
[0m16:55:37.734761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.786415 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.dim_users
[0m16:55:37.788085 [debug] [Thread-1 (]: Began running node model.de_test_dwh.fct_transactions
[0m16:55:37.789305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.dim_users, now model.de_test_dwh.fct_transactions)
[0m16:55:37.790415 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.fct_transactions
[0m16:55:37.796557 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.fct_transactions"
[0m16:55:37.798182 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.fct_transactions
[0m16:55:37.798923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.849468 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.fct_transactions
[0m16:55:37.850217 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:55:37.851146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.fct_transactions, now test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289)
[0m16:55:37.852000 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:55:37.861792 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289"
[0m16:55:37.863410 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:55:37.864385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.910920 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289
[0m16:55:37.911685 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:55:37.912316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289, now test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181)
[0m16:55:37.912795 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:55:37.919141 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181"
[0m16:55:37.920798 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:55:37.921385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:37.968470 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181
[0m16:55:37.969611 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:55:37.970677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181, now test.de_test_dwh.not_null_dim_users_kyc_level.552489338e)
[0m16:55:37.971225 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:55:37.978743 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e"
[0m16:55:37.980034 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:55:37.980917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.028342 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_kyc_level.552489338e
[0m16:55:38.029062 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:55:38.029740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_kyc_level.552489338e, now test.de_test_dwh.not_null_dim_users_user_id.e754bb5812)
[0m16:55:38.030238 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:55:38.035799 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812"
[0m16:55:38.036917 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:55:38.037523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.084622 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_id.e754bb5812
[0m16:55:38.085277 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:55:38.086425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_id.e754bb5812, now test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625)
[0m16:55:38.087431 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:55:38.093552 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625"
[0m16:55:38.094762 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:55:38.095832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.139924 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625
[0m16:55:38.140643 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:55:38.141350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625, now test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6)
[0m16:55:38.141848 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:55:38.147177 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6"
[0m16:55:38.148151 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:55:38.148793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.194397 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6
[0m16:55:38.195095 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:55:38.195785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6, now model.de_test_dwh.tb_transactions_by_kyc)
[0m16:55:38.196341 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_by_kyc
[0m16:55:38.203031 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_by_kyc"
[0m16:55:38.207447 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_by_kyc
[0m16:55:38.209637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.255991 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_by_kyc
[0m16:55:38.256699 [debug] [Thread-1 (]: Began running node model.de_test_dwh.tb_transactions_tracking
[0m16:55:38.257500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_by_kyc, now model.de_test_dwh.tb_transactions_tracking)
[0m16:55:38.258026 [debug] [Thread-1 (]: Began compiling node model.de_test_dwh.tb_transactions_tracking
[0m16:55:38.263259 [debug] [Thread-1 (]: Writing injected SQL for node "model.de_test_dwh.tb_transactions_tracking"
[0m16:55:38.264155 [debug] [Thread-1 (]: Began executing node model.de_test_dwh.tb_transactions_tracking
[0m16:55:38.264718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.308291 [debug] [Thread-1 (]: Finished running node model.de_test_dwh.tb_transactions_tracking
[0m16:55:38.308970 [debug] [Thread-1 (]: Began running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:55:38.309748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.de_test_dwh.tb_transactions_tracking, now test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d)
[0m16:55:38.310377 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:55:38.315547 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d"
[0m16:55:38.316506 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:55:38.317056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.361517 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d
[0m16:55:38.362163 [debug] [Thread-1 (]: Began running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:55:38.362887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d, now test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480)
[0m16:55:38.363420 [debug] [Thread-1 (]: Began compiling node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:55:38.368666 [debug] [Thread-1 (]: Writing injected SQL for node "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480"
[0m16:55:38.371104 [debug] [Thread-1 (]: Began executing node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:55:38.371862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:38.416574 [debug] [Thread-1 (]: Finished running node test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480
[0m16:55:38.418670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:38.419229 [debug] [MainThread]: Connection 'test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480' was properly closed.
[0m16:55:38.424793 [debug] [MainThread]: Command end result
[0m16:55:38.574331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:55:38.578021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:55:38.594919 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tamdang/Documents/DE_Test/DE_test/target/run_results.json
[0m16:55:38.603687 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:55:38.604265 [info ] [MainThread]: Building catalog
[0m16:55:38.613927 [debug] [ThreadPool]: Acquiring new bigquery connection 'cusma-383203.information_schema'
[0m16:55:38.636899 [debug] [ThreadPool]: On cusma-383203.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "cusma-383203.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cusma-383203`.`dwh_dev_staging`.__TABLES__ tables
    left join `cusma-383203`.`dwh_dev_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cusma-383203`.`dwh_dev_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dwh_dev_staging')
                            and upper(table_name) = upper('stg_rates')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_staging')
                            and upper(table_name) = upper('stg_transactions')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_staging')
                            and upper(table_name) = upper('stg_users')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cusma-383203`.`dwh_dev_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `cusma-383203`.`dwh_dev_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:55:38.638733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:39.418623 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:367f0667-5f64-42a1-8165-22f7eb94ddaa&page=queryresults
[0m16:55:40.819633 [debug] [ThreadPool]: On cusma-383203.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "cusma-383203.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cusma-383203`.`dwh_dev_intermediate`.__TABLES__ tables
    left join `cusma-383203`.`dwh_dev_intermediate`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cusma-383203`.`dwh_dev_intermediate`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dwh_dev_intermediate')
                            and upper(table_name) = upper('int_rates_usdt')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_intermediate')
                            and upper(table_name) = upper('int_transactions_with_rates')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_intermediate')
                            and upper(table_name) = upper('int_users_scd2')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cusma-383203`.`dwh_dev_intermediate`.INFORMATION_SCHEMA.COLUMNS columns
    join `cusma-383203`.`dwh_dev_intermediate`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:55:40.821010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:41.696031 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:bcbad1f7-6ed1-4878-9d0e-b6fedb3ebb48&page=queryresults
[0m16:55:43.313540 [debug] [ThreadPool]: On cusma-383203.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "cusma-383203.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cusma-383203`.`dwh_dev_mart`.__TABLES__ tables
    left join `cusma-383203`.`dwh_dev_mart`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cusma-383203`.`dwh_dev_mart`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('dim_users')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('tb_transactions_by_kyc')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('dim_date')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('tb_transactions_tracking')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('fct_transactions')
                            ) or (
                                upper(table_schema) = upper('dwh_dev_mart')
                            and upper(table_name) = upper('dim_currencies')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cusma-383203`.`dwh_dev_mart`.INFORMATION_SCHEMA.COLUMNS columns
    join `cusma-383203`.`dwh_dev_mart`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:55:43.315581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:44.239067 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:a830daca-a132-4fe2-9874-b5158c2cbf38&page=queryresults
[0m16:55:45.648199 [debug] [ThreadPool]: On cusma-383203.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "de_test_dwh", "target_name": "dev", "connection_name": "cusma-383203.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `cusma-383203`.`raw_data`.__TABLES__ tables
    left join `cusma-383203`.`raw_data`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `cusma-383203`.`raw_data`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('raw_data')
                            and upper(table_name) = upper('transaction')
                            ) or (
                                upper(table_schema) = upper('raw_data')
                            and upper(table_name) = upper('rates')
                            ) or (
                                upper(table_schema) = upper('raw_data')
                            and upper(table_name) = upper('users')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `cusma-383203`.`raw_data`.INFORMATION_SCHEMA.COLUMNS columns
    join `cusma-383203`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m16:55:45.649702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:46.486610 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=cusma-383203&j=bq:asia-southeast1:9a5b64b1-4836-4069-9b41-56fe908f05da&page=queryresults
[0m16:55:47.841525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:47.904891 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/tamdang/Documents/DE_Test/DE_test/target/catalog.json
[0m16:55:47.947564 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/manifest.json
[0m16:55:47.949825 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tamdang/Documents/DE_Test/DE_test/target/semantic_manifest.json
[0m16:55:47.950339 [info ] [MainThread]: Catalog written to /Users/tamdang/Documents/DE_Test/DE_test/target/catalog.json
[0m16:55:47.959680 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 21.913538, "process_in_blocks": "0", "process_kernel_time": 1.796753, "process_mem_max_rss": "358248448", "process_out_blocks": "0", "process_user_time": 9.802992}
[0m16:55:47.960429 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:55:47.960303 after 21.91 seconds
[0m16:55:47.960967 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:55:47.961408 [debug] [MainThread]: Connection 'cusma-383203.information_schema' was properly closed.
[0m16:55:47.961953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cabe4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d35ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc92950>]}
[0m16:55:47.962692 [debug] [MainThread]: Flushing usage events
[0m16:55:49.350488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:37.867647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e44dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e45270>]}


============================== 16:56:37.875335 | bfcbce5b-2f57-42ba-a26b-491d181b4bce ==============================
[0m16:56:37.875335 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m16:56:37.876480 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'None', 'introspect': 'True', 'profiles_dir': '/Users/tamdang/Documents/DE_Test/DE_test', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt docs serve', 'fail_fast': 'False', 'log_path': '/Users/tamdang/Documents/DE_Test/DE_test/logs', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True'}
[0m16:56:44.294277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfcbce5b-2f57-42ba-a26b-491d181b4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a79a560>]}
[0m16:56:44.364943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfcbce5b-2f57-42ba-a26b-491d181b4bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c2350>]}
[0m16:57:23.073213 [error] [MainThread]: Encountered an error:

[0m16:57:23.083831 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/anaconda3/envs/airflow310/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:57:23.091201 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 45.322506, "process_in_blocks": "0", "process_kernel_time": 1.532585, "process_mem_max_rss": "338087936", "process_out_blocks": "0", "process_user_time": 5.966187}
[0m16:57:23.093420 [debug] [MainThread]: Command `dbt docs serve` failed at 16:57:23.093116 after 45.33 seconds
[0m16:57:23.094308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a993490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a993580>]}
[0m16:57:23.095086 [debug] [MainThread]: Flushing usage events
[0m16:57:24.382879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:50.761606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4950fcc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4952831100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4951130770>]}


============================== 11:44:50.792280 | ec0fd02f-e037-414d-8d92-ab3f87d76fc3 ==============================
[0m11:44:50.792280 [info ] [MainThread]: Running with dbt=1.7.19
[0m11:44:50.793686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/opt/airflow', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:50.796040 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m11:44:50.797927 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.0928845, "process_user_time": 6.439099, "process_kernel_time": 1.126812, "process_mem_max_rss": "154092", "process_out_blocks": "3610", "command_success": false, "process_in_blocks": "0"}
[0m11:44:50.799414 [debug] [MainThread]: Command `dbt deps` failed at 11:44:50.799183 after 0.09 seconds
[0m11:44:50.800722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4950ec99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4950fcc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4951130770>]}
[0m11:44:50.801863 [debug] [MainThread]: Flushing usage events
