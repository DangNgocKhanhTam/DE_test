{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b4", "generated_at": "2025-11-19T09:55:38.419629Z", "invocation_id": "ccbae5ef-c654-495d-a219-c35aef145e58", "invocation_started_at": "2025-11-19T09:55:26.110173Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.627221Z", "completed_at": "2025-11-19T09:55:36.644844Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.645558Z", "completed_at": "2025-11-19T09:55:36.645616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06623697280883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.stg_rates", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `cusma-383203`.`raw_data`.`rates`\n),\n\nrenamed as (\n    select\n        cast(symbol as string) as symbol,\n        cast(open_time as int64) as open_time,\n        cast(close as float64) as close_price,\n        cast(open as float64) as open_price,\n        cast(high as float64) as high_price,\n        cast(low as float64) as low_price,\n        cast(volume as float64) as volume,\n        cast(close_time as int64) as close_time,\n        cast(quote_volume as float64) as quote_volume,\n        cast(trades as int64) as trades,\n        timestamp_millis(cast(open_time as int64)) as price_timestamp,\n        timestamp_millis(cast(close_time as int64)) as close_timestamp\n    from source\n)\n\nselect * from renamed", "relation_name": "`cusma-383203`.`dwh_dev_staging`.`stg_rates`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.695415Z", "completed_at": "2025-11-19T09:55:36.700849Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.701423Z", "completed_at": "2025-11-19T09:55:36.701438Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05445122718811035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.stg_transactions", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `cusma-383203`.`raw_data`.`transaction`\n),\n\nrenamed as (\n    select\n        cast(txn_id as int64) as txn_id,\n        cast(user_id as int64) as user_id,\n        cast(status as string) as status,\n        cast(source_currency as string) as source_currency,\n        cast(destination_currency as string) as destination_currency,\n        cast(created_at as timestamp) as created_at,\n        cast(source_amount as float64) as source_amount,\n        cast(destination_amount as float64) as destination_amount\n    from source\n)\n\nselect * from renamed", "relation_name": "`cusma-383203`.`dwh_dev_staging`.`stg_transactions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.751402Z", "completed_at": "2025-11-19T09:55:36.757516Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.758012Z", "completed_at": "2025-11-19T09:55:36.758026Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0515131950378418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.stg_users", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from `cusma-383203`.`raw_data`.`users`\n),\n\nrenamed as (\n    select\n        cast(user_id as int64) as user_id,\n        cast(kyc_level as int64) as kyc_level,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from source\n)\n\nselect * from renamed", "relation_name": "`cusma-383203`.`dwh_dev_staging`.`stg_users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.804740Z", "completed_at": "2025-11-19T09:55:36.809403Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.809941Z", "completed_at": "2025-11-19T09:55:36.809956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05039691925048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.int_rates_usdt", "compiled": true, "compiled_code": "\n\n\nwith rates as (\n    select * from `cusma-383203`.`dwh_dev_staging`.`stg_rates`\n),\n\nparsed_rates as (\n    select\n        symbol,\n        regexp_extract(symbol, r'^(.+)USDT$') as currency,\n        close_price as usdt_price,\n        price_timestamp,\n        close_timestamp, \n        DATE(price_timestamp) as price_date\n    from rates\n    where symbol like '%USDT'\n)\n    select\n        currency,\n        usdt_price,\n        price_timestamp,\n        close_timestamp,\n        symbol,\n        price_date\n\n    from parsed_rates\n    where currency is not null", "relation_name": "`cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.856825Z", "completed_at": "2025-11-19T09:55:36.874515Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.875873Z", "completed_at": "2025-11-19T09:55:36.875890Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06434011459350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_stg_rates_close_price.864a2dc66a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect close_price\nfrom `cusma-383203`.`dwh_dev_staging`.`stg_rates`\nwhere close_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.923060Z", "completed_at": "2025-11-19T09:55:36.930778Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.931711Z", "completed_at": "2025-11-19T09:55:36.931731Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05584096908569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_stg_rates_symbol.ede457d5c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect symbol\nfrom `cusma-383203`.`dwh_dev_staging`.`stg_rates`\nwhere symbol is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:36.981876Z", "completed_at": "2025-11-19T09:55:36.988966Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:36.989784Z", "completed_at": "2025-11-19T09:55:36.989802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05829286575317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.dim_currencies", "compiled": true, "compiled_code": "\n\n\nwith transactions as (\n    select distinct\n        source_currency as currency\n    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\n    \n    union distinct\n    \n    select distinct\n        destination_currency as currency\n    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\n)\n\nselect\n    currency,\n    currency as currency_code,\n    case\n        when currency = 'USDT' then 'Tether'\n        when currency = 'BTC' then 'Bitcoin'\n        when currency = 'ETH' then 'Ethereum'\n        when currency = 'BNB' then 'Binance Coin'\n        when currency = 'ADA' then 'Cardano'\n        when currency = 'SOL' then 'Solana'\n        when currency = 'DOGE' then 'Dogecoin'\n        when currency = 'SHIB' then 'Shiba Inu'\n        when currency = 'UNI' then 'Uniswap'\n        when currency = 'NGN' then 'Nigerian Naira'\n        else 'Unknown'\n    end as currency_name\nfrom transactions\nwhere currency is not null\norder by currency", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`dim_currencies`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.041492Z", "completed_at": "2025-11-19T09:55:37.050185Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.051414Z", "completed_at": "2025-11-19T09:55:37.051441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05899786949157715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.dim_date", "compiled": true, "compiled_code": "\n\n\nwith date_range as (\n    select\n        min(date(created_at)) as start_date,\n        max(date(created_at)) as end_date\n    from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\n),\n\ndate_series as (\n    select\n        date_add(start_date, interval day_offset day) as date\n    from date_range,\n    unnest(generate_array(0, date_diff(end_date, start_date, day))) as day_offset\n)\n\nselect\n    date,\n    extract(year from date) as year,\n    extract(quarter from date) as quarter,\n    extract(month from date) as month,\n    extract(day from date) as day,\n    extract(dayofweek from date) as day_of_week,\n    format_date('%A', date) as day_name,\n    format_date('%B', date) as month_name,\n    extract(week from date) as week_of_year,\n    extract(dayofyear from date) as day_of_year,\n    case\n        when extract(dayofweek from date) in (1, 7) then true\n        else false\n    end as is_weekend\nfrom date_series", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`dim_date`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.102855Z", "completed_at": "2025-11-19T09:55:37.110723Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.111624Z", "completed_at": "2025-11-19T09:55:37.111647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.058593034744262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_stg_transactions_txn_id.76ab070957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect txn_id\nfrom `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\nwhere txn_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.163677Z", "completed_at": "2025-11-19T09:55:37.173958Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.175052Z", "completed_at": "2025-11-19T09:55:37.175100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06145930290222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_stg_transactions_txn_id.be9177e8f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select txn_id as unique_field\n  from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\n  where txn_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.228072Z", "completed_at": "2025-11-19T09:55:37.253555Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.254286Z", "completed_at": "2025-11-19T09:55:37.254304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07580995559692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.int_users_scd2", "compiled": true, "compiled_code": "\n\nwith users as (\n    select * from `cusma-383203`.`dwh_dev_staging`.`stg_users`\n),\n\nuser_periods as (\n    select\n        user_id,\n        kyc_level,\n        created_at as period_start,\n        coalesce(updated_at, timestamp('9999-12-31 23:59:59')) as period_end,\n        updated_at as last_updated,\n        case\n            when updated_at is null or updated_at = created_at then true\n            else false\n        end as is_current_period\n    from users\n),\n\nfinal as (\n    select\n        to_hex(md5(cast(coalesce(cast(user_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(period_start as string), '_dbt_utils_surrogate_key_null_') as string))) as user_kyc_key,\n        user_id,\n        kyc_level,\n        period_start as effective_from,\n        period_end as effective_to,\n        last_updated,\n        is_current_period as is_current,\n        timestamp_diff(period_end, period_start, second) as duration_seconds\n    from user_periods\n)\n\nselect * \nfrom final\norder by user_id, effective_from", "relation_name": "`cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.306601Z", "completed_at": "2025-11-19T09:55:37.315437Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.316205Z", "completed_at": "2025-11-19T09:55:37.316223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059172868728637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_stg_users_user_id.980dfc1b77", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `cusma-383203`.`dwh_dev_staging`.`stg_users`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.366779Z", "completed_at": "2025-11-19T09:55:37.374071Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.375214Z", "completed_at": "2025-11-19T09:55:37.375260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.056446075439453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_stg_users_user_id.c2ff477e6b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select user_id as unique_field\n  from `cusma-383203`.`dwh_dev_staging`.`stg_users`\n  where user_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.426235Z", "completed_at": "2025-11-19T09:55:37.433192Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.434176Z", "completed_at": "2025-11-19T09:55:37.434193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05928802490234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.int_transactions_with_rates", "compiled": true, "compiled_code": "\n\nwith transactions as (\n    select * from `cusma-383203`.`dwh_dev_staging`.`stg_transactions`\n),\n\nrates as (\n    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_rates_usdt`\n),\n\nlatest_source_rate as (\n    select\n        t.txn_id,\n        r.usdt_price as source_usdt_price,\n        r.price_timestamp as source_rate_timestamp,\n        row_number() over (\n            partition by t.txn_id\n            order by r.price_timestamp desc\n        ) as rn\n    from transactions t\n    left join rates r\n        on r.currency = t.source_currency\n        and r.price_timestamp <= t.created_at \n),\n\nlatest_dest_rate as (\n    select\n        t.txn_id,\n        r.usdt_price as destination_usdt_price,\n        r.price_timestamp as destination_rate_timestamp,\n        row_number() over (\n            partition by t.txn_id\n            order by r.price_timestamp desc\n        ) as rn\n    from transactions t\n    left join rates r\n        on r.currency = t.destination_currency\n        and r.price_timestamp <= t.created_at \n),\n\ntransactions_with_rates as (\n    select\n        t.*,\n        lsr.source_usdt_price,\n        lsr.source_rate_timestamp,\n        ldr.destination_usdt_price,\n        ldr.destination_rate_timestamp\n    from transactions t\n    left join latest_source_rate lsr\n        on lsr.txn_id = t.txn_id\n        and lsr.rn = 1\n    left join latest_dest_rate ldr\n        on ldr.txn_id = t.txn_id\n        and ldr.rn = 1\n)\n\nselect\n    *,\n    date(created_at) as date_created,\n    source_amount * coalesce(source_usdt_price, 0) as source_amount_usd,\n    destination_amount * coalesce(destination_usdt_price, 0) as destination_amount_usd\nfrom transactions_with_rates", "relation_name": "`cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.487589Z", "completed_at": "2025-11-19T09:55:37.495729Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.496813Z", "completed_at": "2025-11-19T09:55:37.496833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05689120292663574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_currencies_currency.4c3b47e648", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_currencies`\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.547060Z", "completed_at": "2025-11-19T09:55:37.556223Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.557290Z", "completed_at": "2025-11-19T09:55:37.557311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06054186820983887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_dim_currencies_currency.20f50226d8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select currency as unique_field\n  from `cusma-383203`.`dwh_dev_mart`.`dim_currencies`\n  where currency is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.609572Z", "completed_at": "2025-11-19T09:55:37.619483Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.620210Z", "completed_at": "2025-11-19T09:55:37.620226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05760002136230469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_date_date.78f11e7735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_date`\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.667985Z", "completed_at": "2025-11-19T09:55:37.674618Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.675219Z", "completed_at": "2025-11-19T09:55:37.675234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05634808540344238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_dim_date_date.dd069a8d31", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select date as unique_field\n  from `cusma-383203`.`dwh_dev_mart`.`dim_date`\n  where date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.727291Z", "completed_at": "2025-11-19T09:55:37.733578Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.734569Z", "completed_at": "2025-11-19T09:55:37.734588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059844017028808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.dim_users", "compiled": true, "compiled_code": "\n\n\nselect * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`\norder by user_id, effective_from", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`dim_users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.790955Z", "completed_at": "2025-11-19T09:55:37.797932Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.798739Z", "completed_at": "2025-11-19T09:55:37.798757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05983614921569824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.fct_transactions", "compiled": true, "compiled_code": "\n\n\nwith transactions_with_rates as (\n    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_transactions_with_rates`\n),\n\nusers_scd2 as (\n    select * from `cusma-383203`.`dwh_dev_intermediate`.`int_users_scd2`\n),\n\ntransactions_with_kyc as (\n    select\n        t.txn_id,\n        t.user_id,\n        u.user_kyc_key,\n        t.status,\n        t.source_currency,\n        t.destination_currency,\n        t.created_at as transaction_timestamp,\n        date(t.created_at) as transaction_date,\n        t.source_amount,\n        t.destination_amount,\n        t.source_amount_usd,\n        t.destination_amount_usd,\n        u.kyc_level as kyc_level_at_transaction\n    from transactions_with_rates t\n    left join users_scd2 u\n        on t.user_id = u.user_id\n        and t.created_at >= u.effective_from\n        and t.created_at < u.effective_to\n)\n\nselect * from transactions_with_kyc", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`fct_transactions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.853205Z", "completed_at": "2025-11-19T09:55:37.863200Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.864118Z", "completed_at": "2025-11-19T09:55:37.864153Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05920600891113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_users_effective_from.582dc9f289", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect effective_from\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_users`\nwhere effective_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.913131Z", "completed_at": "2025-11-19T09:55:37.920547Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.921223Z", "completed_at": "2025-11-19T09:55:37.921239Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0557398796081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_users_effective_to.b84a4b0181", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect effective_to\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_users`\nwhere effective_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:37.971840Z", "completed_at": "2025-11-19T09:55:37.979742Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:37.980682Z", "completed_at": "2025-11-19T09:55:37.980708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05722403526306152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_users_kyc_level.552489338e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kyc_level\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_users`\nwhere kyc_level is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.030640Z", "completed_at": "2025-11-19T09:55:38.036722Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.037347Z", "completed_at": "2025-11-19T09:55:38.037364Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.054601192474365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_users_user_id.e754bb5812", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_users`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.088296Z", "completed_at": "2025-11-19T09:55:38.094553Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.095648Z", "completed_at": "2025-11-19T09:55:38.095670Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05362296104431152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_dim_users_user_kyc_key.fe9ea0f625", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_kyc_key\nfrom `cusma-383203`.`dwh_dev_mart`.`dim_users`\nwhere user_kyc_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.142191Z", "completed_at": "2025-11-19T09:55:38.147980Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.148617Z", "completed_at": "2025-11-19T09:55:38.148634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.052721261978149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_dim_users_user_kyc_key.e33cd50ac6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select user_kyc_key as unique_field\n  from `cusma-383203`.`dwh_dev_mart`.`dim_users`\n  where user_kyc_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.196699Z", "completed_at": "2025-11-19T09:55:38.207074Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.209008Z", "completed_at": "2025-11-19T09:55:38.209069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0599820613861084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.tb_transactions_by_kyc", "compiled": true, "compiled_code": "\n      \n\nselect\n    kyc_level_at_transaction,\n    count(distinct txn_id) as nb_transaction,\n    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,\n    count(distinct user_id) as nb_users,\n    sum(destination_amount_usd) as total_volume_usd,\n    sum(case when status = 'completed' then destination_amount_usd END) as completed_volume_usd\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\nwhere kyc_level_at_transaction is not null\ngroup by all", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`tb_transactions_by_kyc`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.258374Z", "completed_at": "2025-11-19T09:55:38.264010Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.264568Z", "completed_at": "2025-11-19T09:55:38.264583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.050540924072265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.de_test_dwh.tb_transactions_tracking", "compiled": true, "compiled_code": "\n\nselect\n    transaction_date timeframe,\n    \"daily\" timeframe_type,\n    count(distinct txn_id) as nb_transaction,\n    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,\n    count(distinct user_id) as nb_users,\n    sum(destination_amount_usd) as total_volume_usd,\n    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\ngroup by ALL \n\nUNION ALL \n\nselect\n    DATE_TRUNC(transaction_date, WEEK(MONDAY)) timeframe,\n    \"weekly\" timeframe_type,\n    count(distinct txn_id) as nb_transaction,\n    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,\n    count(distinct user_id) as nb_users,\n    sum(destination_amount_usd) as total_volume_usd,\n    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\ngroup by ALL \n\nUNION ALL \n\nselect\n    DATE_TRUNC(transaction_date, month) timeframe,\n    \"monthly\" timeframe_type,\n    count(distinct txn_id) as nb_transaction,\n    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,\n    count(distinct user_id) as nb_users,\n    sum(destination_amount_usd) as total_volume_usd,\n    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\ngroup by ALL \n\nUNION ALL \n\nselect\n    DATE_TRUNC(transaction_date, QUARTER) timeframe,\n    \"quarterly\" timeframe_type,\n    count(distinct txn_id) as nb_transaction,\n    count(distinct case when status = 'completed' THEN txn_id END ) as nb_completed_transaction,\n    count(distinct user_id) as nb_users,\n    sum(destination_amount_usd) as total_volume_usd,\n    sum(case when status = 'completed' then destination_amount_usd else 0 end) as completed_volume_usd,\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\ngroup by ALL", "relation_name": "`cusma-383203`.`dwh_dev_mart`.`tb_transactions_tracking`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.310726Z", "completed_at": "2025-11-19T09:55:38.316319Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.316908Z", "completed_at": "2025-11-19T09:55:38.316923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0515749454498291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.not_null_fct_transactions_txn_id.e83b9c311d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect txn_id\nfrom `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\nwhere txn_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-19T09:55:38.363788Z", "completed_at": "2025-11-19T09:55:38.370698Z"}, {"name": "execute", "started_at": "2025-11-19T09:55:38.371691Z", "completed_at": "2025-11-19T09:55:38.371709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053375959396362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.de_test_dwh.unique_fct_transactions_txn_id.d9c5d8e480", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select txn_id as unique_field\n  from `cusma-383203`.`dwh_dev_mart`.`fct_transactions`\n  where txn_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 3.994213819503784, "args": {"skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "require_generic_test_arguments_property": true, "use_fast_test_edges": false, "log_format": "default", "log_level": "info", "populate_cache": true, "use_colors": true, "favor_state": false, "upload_to_artifacts_ingest_api": false, "cache_selected_only": false, "static": false, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "which": "generate", "write_json": true, "validate_macro_args": false, "log_level_file": "debug", "printer_width": 80, "invocation_command": "dbt docs generate", "defer": false, "quiet": false, "partial_parse_file_diff": true, "select": [], "compile": true, "require_resource_names_without_spaces": true, "static_parser": true, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "require_nested_cumulative_type_params": false, "use_colors_file": true, "introspect": true, "vars": {}, "project_dir": "/Users/tamdang/Documents/DE_Test/DE_test", "macro_debugging": false, "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "profiles_dir": "/Users/tamdang/Documents/DE_Test/DE_test", "version_check": true, "empty_catalog": false, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "exclude": [], "partial_parse": true, "show_resource_report": false, "require_all_warnings_handled_by_warn_error": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_path": "/Users/tamdang/Documents/DE_Test/DE_test/logs"}}